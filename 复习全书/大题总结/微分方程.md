## 微分方程
### 一 基本概念
- **1. 常微分方程**：含有自变量、自变量的未知函数以及未知函数的导数或微分的方程式称为微分方程.当未知函数是一元函数时，则称为常微分方程.
- **2. 线性微分方程与非线性微分方程**：以未知函数和它的各阶导数作为总体是一次的就称为线性微分方程，否则就称为非线性微分方程。
- **3. 微分方程的阶**：未知函数的最高阶导数的阶数.
- **4. 微分方程的解**：把某函数及其导数代入微分方程能使该方程成为恒等式，则称这个函数是该微分方程的一个解.通常要求微分方程的解具有和该微分方程的阶数同样阶数的连续导数.
- **5. 微分方程的通解和特解**：含有与微分方程的阶数相同个数的独立任意常数的解，称为微分方程的通解.通解也可以称为一般解；不含任意常数或任意常数确定后的解，称为微分方程的特解.
- **6. 微分方程的初始条件与初值问题**：能确定通解中的任意常数的条件称为定解条件，初始条件是定解条件中最常见的类型.初始条件的形式与方程的阶数有关，一般说，以$x$为自变量，以$y(x)$为未知函数的$n$阶微分方程的初始条件为:
$$y|_{x=x_0} =y_0, y'|_{x=x_0}=y_1,\cdots, y^{(n-1)}|_{x=x_0}=y_{n-1},其中y_0,y_1,\cdots,y_{n-1}是任意给定的常数.$$
$n$阶微分方程和它的初始条件组成一个定解问题
$$\begin{cases}
    F(x,y,y',\cdots,y^{(n)})=0\\
    y(x_0)=y_0,y'(x_0)=y_1,\cdots,y_{x_0}^{(n-1)}\\
\end{cases}$$
称为$n$阶微分方程的初值问题.
### 二 一阶微分方程
一阶微分方程的一般形式为$F(x,y,y')=0或y'=f(x,y),$其中最基本的类型是变量可分离方程、一阶线性方程和全微分方程.齐次方程通过变量代换可化为可分离的方程，伯努利方程通过变量替换可化为一阶线性方程.
#### 1. 变量可分离方程
- **形式**：
$$y'=f(x)g(y)$$

- **分离变量法**：两边同除$g(y) (g(y) \neq 0),$把变量分离，并求积分$\int \frac{dy}{g(y)}=\int f(x)dx+C$
$\qquad$
- 求微分方程$x(y^2-1)dx+y(x^2-1)dy=0$的通解.
$$\frac{ydy}{y^2-1}=-\frac{xdx}{x^2-1}.$$
两边同时积分，可求得其通解为
$$\ln |y^2-1|=-\ln |x^2-1|+C_1,即(x^2-1)(y^2-1)=C,其中C为任意常数.$$

- $y'=[\sin(\ln x)+\cos(\ln x)+a]y;$
$$\frac{dy}{y}=(\sin \ln x +\cos \ln x+a)dx.$$
两边同时积分，可求得其通解为
$$\int \sin(\ln x)dx=x\sin (\ln x)-\int x \cdot \cos (\ln x)\cdot \frac{1}{x}dx=x\sin (\ln x)-\int \cos (\ln x)dx,$$
所以通解为$\ln |y|=x\sin (\ln x)+ax+C_1,或y=Ce^{x \sin (\ln x)+ax},其中C_1,C为任意常数$
#### 2. 一阶线性方程
- **形式**：
$$y'+p(x)y=q(x)$$
相应的齐次方程
$$y'+p(x)y=0$$
- **方法**：
$1^0$ **积分因子法**：方程两边同乘积分因子$\mu=e^{\int p(x)dx}$，改写成$[e^{\int p(x)dx}y]'=q(x) e^{\int p(x)dx}$，积分得$ye^{\int p(x)dx}=\int q(x) e^{\int p(x)dx}dx+C$
$2^0$ **公式法**：非齐次方程的通解为$y=e^{-\int p(x)dx}[C+\int q(x) e^{\int p(x)dx} dx]$，相应的齐次方程为的通解为$y=Ce^{-\int p(x)dx}$
$3^0$ **常数变易法**：先用分离变量法求相应的齐次方程的通解$y=Ce^{-\int p(x)dx}$,将$C$改为$C(x),$然后令$y=C(x)e^{-\int p(x)dx},$代入原非齐次方程得$C'(x) e^{-\int p(x)dx}=q(x),$积分求出$C(x)$
$\qquad$
- $y'+\frac{1-2x}{x^2}y=1;$
两边同乘$e^{\int \frac{1-2x}{x^2}dx}=e^{-\frac{1}{x} -\ln {x^2}}=\frac{1}{x^2}e^{-\frac{1}{x}},$得
$$(\frac{1}{x^2}e^{-\frac{1}{x}}y)'=\frac{1}{x^2} e^{-\frac{1}{x}}.$$
积分得$y=x^2 e^{\frac{1}{x}}(C+\int \frac{1}{x^2}e^{-\frac{1}{x}}dx)=x^2 e^{\frac{1}{x}}(C+e^{-\frac{1}{x}})=Cx^2 e^{\frac{1}{x}}+x^2,其中C为任意常数$.
$\qquad$
- $y'=\frac{1}{xy+y^3};$
将$x$看作$y$的函数，则该方程可改写为$\frac{dx}{dy}-yx=y^3,$这也是一个一阶线性非齐次方程，两边同乘$\mu= e^{\int -y dy}=e^{-\frac{1}{2} y^2}$得$\frac{d}{dy}(xe^{-\frac{1}{2} y^2})=y^3 e^{-\frac{1}{2} y^2}.$积分得
$x=e^{\frac{1}{2} y^2} (C+\int y^3 e^{-\frac{1}{2} y^2}dy)=e^{\frac{y^2}{2}} (C-y^2e^{-\frac{y^2}{2}} +\int e^{-\frac{y^2}{2}} dy^2)=Ce^{\frac{y^2}{2}}-y^2-2,其中C为任意常数.$
#### 3. 全微分方程
- **形式**：
$$P(x,y)dx+Q(x,y)dy=0 (存在u(x,y)使得du=Pdx+Qdy)，若在考虑的单连通区域上满足\frac{\partial Q}{\partial x}=\frac{\partial P}{\partial y}$$
则此方程为全微分方程.
$\qquad$
- **方法(求原函数法)**：
若求得$u(x,y)$使得$du=Pdx+Qdy(称u(x,y)为Pdx+Qdy的原函数)，$则通解为$u(x,y)=C.$
求原函数的方法有以下三种：
$1^0$ **特殊路径积分法**：$u(x,y)=\int_{x_0}^x P(x,y_0)dx+\int_{y_0}^y Q(x,y)dy$
$2^0$ **不定积分法**:由$\frac{\partial u}{\partial x}=P(x,y)$对$x$积分得$u(x,y)=\int P(x,y)dx+C(y)$，对$y$求导得$\frac{\partial u}{\partial y}=\frac{\partial }{\partial y}[\int P(x,y)dx]+C'(y),$它应等于$Q(x,y),$由此求出$C'(y)$再积分求出$C(y)$
$3^0$ **凑微分法**:$P(x,y)dx+Q(x,y)dy=\cdots=du$
$\qquad$
- 求微分方程$(\frac{xy}{\sqrt{1+x^2}}+2xy-\frac{y}{x})dx+(\sqrt{1+x^2}+x^2-\ln x)dy=0$的通解
容易验证$\frac{\partial}{\partial y} (\frac{xy}{\sqrt{1+x^2}} +2xy-\frac{y}{x})=\frac{\partial }{\partial x}(\sqrt{1+x^2} +x^2 -\ln x),$所以它是全微分方程，然而，由于方程中含$\ln x$，则只能在半平面$x \gt 0$上考虑.为求原函数，现设积分路径从点$(1,0)$开始，首先沿$x$轴积到点$(x,0)$，然后再沿横坐标为$x$的直线积到点$(x,y)$有
$$u(x,y)=\int_1^x 0 \cdot dx+\int_0^y(\sqrt{1+x^2} +x^2 -\ln x)dy=(\sqrt{1+x^2}+x^2-\ln x)y.$$
于是即得其通解为$(\sqrt{1+x^2}+x^2-\ln x)y=C,其中C为任意常数.$
#### 4. 齐次方程
可化为变量可分离的方程
- $1^0 \qquad y'=f(\frac{y}{x})$
通解的求法：令$u=\frac{y}{x},则y'=u+xu'$，于是原方程可化为$xu'=f(u)-u$,其通解为$\int \frac{du}{f(u)-u}=\int \frac{dx}{x}+C=\ln |x|+C$变量替换为$u=\frac{y}{x}$
$\qquad$
- $2^0 \qquad y'=f(ax+by+c)(a\cdot b \neq 0)$
通解的求法：令$u=ax+by+c,$则原方程可化为$u'=a+bf(u)$即为变量可分离的方程,变量替换为$u=ax+by+c$
$\qquad$
- $3^0 \qquad y'=f(\frac{a_1 x +b_1 y+c_1}{a_2 x +b_2 y+c_2})$
**情形1**：$\delta = \begin{vmatrix}
    a_1 \quad b_1 \\
    a_2 \quad b_2
\end{vmatrix}\neq 0$
解线性方程组$\begin{cases}
    a_1x+b_1y+c_1=0,\\
    a_2x+b_2y+c_2=0,\\
\end{cases}$
设其解为$(\alpha,\beta),$令$u=x-a,v=y-\beta,$则原方程可化为$\frac{dv}{du}=f(\frac{a_1u+b_1 v}{a_2 u +b_2v})$属于齐次方程.
$\qquad$
**情形2**：$\delta = \begin{vmatrix}
    a_1 \quad b_1\\
    a_2 \quad b_2 \\
\end{vmatrix} =0$
即$\frac{a_2}{a_1}=\frac{b_2}{b_1}=\lambda,$则$y'=f(\frac{a_1 x+b_1y +c_1}{\lambda (a_1x+b_1y) +c_2})$，令$z=a_1x+b_1y,$则原方程化为$z'=a_1+b_1 f(\frac{z+c_1}{\lambda z +c_2})$属于变量可分离的方程.
$\qquad$
- $xy'=\sqrt{x^2-y^2}+y.$
属于齐次方程.令$y=xu,$并且当$x \gt 0$时，原方程可化为
$$xu'+u=\sqrt{1-u^2}+u,即 \frac{du}{\sqrt{1-u^2}}=\frac{dx}{x}.$$
两端求积分，则得$\arcsin u=\ln x+C,$即其通解为$\arcsin \frac{y}{x}=\ln x+C,其中C为任意常数.$
当$x \lt 0$时，上述方程变为$\frac{du}{\sqrt{1-u^2}}=-\frac{dx}{x},$其通解应为$\arcsin \frac{y}{x}=-\ln |x|+C,其中C为任意常数.$
$\qquad$
所得的通解公式也可以统一为$y=|x| \sin (\ln |x|+C).$此处还需注意，在上面作除法的过程中丢掉了两个特解$u=\pm 1,即y=\pm x.$
$\qquad$
- $x^2ydx-(x^3+y^3)dy=0;$
这是一个齐次方程，这里若将$x$看作$y$的函数，原方程可改写为$\frac{dx}{dy}-\frac{1}{y}x=\frac{y^2}{x^2}.$这还是一个伯努利方程.改写成$x^2 \frac{dx}{dy}-\frac{1}{y}x^3=y^2,\frac{dx^3}{dy}-\frac{3}{y}x^3=3y^2.$而$e^{-\int \frac{3}{y}dy}=\frac{1}{|y|^3},$于是两边同乘$\mu =\frac{1}{y^3}得\frac{d}{dy}(\frac{x^3}{y^3})=\frac{3}{y}.$积分得$\frac{x^3}{y^3}=\int \frac{3}{y}dy+C=3\ln |y|+C,即x^3=Cy^3 +3y^3 \ln |y|,其中C为任意常数.$
#### 5. 伯努利方程
- $1^0 \qquad y'+p(x)y=q(x)y^\alpha (\alpha \neq 0,1)$
通解的求法：令$z=y^{1-\alpha},$则原方程可化为$\frac{dz}{dx}+(1-\alpha)p(x)z=(1-\alpha)q(x)$属于一阶线性方程.
$\qquad$
- $2^0 \frac{dy}{dx}=\frac{h(y)}{p(y)x+q(y)} \qquad \frac{dy}{dx}=\frac{h(y)}{p(y)x+q(y) x^\alpha} (\alpha \neq 0,1)$
通解的求法：$\frac{dx}{dy}=\frac{p(y)}{h(y)}x+\frac{q(y)}{h(y)}$(以$y$为自变量，$x$为因变量的一阶线性方程)
$\frac{dx}{dy}=\frac{p(y)}{h(y)}x+\frac{q(y)}{h(y)}x^\alpha$(以$y$为自变量，$x$为因变量的伯努利方程)(自变量与因变量互换)
$\qquad$
- $y'=\frac{y^2-x}{2y(x-1)}.$
这是伯努利方程，可改写为$2yy'=\frac{y^2}{x-1}-\frac{x}{x-1}.$
由于$2yy'=(y^2)',$则原方程化为$(y^2)'-\frac{1}{x-1}y^2=-\frac{x}{x-1}.$
以$y^2$为未知函数这又是一个一阶线性非齐次方程，而$e^{-\int \frac{dx}{x-1}}=\frac{1}{|x-1|},$于是两边同乘$\mu = \frac{1}{x-1}$得
$$\frac{d}{dx}(\frac{y^2}{x-1})=-\frac{x}{(x-1)^2}.$$
积分得$\frac{y^2}{x-1}=-\int \frac{x}{(x-1)^2}dx+C=-[\int \frac{dx}{x-1}+\int \frac{dx}{(x-1)^2}]+C=-\ln |x-1|+\frac{1}{x-1}+C,$
即得通解为$y^2=C(x-1)-(x-1)\ln |x-1|+1,其中C为任意常数.$ 
### 三 可降阶的高阶方程
- $1^0 \qquad y^{(n)}=f(x)$
经$n$次积分得，$y=\int \cdots \int f(x)dxdx\cdots dx+C_1 x^{n-1}+C_2x^{n-2}+\cdots+C_n$
$\qquad$
- $2^0$不显含$y$的二阶方程$y''=f(x,y')$
令$p=y',$原方程化为$p$的一阶方程:$p'=f(x,p)$
$\quad$
- $3^0$ 不显含$x$的二阶方程$y''=f(y,y')$
令$p=y',$原方程可化为以$p$未知函数，$y$为自变量的一阶方程:$p\frac{dp}{dy}=f(y,p)\quad (y''=\frac{d^2 y}{dx^2}=\frac{dp}{dx}=\frac{dp}{dy} \frac{dy}{dx}=p\frac{dp}{dy})$
$\quad$
- 求方程$xy''=y'\ln y'$的通解;
此方程不显含$y,$令$p=y'$,则原方程化为$xp'=p\ln p.$
当$p \neq 1$时，可改写为$\frac{dp}{p \ln p}=\frac{dx}{x},$其通解为
$$\ln |\ln p|=\ln |x|+C,即\ln p=C_1 x,即y'=e^{C_1 x}.$$
这样，原方程的通解即为$y=\frac{1}{C_1} e^{C_1 x}+C_2,其中C_1 \neq 0,C_2$为任意常数.
当$p=1$时，也可以得到一族解$y=x+C_3.$
$\quad$
- 求$yy''=2(y'^2=y')$满足初始条件$y(0)=1,y'(0)=2$的特解.
此方程不显含$x$，令$p=y'$,且以$y$为自变量，$\frac{d^2y}{dx^2}=\frac{dp}{dy}p,$原方程可化为$yp\frac{dp}{dy}=2(p^2-p).$
当$p \neq 0$时，可改写为$y\frac{dp}{dy}=2(p-1) 或\frac{dp}{p-1}=\frac{2dy}{y},$解为$p-1=C_1 y^2.$
再利用$p=y'$,以及初始条件，可推出常数$C_1=1.$从而上述方程为变量可分离的方程
$$y'=1+y^2 \Leftarrow 其通解为y=\tan (x+C_2).$$
再一次利用初始条件$y(0)=1,即得C_2=\frac{\pi}{4}.$所以满足初始条件的特解为$y=\tan (x+\frac{\pi}{4}).$
**注意**：就解方程而言，$yp\frac{dp}{dy}=2(p^2-p)$还有两个特解，即$p=0与p=1$,然而它们都不满足初始条件$y'(0)=p(0)=2.$
### 线性微分方程解的性质与结构
$\quad$
$\quad$
$\quad$
$\quad$
$\quad$
### 二阶和某些高阶常系数齐次线性微分方程
$\quad$
$\quad$
$\quad$
$\quad$
$\quad$
### 二阶常系数非齐次线性微分方程与欧拉方程
$\quad$
$\quad$
$\quad$
$\quad$
$\quad$