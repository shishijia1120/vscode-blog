## 5 一元函数的泰勒公式及其应用
### 一、带皮亚诺余项与拉格朗日余项的$n$阶泰勒公式
#### (一) 泰勒中值定理
##### 1. 带皮亚诺余项的$n$阶泰勒公式
- **定理5.1** 设$f(x)$在点$x=x_0$处具有$n$阶导数，则
$$f(x)=T_n(x)+R_n(x), \qquad (5.1)$$
其中$$T_n(x)=f(x_0)+f'(x_0)(x-x_0)+\cdots+\frac{f^{n}(x_0)}{n!}(x-x_0)^n, \qquad (5.2)$$
$$R_n(x)=0((x-x_0)^n) \quad (x \rightarrow x_0) ，即\lim \limits_{x \rightarrow x_0}\frac{R_n(x)}{(x-x_0)^n}=0. \qquad (5.3)$$
- (5.1)式称为$f(x)$在点$x=x_0$的邻域(简称在$x=x_0$)的带皮亚诺余项的$n$阶泰勒公式(或泰勒展开式)，(5.3)式称为函数$f(x)$在点$x=x_0$处的$n$阶皮亚诺余项，而(5.2)式称为函数$f(x)$在$x=x_0$的$n$次泰勒多项式.
$\qquad$特别地，$n=1$时公式(5.1)就是导数的定义.

##### 2. 带拉格朗日余项的$n$阶泰勒公式
- **定理5.2** 设$f(x)$在包含$x_0$的区间$(a,b)$内有$n+1$阶导数，在区间$[a,b]$上有$n$阶连续导数，则任意$x \in [a,b]$，有
$$f(x)=T_n(x)+R_n(x),\qquad (5.4)$$
其中$T_n(x)$由(5.2)式给出，而
$$R_n(x)=\frac{1}{(n+1)!}f^{(n+1)}(\xi)(x-x_0)^{n+1}，\qquad (5.5)$$
$\xi 在x与x_0$之间，也可表为$\xi = x_0+\theta(x-x_0), 0 \lt \theta \lt 1.$
$\qquad$ (5.4)式称为函数$f(x)$在区间$[a,b]$上带拉格朗日余项的$n$阶泰勒公式.(5.5)式称为函数$f(x)$在点$x=x_0$处的$n$阶拉格朗日余项.
$\qquad$ 特别地，$n=0$时公式(5.4)就是拉格朗日中值公式.
**注意** 
- 当$x_0=0$时的泰勒公式(5.1)与(5.4)又分别称为带皮亚诺余项与带拉格朗日余项的麦克劳林公式，即
$$f(x)=f(0)+f'(0)x+\frac{f''(0)}{2!}x^2+\cdots+\frac{f^{(n)}(0)}{n!}x^n+o(x^n),$$

$$f(x)=f(0)+f'(0)x+\frac{f''(0)}{2!}x^2+\cdots+\frac{f^{(n)}(0)}{n!}x^n+\frac{f^{(n+1)}(\theta x)}{(n+1)!}$$
- 带拉格朗日余项的泰勒公式可用于区间$[a,b]$上，例如证明不等式或等式，证明函数或导数存在某种特征点等；而带皮亚诺余项的泰勒公式仅能用于泰勒点$x=x_0$时的函数的极限性质，例如求$x\rightarrow x_0$时的极限，确定无穷小的阶，求$f^{(n)}(x_0)$，或考察(局部)极值问题等.

#### (二) 五个基本初等函数的麦克劳林公式
- (1) $e^x=\sum_{k=0}^n \frac{x^k}{k!}+R_n(x),\quad R_n(x)=o(x^n)(x \rightarrow 0),$

$\qquad \qquad \qquad R_n(x)=\frac{1}{(n+1)!}e^{\theta x}x^{n+1}, x \in (-\infty,+\infty)$
- (2) $\sin x=\sum_{k=1}^n (-1)^{k-1}\frac{x^{2k-1}}{(2k-1)!}+R_{2n}(x), \quad R_{2n}(x)=o(x^{2n}) \quad (x \rightarrow 0)$,

$\qquad \qquad \qquad R_{2n}(x)=(-1)^n\frac{\cos \theta x}{(2n+1)!}x^{2n+1}, \quad x \in (-\infty,+\infty).$
- (3) $\cos x=\sum_{k=0}^n(-1)^k\frac{x^{2k}}{(2k)!}+R_{2n+1}(x) \quad R_{2n+1}(x)=o(x^{2n+1}) \quad (x \rightarrow 0),$

$\qquad \qquad \qquad R_{2n+1}(x)=(-1)^{n+1}\frac{\cos \theta x}{(2n+2)!}x^{2n+2}, \quad x\in (-\infty,+\infty).$
- (4) $(1+x)^\alpha = 1+\sum_{k=1}^n \frac{\alpha (\alpha-1)\cdots (\alpha-k+1)}{k!}x^k+R_n(x),\quad R_n(x)=o(x^n) (x \rightarrow 0),$

$\qquad \qquad \qquad  R_n(x)=\frac{\alpha(\alpha -1)\cdots (\alpha-n)}{(n+1)!}(1+\theta x)^{\alpha-n-1}x^{n+1}, \quad x \in (-1,1).$
- (5) $\ln(1+x)=\sum_{k=1}^n \frac{(-1)^{k-1}x^k}{k}+R_n(x), \quad R_n(x)=o(x^n),(x \rightarrow 0),$

$\qquad \qquad \qquad R_n(x)=\frac{(-1)^n x^{n+1}}{(n+1)(1+\theta x)^{n+1}} \quad x \in (-1,1].$

**注意**
- $\theta \in (0,1).$
- 利用奇偶函数在$x=0$处导数性质又可得奇、偶函数的带皮亚诺余项的麦克劳林公式分别为
$$f(x)=f'(0)x+\frac{1}{3!}(0)x^3+\frac{1}{5!}(0)x^5+\cdots+\frac{1}{(2n-1)!}f^{(2n-1)}(0)x^{2n-1}+o(x^{2n}).$$

$$f(x)=f(0)+\frac{1}{2!}f^{2}(0)x^2+\frac{1}{4!}(0)x^4+\cdots+\frac{1}{(2n)!}f^{2n}(0)x^{2n}+o(x^{2n+1}).$$

### 二、泰勒公式的求法
#### (一) 泰勒公式的唯一性
- **定理5.3** 设$f(x)$在$x=x_0$有$n$阶导数，且$x \rightarrow x_0$时有
$$f(x)=A_0+A_1(x-x_0)+\cdots+A_n(x-x_0)^n+o((x-x_0)^n), \qquad (5.6)$$

则$A_0=f(x_0),A_k=\frac{f^{k}(x_0)}{k!}(k=1,2,\cdots,n).$

$\qquad$这个定理称为泰勒公式的唯一性定理，它表明：不论用何种方法求得等式(5.6)，它必定是$f(x)$在$x=x_0$的$n$阶泰勒公式.这使得我们可以不通过计算$f(x)$在点$x_0$处的函数值$f(x_0)$和各阶导数值$f^{(k)}(x_0)(k=1,2,\cdots,n)$来求得$f(x)$的泰勒公式.

#### (二) 求带皮亚诺余项泰勒公式的方法
##### 1. 直接求法
- 通过求$f(x_0),f'(x_0),\cdots,f^{(n)}(x_0)$而求得$f(x)$的$n$阶泰勒公式.上述五个初等函数的泰勒公式均可由这个方法求得.
##### 2. 间接求法
- 利用已知的泰勒公式，通过适当运算而得到待求得泰勒公式.具体做法包括：
**四则运算**
$\quad$由已知泰勒公式相加或相乘而求得.

- 求$\sqrt{1+x} \cos x$的带皮亚诺余项的三阶麦克劳林公式.

**注意**：无穷小量阶的运算法则：
- $(i) \quad o((x-a)^n)+o((x-a)^m)=o((x-a)^n) \quad (n \leq m);$
- $(ii) \quad o((x-a)^n) \cdot o((x-a)^m)=o((x-a)^{m+n});$
- $(iii) \quad (x-a)^n \cdot o((x-a)^m)=o((x-a)^{n+m});$
- $(iv) \quad f(x) \cdot o((x-a)^n)=o((x-a)^n),$其中$f(x)$在$0 \lt |x-a| \lt \delta 有界.$
上述各式的按定义容易得证，如证$(ii),$因为
$$\lim \limits_{x \rightarrow a} \frac{o((x-a)^n) \cdot o((x-a)^m}{(x-a)^{n+m}}=\lim \limits_{x \rightarrow a} \frac{o((x-a)^n)}{(x-a)^n} \cdot \lim\limits_{x \rightarrow a}\frac{o((x-a)^m)}{(x-a)^m}=0\times 0=0.$$

**复合运算**
- 由$f(x)$的泰勒公式可求得$f(ax^m)$的泰勒公式，其中$m$为自然数，$a \neq 0$为常数.

**逐项求导或求积分**
- 设$f(x)$在$x=x_0$点处$n$阶可导，$f(x)$在$x=x_0$的$n$阶泰勒公式为
$$f(x)=A_0+A_1(x-x_0)+A_2(x-x_0)^2+\cdots +A_n(x-x_0)^n+o((x-x_0)^n). \quad (5.7)$$

则由(5.7)式逐项求导$f'(x)$在$x=x_0$的$n-1$阶泰勒公式
$$f'(x)=A_1+2A_2(x-x_0)+\cdots +nA_n(x-x_0)^{n-1}+o((x-x_0)^{n-1});$$

由(5.7)逐项求积分可得$\int_{x_0}^x f(t)dt$在$x=x_0$的$n+1$阶泰勒公式
$$\int_{x_0} ^x f(t)dt=A_0(x-x_0)+\frac{A_1}{2}(x-x_0)^2+\cdots+\frac{A_n}{n+1}(x-x_0)^{n+1}+o((x-x_0)^{n+1}) \quad(5.9)$$

- 求$\arctan x$带皮亚诺余项的5阶麦克劳林公式
$(\arctan x)'=\frac{1}{1+x^2},又\frac{1}{1+x^2}=1-x^2+x^4+o(x^5),$由该式逐项积分即得
$$\arctan x=\int_0^x \frac{dt}{1+t^2}=\int_0^x (1-t^2+t^4)dt+o(x^6)=x-\frac{1}{3}x^3+\frac{1}{5}x^5+o(x^6).$$
#### (三) 求带拉格朗日余项泰勒公式的方法
- 见题型一.

### 三、泰勒公式得若干应用
#### (一) 带皮亚诺余项得泰勒公式得若干应用
##### 1. 利用泰勒公式求未定式的极限
- 设$h(x)$在$x=a$处$n$阶可导，则有带皮亚诺余项的$n$阶泰勒公式为
$$h(x)=h(a)+h'(a)(x-a)+\frac{h''(a)}{2!}(x-a)^2+\cdots+\frac{h^{(n)}(a)}{n!}(x-a)^n+o((x-a)^n).$$
现设$\lim \limits_{x \rightarrow a}f(x)=\lim \limits_{x \rightarrow a}g(x)=0,$并已求得$f(x)与g(x)$的泰勒公式
$$f(x)=A(x-a)^n+o((x-a)^n), \quad g(x)=B(x-a)^m +o((x-a)^m),$$
其中$B \neq 0,$则
$$\lim\limits_{x \rightarrow a}\frac{f(x)}{g(x)}=\lim\limits_{x \rightarrow a}\frac{A(x-a)^n+o((x-a)^n)}{B(x-a)^m+o((x-a)^m)}= \begin{cases}
        \frac{A}{B},\quad m=n,\\
        0,\quad n \gt m,\\
        \infty,\quad n \lt m,A\neq 0.
    \end{cases}
$$
当$f(x),g(x)$的泰勒公式易求，而$f(x),g(x)$的导数计算较复杂时，可考虑用泰勒公式求此极限$\lim \limits_{x \rightarrow a}\frac{f(x)}{g(x)}.$在应用此方法时，必须熟记某些基本初等函数的泰勒公式.
$\quad$
- $w=\lim \limits_{x \rightarrow 0}\frac{\frac{x^2}{2}+1-\sqrt{1+x^2}}{(\cos x-e^{x^2}) \sin x^2}.$

##### 2. 利用泰勒公式确定无穷小的阶
- (1) 若当$x \rightarrow a$时$f(x)=A_n(x-a)^n+o((x-a)^n),$其中$A_n \neq 0,$则当$x \rightarrow a$时$f(x)是x-a$的$n$阶无穷小.
- (2) 若在$f(x)=f(a)+f'(a)(x-a)+\cdots+\frac{f^{(n)}(a)}{n!}(x-a)^n+o((x-a)^n)$中，$f(a)=f'(a)=\cdots=f^{(n-1)}(a)=0,f^{(n)}(a) \neq 0,$则
$$f(x)=\frac{f^{n}(a)}{n!}(x-a)^n+o((x-a)^n).$$
即当$x \rightarrow a$时$f(x)$是$(x-a)$的$n$阶无穷小.由此可知，无穷小的阶数是不为零的导数的最小阶数.
$\quad$
- 确定常数$a和b$的值，使$f(x)=x-(a+be^{x^2})\sin x$当$x \rightarrow 0$时是$x$的5阶无穷小量.

##### 3. 由泰勒公式的系数求函数在指定点$x=x_0$处高阶导数的值$f^{(n)}(x_0)$ 
- 设$f(x)在x=x_0$处$n$阶可导，若用间接求法求得泰勒公式(5.6)，即
$$f(x)=A_0+A_1(x-x_0)+\cdots+A_n(x-x_0)^n+o((x-x_0)^n) \quad(x \rightarrow x_0),$$
由此可得 $f(x_0)=A_0,f'(x_0)=A_1,f''(x_0)=2!A_2, \cdots,f^{(n)}(x_0)=n!A_n.$

#### (二) 带拉格朗日余项得泰勒公式得若干应用
##### 1. 利用泰勒公式证明不等式
- 方法$1^0\quad$ 通过泰勒公式余项来证明不等式
$\qquad$设$ 0 \lt x \lt \frac{\pi}{2}, $证明$\frac{x^2}{3} \lt 1-\cos x \lt \frac{x^2}{2}.$


$\quad$
- 方法$2^0 \quad $ 由函数与二阶导数估计一阶导数证明不等式
$\qquad $设$f(x)$在$[0,1]$二阶可导，$|f(0)| \leq a, |f''(x)| \leq b, a,b$为非负数，求证：任意$c \in (0,1),$有$|f'(c)| \leq 2a+\frac{1}{2}b.$


$\quad$
$\quad $
- **注意**：用拉格朗日型余项的泰勒公式解决问题时，成功的关键是选好公式中的展开点$x_0$和被展开点$x$，这要根据具体题目的条件和结论来进行选择.一般来说，把题目中给定某阶导数值得点或需要估计导数值的大小的点取为展开点$x_0$，把题目中给定函数值的点或区间的端点取为被展开点$x$.有时还要去设法去掉在展开式中出现的未知的函数值或导数值.


##### 2. 利用泰勒公式证明函数或高阶导数存在满足某种要求的特征点
- 当要证明存在某点使得函数或高阶导数在该点取值满足某等式(不等式)或具有某种其他要求的特性时，也常用到泰勒公式.所求的点还常常是公式余项中出现的中间值.
$\quad $设$f(x)$在$[a,b]$三次可微，证明：存在$\xi \in (a,b)$使得
$$f(b)=f(a)+f'(\frac{a+b}{2})(b-a)+\frac{1}{24}(b-a)^3f'''(\xi).$$
