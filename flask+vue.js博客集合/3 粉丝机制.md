# 粉丝关注大神
## 后台
----
### 1 深入SQLAlchemy关系模式
### 2 实现粉丝机制
### 2.1 功能分析
1. 关注与取消关注
   - 点击关注，向后台传入要关注的大神的id，判断是否已关注该用户，if已关注，返回提示信息；else开始关注该用户
   - 取消关注，向后台传入要取关的大神的id，判断是否已关注该用户，if未关注，返回提示信息；else取消关注该用户
2. 返回被关注者列表和粉丝列表
   - 点击导航栏的关注我的人，导航栏上标有人数，显示粉丝列表，具体显示粉丝的详细信息。重点：加入is_following标志位，若关注了登录对象，还要显示关注的时间。
   - 点击我关注的人，导航栏上标有人数，显示大神列表，具体显示大神的详细信息，还能进行关注和取关操作。
3. 返回被关注者的文章列表和用户的文章列表
   - 返回被关注者的文章列表，传递用户的id
   - 返回用户的文章列表，传递用户的id,得到page、per_page
### 2.2 数据库模型
models.py:
```python
followers = db.Table(
    'followers',
    db.Column('follower_id', db.Integer, db.ForeignKey('users.id')),
    db.Column('followed_id', db.Integer, db.ForeignKey('users.id')),
    db.Column('timestamp', db.DateTime, default=datetime.utcnow)
)

class User(PaginatedAPIMixin, db.Model):
    ...
    # followeds 是该用户关注了哪些用户列表
    # followers 是该用户的粉丝列表
    followeds = db.relationship(
        'User', secondary=followers,
        primaryjoin=(followers.c.follower_id == id),
        secondaryjoin=(followers.c.followed_id == id),
        backref=db.backref('followers', lazy='dynamic'), lazy='dynamic')
```
### 2.3 后台API接口
| HTTP方法 | 资源URL                     | 说明               |
| -------- | --------------------------- | ------------------ |
| GET      | /follow/\<int:id\>          | 开始关注一个用户   |
| GET      | /unfollow\<int:id>          | 取消关注一个用户   |
| GET      | /users/\<int:id>/followeds/ | 返回大神列表       |
| GET      | /users/\<int:id>/followers/ | 返回粉丝列表       |
| GET      | /users/\<int:id>/posts/     | 返回用户的文章列表 |
### 2.4 API：关注与取消关注
### 2.5 API 返回大神和粉丝列表
####2.6 API 返回用户的文章列表
----
## 前台
### 个人主页页面设计
1.个人主页：
   - 用户登录后，可查看自己和其它用户的个人主页，如果你还没关注过他，界面会显示Follow按钮；如果你已关注过他，界面显示Unfollow按钮，点击按钮，按钮会改变状态；
   - 如果是你的个人主页，会显示setting按钮，可以进行设置；还要DELETE ACCOUNT按钮。
   - 点击Tab Nav中的关注标签，跳转到
   - 点击Tab Nav中的粉丝标签，跳转到
   - 点击Tab Nav中的帖子标签，跳转到
### 用户profile页面设计
向实现用户的个人主页，通过Tab页标签来显示用户关注了谁、用户的粉丝们。
可使用vue-router嵌套路由，修改index.js
```javascript
routes:[
   ...
   {
      path:'/user/:id',
      //name :'User' 
      component:User,
      children:[
      //when /suer/:id is matched
      // 注意：要有默认子路由，父路由不能指定name
         {path:'',compoent:Overview}，
         {path:'Overview',name:'UserOverview',component:Overview},

         //when /user/:id/followers is matched
         {path:'followers',name:'UserFollowers',component:Followers},

         //when /user/:id/following is matched
         {path:'following',name:'UserFollowing',component:UserFollowing},

         //when /user/:id/posts is matched
         {path:'posts',name:'UserPostList',component:UserPostList},

         //when /user/:id/followeds-posts is mathced
         {path:'followeds-posts',name:'UserFollowedsPostsList',component:UserFollowedsPostList}
      ],
      meta:{
         requiresAuth:true
      }
   
   },
   ...
]
```
在User.vue组件中使用：
```

```
