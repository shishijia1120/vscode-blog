# 微积分框架之积分
## 15 积分
### 15.1 求和符号
$$\sum_{j=1}^6\frac{1}{j^2}$$
#### 15.1.1 一个有用的求和
#### 1.1.2 伸缩求和法
伸缩级数
$$\sum_{j=a}^b(f(j)-f(j-1))=f(b)-f(a-1).$$
### 15.2 位移和面积
#### 15.2.1 三个简单的例子
#### 15.2.2 一段更常规的旅行
#### 15.2.3 有向面积
#### 15.2.4 连续的速度
$对实际面积进行估算：$
$$速度曲线下的面积\approx \sum_{j=1}^nv(c_j)(t_j-t_{j-1}).$$
$不幸的是，这个估算不是很正确，需要把分区的区间缩小。$
$$在速度曲线下的实际面积=\lim\limits_{mesh \to 0}\sum_{i=1}^n v(c_j)(t_j-t_{j-1})$$
#### 15.2.5 两个特别的估算

## 16 定积分
### 16.1 基本思想
$$\int_a ^bf(x)dx.$$
$这就是定积分，你可以把它读为“函数f(x)对于x从a到b的积分”.表达式f(x)叫做被积函数，a和b也叫积分极限。最后,dx说明x是水平轴的变量。$

$\int_a ^b是由曲线y=f(x)，两条垂线x=a和x=b，以及x轴所围成的有向面积.$

$$位移=\int_a^bv(t)dt \qquad 和 路程=\int_a^b|v(t)|dt.$$
### 16.2 定积分的定义
$$\int_a^bf(x)dx=\lim\limits_{mesha \to 0}\sum_{j=1}^n f(c_j)(x_j-x_{j-1}).$$
$其中a=x_0<x_1<...<x_{n-1}<x_n=b并且对于每一个j=1,...,n都有c_j在[x_{j-1},x_j]内.$
$需要注意如下几点：$
- $在积分表达式中出现的求和\sum_{j=1} ^n f(c_j)(x_j-x_{j-1},我们称之为黎曼和。它给出了定积分的估算值，如果它的最大区间非常小，那么这时估算将是非常精确的。$

**一个使用定义的例子**

$使用上述公式计算定积分$
$$\int_0^2x^2dx.$$
$将[0,2]区间分成n个小区间，每个小区间的长度是相等的，长度为2/n。$
$在该例子中，通常的分区$
$$a=x_0<x_1<x_2<...<x_{n-1}<x_n$$
$特殊化为$
$$0=\frac{0}{n}<\frac{2}{n}<\frac{4}{n}<...<\frac{2(n-1)}{n}<\frac{2n}{n}=2$$
$很显然，对于任意一点x_j，它所对应的横坐标为2j/n，现在我们需要选择c_j。例如c_0可能在区间[0,2/n]的任意位置，c_1可能在可能在[2/n,4/n]的任意位置，以此类推，为了计算简单，我们可以选择每一个小区间的右端点，所以c_j=x_j=2j/n。$
$现在，我们准备使用公式了，考虑黎曼和$
$$\sum_{j=1}^n f(c_j)(x_j-x_{j-1}).$$
$我们知道f(x)=x^2,c_j=2j/n,x_j=2j/n,x_{j-1}=2(j-1)/n,所以上述求和变为$
$$\sum_{j=1}^n(\frac{2j}{n})^2(\frac{2j}{n}-\frac{2(j-1)}{n}).$$
$上述的和可化简为：$
$$\sum_{j=1}^n \frac{4j^2}{n^2} \times \frac{2}{n}=\sum_{j=1}^n\frac{8j^2}{n^3}=\frac{8}{n^3}\sum_{j=1}^nj^2=\frac{8}{n^3}\frac{n(n+1)(2n+1)}{6}=\frac{4(n+1)(2n+1)}{3n^2}.$$
$最终，通过计算可知，阴影部分面积为$
$$\sum_{j=1}^n f(c_j)(x_j-x_{j-1})=\frac{4(n+1)(2n+1)}{3n^2}.$$
$这仅仅是对阴影部分面积的一个估算，因为该划分的每个区间的宽带都为2/n，所以可以通过让n \rightarrow \infty而迫使2/n趋于0.这样长方形变得越来越小，个数越来越多，我们的计算也就越来越精确了。所以我们有：$
$$\int_0^2x^2dx=\lim\limits_{最大区间 \to 0}\sum_{j=1}^n f(c_j)(x_j-x_{j-1})=\lim\limits_{n \to \infty}\frac{4(n+1)(2n+1)}{3n^2}.$$
$这样余下要做的是求解这个极限。该极限结果为8/3.所以$
$$\int_0^2x^2dx=\frac{8}{3}.$$
$这个计算方法很繁琐，所以我们需要一个不用长方形求和的方法。$
### 16.3 定积分的性质
1. $$\int_a^bf(x)dx=-\int_a^bf(x)dx$$
$这个公式的物理学直线运动解释是：对于一个正在做直线运动的物体，考虑该物体向回走的情况，这时的位移就是负的了。$


2. $$\int_a^af(x)dx=0$$
$用物理学的直线运动来解释：在时间a和a之间，实际上根本就没有时间，物体也不可能移动，所以根本就没有位移。$


3. $$\int_a^bf(x)dx=\int_a^cf(x)d+\int_c^bf(x)d$$
$我们可以把一个积分表达式分成两部分，即使分割点c是在原始区间[a,b]之外，当然要求分割之后的两部分依然是可积的。$

4. $$\int_a^bCf(x)dx=C\int_a^bf(x)dx.$$
$常数可以被移动积分表达式的外边。$

5. $$\int_a^b(f(x)+g(x))dx=\int_a^bf(x)dx+\int_a^bg(x)dx.$$
$和或差的积分和等于积分的和或差.$
### 16.4 求面积
#### 16.4.1 求通常的面积
#### 16.4.2 求解两条线之间的面积
$$在函数f和g之间的面积（平方单位）=\int_a^b|f(x)-g(x)|dx.$$
#### 16.4.3 求曲线与轴所围成的面积

$求面积：该面积由y=\sqrt{x}、y轴以及直线y=2围成。表达式可写成：$
$$\int_0^2y^2dy.$$
$如果f存在反函数，\int_A^Bf^{-1}(y)dy就是由函数y=f(x)、直线y=A和y=B以及y轴所围成的面积(平方单位).$
### 16.5 估算积分
$如果对于在区间[a,b]内的所有x都有f(x)\leq g(x),那么就有$
$$\int_a^bf(x)dx \leq g(x)dx.$$
**一个简单的估算**
$如果对于在[a,b]区间内的所有x有m  \leq f(x)\leq M,那么$
$$m(b-a)\leq \int_a^bf(x)dx\leq M(b-a).$$
### 16.6 积分的平均值和中值定理

**平均值**：$函数f在区间[a,b]内的平均值=\frac{1}{b-a}\int_a^bf(x)dx.$

$$f_{av}=\frac{1}{b-a}\int_a^bf(x)dx.$$
$两边同时乘以(b-a)，可得$
$$\int_a^bf(x)dx=f_{av} \times (b-a).$$

**积分的中值定理**：$如果函数f在并区间[a,b]上连续，那么在开区间(a,b)内总有一点c，满足f(c)=\frac{1}{b-a}\int_a^bf(x)dx.$

### 16.7 不可积的函数
## 17 微积分基本定理
> 微积分中的关键部分——微积分基本定理，它不仅提供了一种不用黎曼和就可以求解定积分的方法，同时也展示了微分和积分的关系。
### 17.1 用其他函数的积分来表示的函数
### 17.2 微积分的第一基本定理
$我们的目的是不用黎曼和来求积分$
$$\int_a^bf(x)dx.$$
$$F(x)=\int_a^xf(t)dt.$$
$$F'(x)=\int_a^xf(t)dt.$$
$$\lim\limits_{h \to 0}\frac{F(x+h)-F(x)}{h}.$$
$$F(x+h)=\int_a^{x+h}f(t)dt=\int_a^xf(t)dt+\int_x^{x+h}f(t)dt=F(x)+\int_x^{x+h}f(t)dt.$$
$通过整理可得：$
$$F(x+h)-F(x)=\int_x^{x+h}f(t)dt\approx hf(x).$$
$两边同时除以h，得到$
$$\frac{F(x+h)-F(x)}{h}\approx f(x).$$
$当h非常接近于0，这个估算就会很准确。$
$$\lim\limits_{h \to 0}\frac{F(x+h)-F(x)}{h}=f(x).$$
$总结为：$
$$F'(x)=f(x).$$

**总结如下.**

**微积分的第一基本定理：**$如果函数f在并区间[a,b]上是连续的，定义F为$
$$F(x)=\int_a^xf(t)dt,x \in [a,b]$$
$则F在开区间(a,b)内是可导函数，而且F'(x)=f(x).$

### 17.3 微积分的第二基本定理
**微积分的第二基本定理：**$如果函数f在并区间[a,b]上是连续的，F是f的任意一个反导数（关于x），那么有$
$$\int_a^bf(x)dx=F(b)-F(a).$$

### 17.4 不定积分
> 到目前为止，我们使用两种不同的方法计算定积分：黎曼和的极限和反导数。

我们需要一种简单的表示反导数的方式，从微积分的第一基本定理中获得了灵感，可以用$$\int f(x)dx$$
$表示“函数f的反导数的集合”，请记住任何可积函数都有无限个反导数，它们唯一的不同是常数部分。$
$如果\frac{d}{dx}F(x),那么\int f(x)dx=F(x)+C.$

- $定积分，如\int_a^bf(x)dx，是一个数。它表示由曲线y=f(x)、x轴以及垂线x=a和x=b所围成的面积。$
- $不定积分，如\int f(x)dx，是一个函数的集合。这个集合由函数f的所有反导数（关于x）组成。这些函数仅有的不同是它们的常数部分。$

**不定积分的两个性质：（f、g是可积的）**
$$\int (f(x)+g(x))dx=\int f(x)dx+\int g(x)dx$$
$$\int c f(x)dx=c\int f(x)dx.$$

### 17.5 怎样解决问题：微积分的第一基本定理
$计算导数：$
$$\frac{d}{dx}\int_3^x\sin(t^2)dt=\sin(x^2)$$
#### 17.5.1 变形1：变量是积分下限
$$\frac{d}{dx}\int_x^7t^3\cos(t\ln(t))dt.$$
$解决方法：将上、下限互换，再在新的积分前面加个负号。$
#### 17.5.2 变形2：积分上限是一个函数
$$\frac{d}{dx}\int_0^{x^2}\tan^{-1}(t^7+3t)dt.$$
$解决办法：需要使用链式求导法则。设置这个积分为y，然后再求导：$

$$y=\int_0^{x^2}\tan^{-1}(t^7+3t)dt.$$
$设u=x^2，这就是说$
$$y=\int_0^u\tan^{-1}(t^7+3t)dt.$$
$链式法则告诉我们：$
$$\frac{dy}{dx}=\frac{dy}{du}\frac{du}{dx};$$
$第一基本定理告诉我们，$
$$\frac{dy}{du}=\frac{d}{du}\int_0^u\tan^{-1}(t^7+3t)dt=\tan^{-1}(u^7+3u).$$
$又因为u=x^2，所以有du/dx=2x.这样，$
$$\frac{dy}{dx}=2x\tan^{-1}((x^2)^7+3(x^2))=2x\tan^{-1}(x^14+3x^2).$$
$即，$
$$\frac{dy}{dx}\int_0^{x^2}\tan^{-1}(t^7+3t)dt=2x\tan^{-1}(x^14+3x^2).$$

#### 17.5.3 变形3：积分上下限都为函数
$解决的方法：用一个常数把这个积分分成两个部分，在哪里分开这个积分并不重要，只要所使用的常数在该被积函数的定义域内。$

#### 17.5.4 变形4：极限伪装成导数
$$\lim\limits_{h \to 0}\frac{1}{h}\int_x^{x+h}\log_{3}(\cos^6(t)+2)dt.$$
$这不是一个导数，它是一个极限。$
$$F(x+h)-F(x)=\int_x^{x+h}\log_{3}(\cos^6(t)+2)dt.$$
$我们有：$
$$\lim\limits_{h \to 0}\frac{1}{h}\int_x^{x+h}\log_{3}(\cos^6(t)+2)dt=\lim\limits_{h \to 0}\frac{F(x+h)-F(x)}{h}=F'(x).$$
$所以，实际上对任何常数a，我们有$
$$\lim\limits_{h \to 0}\frac{1}{h}\int_x^{x+h}\log_{3}(\cos^6(t)+2)dt=\frac{d}{dx}\int_a^x\log_{3}(\cos^6(t)+2)dt.$$
### 17.6 怎样解决问题：微积分的第二基本定理
>使用微积分的第二基本定理计算定积分（这是计算定积分的方法），首先要找到不定积分，然后分别把积分上下限代入，最后再求差。
#### 17.6.1 计算不定积分
常见的导数和积分公式
#### 17.6.2 计算定积分
$微积分的第二基本定理告诉我们，为计算$
$$\int_a^bf(x)dx,$$
$仅仅需要先找到它的反导数，然后把x=a和x=b分别代入，最后求它们的差。$
#### 17.6.3 面积和绝对值
有向面积和实际面积的区别
### 17.7 技术要点
### 17.8 微积分第一基本定理的证明

## 18 积分的方法
> 让我们开始发展一套求反导数的技巧。以学习下方法：
> - 换元法
> - 分部积分法
> - 使用部分分式对有理函数求积分
### 18.1 换元法
$使用链式求导法则，我们可以很容易地求出$
$$\frac{d}{dx}(e^{x^2})=2xe^{x^2}$$
$可以得$
$$\int 2xe^{x^2}dx=e^{x^2}+C$$

$例1：现在考虑从下面的不定积分开始：$
$$\int x^2\cos(x^3)dx.$$
$让我们从设t=x^3开始，所以\cos(x^3)变为\cos(t)。我们的目的是：要用t替代表达式中的每一个x。我们已经把\cos(x^3)替换掉，但还需要替换x^2和dx.$
$事实上，dx很重要的。你不能随便地把它改为dt!因为t=x^3，所以有\frac{dt}{dx}=3x^2，我们可以把dx移到等式地右侧，这样有dt=3x^2dx.得\frac{1}{3}dt=x^2dx.这样$
$$\int x^2\cos(x^3)dx=\int \cos(x^3)(x^2dx)=\int \cos(t)(\frac{1}{3}dt)=\frac{1}{3}\int \cos(t)dt=\frac{1}{3}\sin(t)+C.$$
$所以最后的答案为$
$$\int x^2\cos(x^3)d=\frac{1}{3}\sin(x^3)+C.$$

$例2：$
$$\int e^{2x}\sec^2(e^{2x})dx.$$
$例3：$
$$\int \frac{3x^2+7}{x^3+7x-9}dx.$$
$提示：\int \frac{f'(x)}{f(x)}dx=\ln|f(x)|+C.$

$例4：$
$$\int \frac{x}{x^2+8x}=\frac{1}{2}\int \frac{2x}{x^2+8}=\frac{1}{2}\ln|x^2+8|+C$$
$例5：$
$$\int \frac{1}{x\ln(x)}dx=\int \frac{1/x}{\ln(x)}dx.$$



#### 18.1.1 换元法和定积分
$在定积分中也可以使用换元法，解决这样的问题有两种方法。例如1，计算$
$$\int_0^{\sqrt[3]{\pi /2}}x^2\cos(x^3)dx,$$
$\qquad使用换元法计算定积分的方法：先求不定积分，然后分别代入积分上下限去求定积分。$
$\qquad这里还有一个方法！在整个计算过程中你都一直计算定积分，但一定要记住，把积分的上下限也用变量t来表示。例子中，用t=x^3去换元，然后使用\frac{1}{3}dt=x^2dx换到以变量为t的积分。现在当x=0时，我们有t=0^3=0,所以积分下限为0.但对积分上限，当x=\sqrt[3]{\pi/2},我们有t=(\sqrt[3]{\pi/2})^3=\pi/2.换元后结果为：$
$$\int_0^{\sqrt[3]{\pi /2}}x^2\cos(x^3)dx=\frac{1}{3}\int_0^{\pi/2}\cos(t)dt.$$


$例2：$
$$\int_{1/sqrt{2}}^{\sqrt{3}/2}\frac{1}{\sin^{-1}(x)\sqrt{1-x^2}}dx.$$
$t=\sin^{-1}(x)$ $\qquad \qquad \qquad \qquad \qquad \qquad$  $\int_{1/\sqrt{2}}^{\sqrt{3}/2}\frac{1}{\sin^{-1}(x)\sqrt{1-x^2}}dx$


$dt=\frac{1}{\sqrt{1-x^2}}dx$  $\qquad \qquad \qquad \qquad \qquad \qquad$  $=\int_{\pi/4} ^{\pi/3}\frac{1}{t}dt=\ln|t| |_{\pi/4}^{\pi/3}$




$当x=\frac{1}{\sqrt{2}},t=\sin^{-1}(\frac{1}{\sqrt{2}})=\frac{\pi}{4}$   
$\qquad \qquad \qquad \qquad \qquad \qquad \qquad \qquad \quad$ $=\ln|\frac{\pi}{3}|-\ln|\frac{\pi}{4}|=\ln(\frac{4}{3}).$

$当x=\frac{\sqrt{3}}{2},t=\sin^{-1}(\frac{\sqrt{3}}{2})=\frac{\pi}{3}$

#### 18.1.2 如何换元


#### 18.1.3 换元法的理论解释
$\qquad 假设你想在某些积分中做这样的换元t=x^2,dt=2xdx.可解释为：当t发生微小变化时，它的变化量是它所对应的x的微小量的2x倍。更好的方式用，链式法则来解释：$
$\qquad 设想你已经做了一个换元t=g(x)，我们用以t为变量的\int f(t)dt结束求解，设结果为F(t)+C(C为常数).所以这个积分以t为变量可写为$
$$\int f(t)dt=F(t)+C.$$
(不懂)




### 18.2 分部积分法
$\qquad我们已经看到换元法是怎样利用链式求导法则。还有一种方法可以利用乘积法则，我们称之为分部积分法。回忆乘积法则：如果u和v是关于x的函数，则有：$
$$\frac{d}{dx}(uv)=v\frac{du}{dx}+u\frac{dv}{dx}.$$
$两边同时再对x求积分，得到：$
$$\int u\frac{dv}{dx}dx=\int \frac{d}{dx}(uv)dx-\int v\frac{du}{dx}dx.$$
$等同：$
$$\int u\frac{dv}{dx}dx=uv-\int v\frac{du}{dx}dx.$$
$这就是分部积分公式，这种形式非常实用。简单表示为：$
$$\int udv=uv-\int vdu.$$
$例1：$
$$\int xe^xdx.$$


$$u=x \qquad \qquad v=e^x$$
$$du=dx \qquad \qquad dv=e^xdx;$$

$$\int u dv =uv - \int v du$$
$$\int x \overbrace{e^xdx}=x e^x-\int e^xdx.$$

$得到\int xe^xdx=xe^x-e^x+C.$

$究竟为什么决定选择u=x和dv=e^xdx呢？如果设u=e^x和dv=xdx呢？我们可以这样做的。在这种情况下，会有：$
$$u=e^x \qquad \qquad v=\frac{1}{2}x^2$$
$$du=e^xdx \qquad \qquad dv=xdx;$$
$注意我们通过对dv=xdx，求积分得到v=\frac{1}{2}x^2(记住我们不需要+C)通过分部积分法有：$
$$\int u dv =uv - \int v du$$
$$\int x e^xdx=\int e^x \overbrace{xdx}=e^x.\frac{1}{2}x^2-\int \frac{1}{2}x^2\overbrace{e^xdx}.$$

$整个解题过程没有任何错误，但它很不实用。最后的积分是比原始积分更复杂的积分！所以最好使用第一种方法。这里的规则是：如果e^x存在，通常让dv=e^xdx，因为这样可以很简单地得到v即为e^x.$

**一些变形**
$这里面有很多复杂地情况，有时你需要多次计算分部积分$
$例1：$
$$\int x^2\sin(x)dx?$$



$有时在两次分部积分之后情况并未好转。如果你运气好，那么将会得到原始积分的倍数。如果很不走运，只能重新再来了。$

$例2：$
$$\int \cos(x)e^{2x}dx.$$

$有种类型的积分没有乘积的形式，有：$
$$\int \ln(x)dx,\int (\ln(x))^2dx, \int \sin^{-1}(x)dx, \int \tan^{-1}dx.$$

### 18.3 部分分式
$\qquad让我们研究怎么对一个有理函数求积分，我们将要计算积分$
$$\int \frac{p(x)}{q(x)}dx,$$
$其中p和q为多项式。这种类型在积分中所占的比例很大。$

$\qquad基本方法：通过一些代数运算把它分解成几个更简单的有理函数的和的形式，然后将看到如何对这些简单的有理函数求积分。$


#### 18.3.1 部分分式的代数运算
$\qquad 我们的目的是把一个有理函数分成许多更简单的部分。第一步是确保这个函数的分子的次数小于分母的次数。如果不是这样，我们需要先做一个多项式的除法。$
$例1：$
$$\int \frac{5x^2+x-3}{x^2-1}dx.$$
$分子分母次数相同，做一个多项式除法。所以有：$
$$\frac{5x^2+x-3}{x^2-1}=5+\frac{x+2}{x^2-1}.$$
$两边同时对x求积分，我们有：$
$$\int \frac{5x^2+x-3}{x^2-1}=\int (5+\frac{x+2}{x^2-1})dx.=5x+\int \frac{x+2}{x^2-1}dx.$$

$\qquad 接下来，我们将要分解分母中的因式。$


#### 18.3.2 对每一部分积分
$我们需要知道在把原始积分分成小部分怎样求解每一部分的积分。简单的积分形式是例1：$
$$\int \frac{1}{ax+b}dx.$$
$可以设t=ax+b$
$例2：$
$$\int \frac{1}{(4x+5)^2}dx,$$

$\qquad 当分母是一个二次函数时，情况会变得很复杂，像这样：$
$$\int \frac{Ax+B}{x^2-1}dx.$$
$我们把分母因式分解为(x-1)(x+1)，这样可得两个被积函数的分母为线性式的积分。如果是这种情况，我们就没有必要对分母为二次多项式的被积函数求积分了.$
$\qquad 如果分母的二次多项式不能因式分解.也就是说，它的判别式b^2-4ac为负，例子：$
$$\int \frac{x+8}{x^2+6x+13}dx.$$
$\qquad 其做法是：把分母写成平方放入形式，然后再换元。$
$$x^2+6x+13=x^2+6x+13-9=(x+3)^2+4.$$
$所以有：$
$$\int \frac{x+8}{x^2+6x+13}dx=\int \frac{x+8}{(x+3)^2+4}dx$$
$现在换元t=x+3，所以有x=t-3并且dx=dt:$
$$=\int \frac{t+5}{t^2+4}dt=\int \frac{t}{t^2+4}dt+5\int \frac{1}{t^2+4}dt.$$
$第一个积分：\int \frac{t}{t^2+4}dt=\frac{1}{2}\int \frac{2t}{t^2+4}dt=\frac{1}{2}\ln|t^2+4|+C.$
$第二个积分：5\int \frac{1}{t^2+4}dt，$
$仅仅需要记住这个有用的公式：$
$$\int \frac{1}{t^2+a}dt=\frac{1}{a}\tan^{-1}(\frac{t}{a})+C.$$
$当a=2,为5\times \frac{1}{2}\tan^{-1}(\frac{t}{2})+C.$
$积分结果为：\frac{1}{2}\ln(t^2+4)+\frac{5}{2}\tan^{-1}(\frac{t}{2})+C.$
$现在用x+3代替t，结果为：$
$$\frac{1}{2}\ln((x+3)^2+4)+\frac{5}{2}\tan^{-1}(\frac{x+3}{2})+C.$$

$表达式(x+3)^2+4可以化简展开，实际上没有必要展开它。仅仅回到我们配方的地方，你就会发现需要的方程了。所以，我们最终证明了：$
$$\int \frac{x+8}{x^2+6x+13}dx=\frac{1}{2}\ln(x^2+6x+13)+\frac{5}{2}\tan^{-1}(\frac{x+3}{2})+C.$$
$\qquad 如果分母的最高项的系数不是1，我建议你在配方之前把这个系数提出去。所以，计算：$
$$\int \frac{x+8}{2x^2+12x+26}dx,$$
$把2提出来，把几个积分表达式写为:$
$$\frac{1}{2}\int \frac{x+8}{x^2+6x+13}dx.$$



#### 18.3.3 方法和一个完整的例子

$\qquad 这是一个关于有理函数积分的完整方法.$
$\qquad 第一步——先看分子分母最高项的次数，如有必要请做除法。查看分子的次数是否小于分母次数。如果你运气好，直接进入第二步；如果不是，就要做一个多项式的除法了，然后再进入第二步。$
$\qquad 第二步——对分母进行因式分解。使用二次公式或猜想一个根，然后再做除法，以便因式分解被积函数的分母.$
$\qquad 第三步——分部.被积函数=分部$
$\qquad 第四步——计算常数的值。把方程两边同时乘以分母，通过任一方法计算常数的值：（a）换掉x的值；（b）系数相等法;或者结合使用(a)和(b)两种方法.$
$\qquad 第五步——求解分母为线性项次幂的积分。求解分母是线性函数次幂的积分；答案将会是对数形式或该线性项的负次幂.$
$\qquad 第六步——对分母是二次函数的被积函数求积分。对于分母是二次函数且不能因式分解的被积函数求积分，先配方，然后换元，再把它尽可能分解成两个积分。$



$$\int \frac{x^5-7x^4+19x^3-10x^2-19x+18}{x^4-5x^3+9x^2}dx.$$
$下面详细介绍怎样应用上述方法解决这个问题。$
$\qquad 第一步——先看分子分母最高项的次数，如要必要请做除法。$
$$\frac{x^5-7x^4+19x^3-10x^2-19x+18}{x^4-5x^3+9x^2}=x-2+\frac{8x^2-19x+18}{x^4-5x^3+9x^2}.$$
$现在对两边同时求积分可得：$
$$\int \frac{x^5-7x^4+19x^3-10x^2-19x+18}{x^4-5x^3+9x^2}dx=\int (x-2+\frac{8x^2-19x+18}{x^4-5x^3+9x^2})dx.$$
$现在求解积分：$
$$\int \frac{8x^2-19x+18}{x^4-5x^3+9x^2}dx.$$
$分子的次数仅仅为2，这个数低于分母的次数4.$
$\qquad 第二步——对分母进行因式分解。$
$$x^4-5x^3+9x^2=x^2(x^2-5x+9).$$
$这个二次项x^2(x^2-5x+9)的判别式为(-5)^2-4\times(9)=-11.因为它是负的，所以这个二项式不能因式分解。我们已经完成了第二步。$
$第三步——分部.我们已经有两个因子x^2和x^2-5x+9.不要把第一个因子x^2看作二次函数，而应看作一个线性函数的平方.为了证明这个观点，它可以写为(x-0)^2.所以因子x^2产生分部：$
$$\frac{A}{x^2}+\frac{B}{x}$$
$另外，因子x^2-5x+9产生分部：$
$$\frac{x^2-5x+9}{Cx+D}.$$
$将两者放在一起，我们有$
$$\frac{8x^2-19x+18}{x^4-5x^3+9x^2}=\frac{A}{x^2}+\frac{B}{x}+\frac{Cx+D}{x^2-5x+9}.$$
$\qquad 第四步——计算常数的值。得到：$
$$8x^2-19x+18=A(x^2-5x+9)+Bx(x^2-5x+9)+(Cx+D)x^2.$$
$A=2,B=-1,c=1,D=1，代入表达式中有：$
$$\frac{8x^2-19x+18}{x^4-5x^3+9x^2}=\frac{2}{x^2}+\frac{-1}{x}+\frac{x+1}{x^2-5x+9}.$$
$这就是说：$
$$\int \frac{x^5-7x^4+19x^3-10x^2-19x+18}{x^4-5x^3+9x^2}dx=2\int \frac{1}{x^2}dx-\int \frac{1}{x}dx+\int \frac{x+1}{x^2-5x+9}dx.$$
$分别对三个简单的积分。$
$\qquad 第五步——求解分母为线性次幂的积分.前两个积分是很容易求的：$
$$2\int \frac{1}{x^2}dx-\int \frac{1}{x}dx=-\frac{2}{x}-\ln|x|+C.$$
$\qquad 对分母是二次函数的被积函数求积分。需要计算第三个积分：$
$$\int \frac{x+1}{x^2-5x+9}dx.$$
$通过配方得：$
$$x^2-5x+9=(x^2-5x+\frac{25}{4})+9-\frac{25}{4}=(x=-\frac{5}{2})^2+\frac{11}{4}.$$
$现在让我们重写积分表达式：$
$$\int \frac{x+1}{x^2-5x+9}dx=\int \frac{x+1}{(x-\frac{5}{2})^2+\frac{11}{4}}dx.$$
$用t=x-\frac{5}{2}做换元，这时x=t+\frac{5}{2}且dt=dx,所以这个积分变为：$
$$\int \frac{t+\frac{5}{2}+1}{t^2+\frac{11}{4}}dt=\int \frac{t+\frac{7}{2}}{t^2+\frac{11}{4}}dt,$$
$这里以t为变量，现在把它分成两个积分：$
$$\int \frac{t}{t^2+\frac{11}{4}}dt 和\frac{7}{2}\int \frac{1}{t^2+\frac{11}{4}}dt.$$

$先计算第一个积分，分子分母同时乘以2，可得：$
$$\int \frac{t}{t^2+\frac{11}{4}}dt=\frac{1}{2}\int \frac{2t}{t^2+\frac{11}{4}}dt=\frac{1}{2}\ln|t^2+\frac{11}{4}|+C.$$
$换回以x为变量得状态，需要用x-\frac{5}{2}替代t：$
$$\frac{1}{2}\ln(t^2+\frac{11}{4})+C=\frac{1}{2}\ln((x-\frac{5}{2})^2+\frac{11}{4})+C.$$
$计算第二部分,使用公式:$
$$\int \frac{1}{t^2+a^2}dt=\frac{1}{a}\tan^{-1}(\frac{t}{a})+C,$$
$其中a=\sqrt{\frac{11}{4}}$
$$\int \frac{t+\frac{7}{2}}{t^2+\frac{11}{4}}dt=\frac{7}{2}\times \frac{2}{\sqrt{11}}\tan^{-1}(\frac{t}{\sqrt{11}/2})+C=\frac{7}{\sqrt{11}}\tan^{-1}(\frac{2t}{\sqrt{11}})+C.$$
$把t=x-\frac{5}{2}代入可得：$
$$\frac{7}{\sqrt{11}}\tan^{-1}(\frac{2x-5}{\sqrt{11}})+C.$$
$最后总结分式的结果.$








## 20 反常积分：基本概念

### 20.1 收敛和发散
$在上一章中，我们见过积分$

$$\int_a^bf(x)dx.$$
$该被积函数f如果在[a,b]区间内是有界的，并是连续的（如有有限个间断点也可），那么这个积分就是有意义的。如果这个积分有无限多个不连续点，该积分也可能是有意义的。但如果函数f不是有界的，情况又怎么样呢？$

- $如果出现下面的情况，积分\int_a^bf(x)dx就是反常积分：$
$(1)函数f在并区间[a,b]内是无界的；$
$(2)b=\infty;$
$(3)a=-\infty;$

**讨论第一种情况**$(函数f在并区间[a,b]内是无界的)：$
$\quad如果函数f(x)在x接近于点c时是无界的，那么我们说该函数x=c点有一个破裂点。大多数情况下，它就是指有垂直渐近线。$
$\quad由于该区域不停地向上延伸，那么其面积就是无限的。这个结论是正确的吧？不一定，如果该区域足够狭长，那么出现一个数学奇迹，面积就是有限的了。为了研究什么情况下一块无限区域的面积会是有限的，我们需要使用极限。其基本思想是：当在x=a处有破裂点时，我们有：$
$$如果仅仅在x接近于a点该函数f(x)是无界的，则定义\int_a^bf(x)dx=\lim\limits_{\varepsilon \to 0^+}\int_a^bf(x)dx.$$

$在此假设这个极限存在。如果能找到这样的极限，我们就说这个积分收敛;否则认为该积分发散。就像其他的极限一样，由于极限的结果可能为\infty或-\infty，或当\varepsilon\rightarrow 0^+时它的图像上下振荡，因而这个极限可能没有意义。$
$\quad 当看到一个反常积分时，我们需要知道的一件非常重要的事情是：它是收敛的还是发散的。这个积分的收敛值是多少并不是很重要（假设它是收敛的）。在实际中，如果你知道积分是收敛的，可以通过复杂的计算求的收敛值。如果积分是发散的，而你使用计算机估算这个积分值，那么可能会得到意想不到的结果（计算机还不能真正理解无限或疯狂的上下振荡）。$
#### 20.1.1 反常积分的一些例子
$$\int_0^1\frac{1}{x}dx和\int_0^1\frac{1}{\sqrt{x}}dx.$$
$这两个都是反常积分，因为它们的被积函数在x=0点都有垂直渐近线。所以我们可以使用公式：$
$$\int_0^1\frac{1}{x}dx=\lim\limits_{\varepsilon \to 0^+}\ln|x|_\varepsilon^1=\lim\limits_{\varepsilon \to 0^+}(\ln(1)-\ln(\varepsilon))=\infty.$$
$所以这个反常积分是发散的。$
$这二个积分的情况：$
$$\int_0^1\frac{1}{\sqrt{x}}dx=\lim\limits_{\varepsilon \to 0^+}\int_\varepsilon^1\frac{1}{x^{1/2}}dx=\lim\limits_{\varepsilon \to 0^+}2x^{1/2}|_{\varepsilon}^1=\lim\limits_{\varepsilon \to 0^+}(2\sqrt{1}-2\sqrt{\varepsilon})=2.$$
$我们得到了一个有限的数，所以这个积分是收敛的。$

$\qquad 假设你遇到反常积分\int_a^bf(x)dx，它的被积函数只在x=a点有垂直渐近线，你仅仅想知道该积分是收敛的还是发散的，这时,b的值对我们没有影响，可以把它换成任意大于a的有限的数，只要不选择新的垂直渐近线或新的破裂点。$
$$\int_a^bf(x)dx=\lim\limits_{\varepsilon \to 0^+}\int_{a+\varepsilon}^bf(x)dx,$$
$在此假设这个极限存在，现在把b换成其他任意的数c，但比数a大，如果x=a依然是函数f的破裂点，那么我们有$
$$\int_a^cf(x)dx=\lim\limits_{\varepsilon \to 0^+}\int_{a+\varepsilon}^cf(x)dx$$
$再次假设极限是存在的，我们可以在x=b点把最后一个积分分开，而得到$
$$\int_a^cf(x)dx=\lim\limits_{\varepsilon \to 0^+}(\int_{a+\varepsilon}^bf(x)dx+\int_b^cf(x)dx).$$

$\varepsilon对第二个积分没有任何影响；实际上，因为函数f在b和c点之间是有界的。所以这个积分收敛于一个数M.我们已经证明了$
$$\int_a^cf(x)dx=\lim\limits_{\varepsilon \to 0^+}\int_{a+\varepsilon}^bf(x)dx+M.$$
$如果右侧的极限存在，那么积分\int_a^bf(x)dx收敛。增加一个数M它仍然为有限的，所以\int_a^bf(x)dx还是收敛的。相反，如果极限不存在，这时增加一个数M对情况也没有影响，所以\int_a^bf(x)dx和\int_a^cf(x)dx同时发散。$

#### 20.1.2 其他破裂点
- $如果x=b是破裂点（函数f在积上限b是无界的），所以$
$$如果函数仅仅在x接近于b点是无界的，则定义\int_a^bf(x)dx=\lim\limits_{\varepsilon \to 0^+}\int_a^{b-\varepsilon}f(x)dx,$$

- $如果函数f在区间[a,b]内有破裂点c，那该怎么办呢？如果f仅仅是在该区间(a,b)内的c点无界，那么需要把这个积分分成两部分：$
  $\int_a^cf(x)dx  和\int_c^bf(x)dx.$
  $使用极限定义这些积分：$
  $$\lim\limits_{\varepsilon \to 0^+}f(x)dx  \quad  和  \quad  \lim\limits_{\varepsilon \to 0^+}\int_{c+\varepsilon}^bf(x)dx,$$
  $关键点是：只有当这两部分的积分都收敛时，积分\int_a^bf(x)dx才是收敛的；如果任何一个发散，那么整个积分就是发散的。$
$为计算反常积分，如果必要就把它分解，每一部分最多只能有一个瑕点，而且该点要在积分的上下限上（此处，瑕点指的是破裂点）$



### 20.2 关于无穷区间上的积分
- $现在要研究当积分上下限有一个或同是无穷时的情况；也就是说，积分区间是无界的。为计算$
$$\int_a^\infty f(x)dx,$$
$其中a是常数，函数f在区间[a,\infty)没有破裂点，我们可以定义：$
$$\int_a^\infty f(x)dx=\lim\limits_{N \to \infty}\int_a^Nf(x)dx,$$

$在此假设这个极限是存在的，则这个积分是收敛的；否则是发散的。$

- $如果在区间(-\infty,b]上函数f没有其他的破裂点，可以使用相似的定义$
  $$\int_{-\infty}^b f(x)dx=\lim\limits_{N \to \infty}\int_{-N}^bf(x)dx,$$

- $如果函数f在整个区间内都没有破裂点，那么要计算$
   $$\int_{-\infty}^\infty f(x)dx$$
   $尽管它没有瑕点，但仍然两个瑕点：\infty 和-\infty。需要把积分分成两部分，每个部分只有一个瑕点，选一个你喜欢的数，如：$
   $$\int_{-\infty}^0 f(x)dx \quad和  \quad \int_0^\infty f(x)dx.$$



### 20.3 比较判别法（理论）
- $我们想知道积分\int_a^bf(x)dx的情况，但现在仅仅知道积分\int_a^bg(x)dx的情况。如果在区间(a,b)内，函数f(x)\geq g(x)\geq 0,且积分\int_a^bg(x)dx是发散的，那么积分\int_a^bf(x)dx也是发散的。可写为：$
$$\int_a^bf(x)dx\geq \int_a^bg(x)dx=\infty.$$
$所以第一个积分也是发散的。$
-  $另一方面，对于收敛性，方向要反过来。我们想知道积分\int_a^bf(x)dx的情况，但现在知道积分\int_a^bg(x)dx是收敛的，如果在区间(a,b)内，0\leq f(x)\leq g(x),且积分\int_a^bg(x)dx是收敛的，那么积分\int_a^bf(x)dx也一定是收敛的。数学上的表示形式是：$
  $$\int_a^bf(x)dx\leq \int_a^bg(x)dx<\infty,$$
  $所以两个积分都是收敛的（注意左边积分是正的，所以它不可能发散到-\infty）$

### 20.4 极限比较判别法（理论）
>$比较判别法是用一个函数的反常积分的结果去判别另一个函数的反常积分。极限比较判别法是类似的，但并不需要一个比被判别的函数更大的函数。相反，我们仅仅需要两个近似的函数，其基本思想是：假设有两个函数在破裂点x=a是非常接近的（它们再也没有其他的破裂点），那么积分\int_a^bf(x)dx和\int_a^bg(x)dx同时收敛或同时发散，它们的行为是相同的。$

#### 20.4.1 函数互为渐近线
$假设有两个函数f和g满足$
$$\lim\limits_{x \to a}\frac{f(x)}{g(x)}=1.$$
$即：$
$$当x\rightarrow a时，f(x)\sim g(x)同\lim\limits_{x \to a}\frac{f(x)}{g(x)}=1有着同样的意义.$$

$\qquad这不是说明当x接近于a时，f(x)大约等于g(x);它说明当x接近于a时，f(x)和g(x)的比值接近于1.我们说当x\rightarrow a ,函数f(x)和g(x)是渐近等价的.当然你可以用x\rightarrow \infty或x \rightarrow a^+来替代x\rightarrow a,只需要在极限中做同样的替代。$
$\qquad 加或减这些关系却不适应上述规则。例如当x\rightarrow 0 时，以\tan(x) \sim x 和\sin(x) \sim x开始，那么不能从第一个中减去第二个得到\tan(x)-\sin(x)\sim x-x.x-x是0，没有什么能同0是渐近等价的。为什么没有呢？因为当x\rightarrow a时有f(x)\sim 0,这时我们有$
$$\lim\limits_{x \to a}\frac{f(x)}{0}=1.$$
$这讲不通，因为等式的左边没有任何意义。所以可以对这种渐近等价关系做乘积、除法、取幂，$**但一定不要加法和减法。**


#### 20.4.2 关于判别法的陈述
$正式地说，如果当x\rightarrow a时，f(x)\sim g(x),且这两个函数在区间[a,b上没有其他的瑕点了，那么积分\int_a^bf(x)dx和\int_a^bg(x)dx是同时收敛或同时发散的。（如果同时收敛，它们的收敛值可能不同）这就是$**极限比较判别法**

### 20.5 p判别法（理论）
$\qquad我们有了比较判别法和极限比较判别法，需要知道怎样去使用它们。我们的基本策略是：选择一个能与函数f相比较的函数g。我们希望函数g足够简单到可以判断它是收敛的还是发散的。$
$\qquad问题是，我们能选择什么样的g函数？最常用的函数是\frac{1}{x^p}，其中p>0.可以使用极限公式得到p判别法。$

- **p判别法，$\int^\infty$的情况：**$对于任何有限值a>0,积分$
  $$\int_a^\infty\frac{1}{x^p}dx$$
  $在p>1时是收敛的，在p\leq 1时是发散的。$

- **p判别法，$\int_0$的情况：**$对于任何有限值a>0,积分$
  $$\int_0^a\frac{1}{x^p}dx$$
  $在p<1时是收敛的，在p\geq 1时是发散的。$

**证明p判别法：**
$$\int_a^\infty\frac{1}{x^p}dx,$$
$其中常数a>0,如果p=1,该积分变为1/x，我们已经知道，这个积分在这种情况下是发散的。另外，我们有：$
$$\int_a^\infty\frac{1}{x^p}dx=\lim\limits_{N \to \infty}\int_a^Nx^{-p}dx=\lim\limits_{N \to \infty}\frac{1}{1-p}x^{1-p}|_a^N$$
$$=\frac{1}{1-p}((\lim\limits_{N \to \infty}N^{1-p})-a^{1-p}).$$

$现在如果极限$
$$\lim\limits_{N \to \infty}N^{1-p}$$
$存在，那么整个积分\int_a^\infty 1/x^pdx是收敛的。如果这个极限不存在，那么该积分是发散的。所以，将上述极限重写为$
$$\lim\limits_{N \to \infty}\frac{1}{N^{p-1}}.$$
$如果p>1,那么p-1>0,所以当N很大时N^{p-1}非常大；它的倒数变得很小，所以极限是0，最初积分是收敛的。另一方面，如果p<1,那么p-1<0,所以N^{1-p}非常大,这个极限趋于无穷大，说明积分是发散的。这证明了p判别法的一半。另一半证明与此类似，只使用\varepsilon \rightarrow 0^+而不是N \rightarrow \infty.$


### 20.6 绝对收敛判别法
$\qquad比较判别法的一个假设是函数f和g都是非负的。但如果你想判断一个负函数的走势，该怎么办呢？如果这个函数一直为负，则可把负号提出了后把它归为正函数的情况。另一方面，如果这个函数在积分区间不停地在正负之间振荡，则可以应用$**绝对收敛判别法**$，陈述如下：$
$$如果\int_a^b|f(x)|dx是收敛的，那么\int_a^bf(x)dx也是收敛的。$$

$注意：如果原始积分的绝对值是发散的，那么这个原始积分可能还是收敛的！$
$只有当该积分的绝对值情况是收敛的，才能使用绝对收敛法。$

$\qquad为什么绝对收敛判别法可以起作用，假设我们知道$
$$\int_a^b|f(x)|dx$$
$收敛。有一个很好的技巧：设对于f的x的定义区间[a,b]，有g(x)=|f(x)|+f(x).那么g有两个重要特性：首先g(x)\geq 0;其次，g(x)\leq 2|f(x)|.(两种情况下，都假定x是f定义区间[a,b]中的任意数.)$
$\qquad 无论如何，我们现在可以对g使用比较判别法了：$
$$0\leq \int_a^bg(x)dx\leq 2\int_a^b|f(x)|dx<\infty.$$
$结论是$
$$\int_a^bg(x)dx$$
$也是收敛的。那又怎样呢？注意，f(x)=g(x)-|f(x)|,所以$
$$\int_a^bf(x)dx=\int_a^bg(x)dx-\int_a^b|f(x)|dx.$$

$右侧的两个积分都是收敛的——第一个已经证明了，第二个假设为收敛的——所以，左侧的积分也是收敛的。$




## 21 反常积分：如何解题
> 上一章中，我们介绍了一些很有用的判别方法。为了更加有效地利用这些方法，你需要了解一些常见函数的性质，特别是它们在0和$\infty$附近是怎么变化的。常见函数是指：多项式函数、三角函数、指数函数和对数函数。
### 21.1 如何开始
$给定一个反常积分\int_a^bf(x)dx，之所以称其为反常积分，是因为被积函数f在区间[a,b]上至少有一个瑕点。瑕点经常出现在f的破裂点，如有垂直渐近线的点出，还出现在\infty和-\infty处.例如，积分$
$$\int _{-\infty}^{\infty} \frac{1}{x^2-1}dx$$
#### 21.1.1 拆分积分
$下面是基本的对策：$

- $ 1. 确定区间[a,b]上的所有瑕点；$
$2. 将积分拆分成若干积分之和，使得每个积分至多有一个瑕点，并使这些瑕点作为相应积分的上限或下限；$
$3. 分别讨论每个积分，如果某一积分发散，则整个积分发散。每个积分都收敛，则整个积分收敛。$

$有一个重要情形：如果没有瑕点会怎样呢？也就是说，假设有积分\int_a^bf(x)dx，它的积分区间[a,b]是有界的（故没有\infty和-\infty），并且f在闭区间[a,b]上有界的，即f没有瑕点，所以我们知道积分\int _a^bf(x)dx收敛。总之，$**如果没有瑕点，则积分收敛！**
####  21.1.2 如何处理负函数值
$如果f(x)在区间[a,b]上的某些x处取负值，你需要特别小心，这经常出现在三角函数或对数函数中。幸运的是，你能够将问题简化为只有正被积函数的积分。下面是处理负函数值的三种方法：$

- $(1) 如果被积函数f(x)在区间[a,b]上既有正值又有负值，应该考虑使用绝对收敛判别法。$
$$如果\int_a^b|f(x)|dx收敛，那么\int_a^bf(x)dx也收敛。$$
**记住：绝对收敛判别法只能帮你判断积分收敛，不能用绝对收敛判别法判断积分发散！**
$(2) 假设被积函数f(x)在区间[a,b]上恒负（或为0），则$
$$\int_a^bf(x)dx=-\int_a^b(-f(x))dx$$
$现在-f(x)非负，所以可以用比较判别法或p判别法来看\int_a^b(-f(x))dx收敛还是发散.$
$(3) 如果上面两种情形都不适用，可以用反常积分的正式定义试一下。$
### 21.2 积分判别法总结
>目前你可以使用的最有价值的工具是比较判别法、极限比较判别法和p判别法。

**在下面的所有判别法中，被积函数f(x)被假定为在积分区间上恒为正。**
- **比较判别法的发散情形：**
  $\qquad 若认为\int_a^bf(x)dx发散，那就去找一个积分也发散的较小函数，即找一个使得在区间(a,b)上有f(x)\geq g(x)的非负函数g(x)，且\int_a^bg(x)dx发散，则有$
  $$\int_a^bf(x)dx\geq \int_a^bg(x)dx=\infty,$$
  $因此\int_a^bf(x)dx发散.$

\
- **比较判别法的收敛情形：**
  $\qquad 若认为\int_a^bf(x)dx收敛，那就去找一个积分也收敛的较大函数，即找一个使得在区间(a,b)上有f(x)\leq g(x)的函数g(x)，且\int_a^bg(x)dx收敛，则有$
  $$\int_a^bf(x)dx\leq \int_a^bg(x)dx<\infty,$$
  $因此\int_a^bf(x)dx收敛.$
\
  
$极限判别法是比较判别法的替代形式。使用该判别法的重点是，能找到一个和被积函数在瑕点附近敛散性一致的函数。$
- **极限比较判别法中瑕点为无穷的情形：**
  $\qquad  找一个区间[a,\infty]上没有瑕点、形式较简单的非负函数g，且有当x\rightarrow \infty时，f(x)\sim g(x)，则$
   $(1)\quad  \int_a^\infty g(x)dx收敛，则\int_a^\infty f(x)dx收敛.$
   $(2)\quad  \int_a^\infty g(x)dx收发散，则\int_a^\infty f(x)dx发散.$
  $当然，将区间[a,\infty)换位(-\infty,b]也成立.还有一种情形也成立，即瑕点为积分区间左端点处的有限值a.$

\

- **极限比较判别法中瑕点为有限值的情形：**
  $\qquad  找一个区间[a,b]上没有瑕点、形式较简单的非负函数g，且有当x\rightarrow a时，f(x)\sim g(x)，则$
  $(1)\quad  \int_a^\infty g(x)dx收敛，则\int_a^\infty f(x)dx收敛.$
   $(2)\quad  \int_a^\infty g(x)dx收发散，则\int_a^\infty f(x)dx发散.$
  $不用说，针对唯一的瑕点在右端点x=b,且有当x\rightarrow b(而不是a)时f(x)\sim g(x)的情形，结论相同.$

  \
$\qquad 因此，需要我们找到一个合适的函数g来做比较。通过选择g(x)为1/x^p的形式，并选择合理的p值，能够解决很多问题。这类函数积分的敛散性可以准确地由p判别法描述.$
- **p判别法，$\int^{\infty}的情形：$**
  $对任意有限值a>0，积分$
  $$\int_a^{\infty}\frac{1}{x^p}dx，当p>1时收敛，当p\leq 1时发散；$$

\\
- **p判别法，$\int_0的情形：$**
  $对任意有限值a>0，积分$
  $$\int_0^{a}\frac{1}{x^p}dx，当p<1时收敛，当p\geq 1时发散.$$

### 21.3 常见函数在$\infty和-\infty附近的表现$
$现在该回答最重要的问题了：如何选择用于比较的函数g？这取决于瑕点在\pm\infty 、0，还是其他的有限值处，我们将分别讨论。$
#### 21.3.1 多项式和多项式型函数在$\infty和-\infty$附近的表现
$\quad自多项式被研究起来，在x\rightarrow \infty或x\rightarrow -\infty时最高次项起决定作用。更准确地说，设p为多项式，则$
$$若p(x)的最高次项是ax^n，则当x\rightarrow \infty或x\rightarrow -\infty时，有p(x)\sim ax^n.$$
$例子：$
$$\int_2^{\infty}\frac{3x^5_2x^2+9}{x^6+22x^4+\sqrt{4x^{13}+18x}}dx.$$
$这个问题有点复杂，唯一的瑕点是\infty.我们有$
$$当x\rightarrow \infty 时，\frac{3x^5+2x^2+9}{x^6+22x^4+\sqrt{4x^{13}+18x}}\sim \frac{3x^5}{2x^{13/2}}=\frac{3}{2}\frac{1}{x^{3/2}}$$
$由p判别法可知积分$
$$\frac{3}{2}\int_2^{\infty}\frac{1}{x^{3/2}}dx$$
$收敛，所以由极限比较判别法可知原积分也收敛.$


$最后，考虑$
$$\int_9^{\infty}\frac{1}{\sqrt{x^4+8x^3-9}-x^2}dx.$$
$如上面讨论，由于\sqrt{x^4}与x^2相消，分母的最高次幂难以确定，我们需将分子分母同时乘以分母的共轭表达式。我们有$
$$\int_9^{\infty}\frac{1}{\sqrt{x^4+8x^3-9}-x^2}dx=\int_9^{\infty}\frac{1}{\sqrt{x^4+8x^3-9}-x^2}\times \frac{\sqrt{x^4+8x^3-9}+x^2}{\sqrt{x^4+8x^3-9}+x^2}$$
$可将其化简为$
$$\int_9^{\infty}\frac{\sqrt{x^4+8x^3-9}+x^2}{8x^3-9}dx.$$


$分母很容易处理：当x\rightarrow \infty时，8x^3-9\sim 8x^3.分子呢？由于x^4+8x^3-9\sim x^4，有\sqrt{x^4+8x^3-9}\sim x^2，最后\sqrt{x^4+8x^3-9}+x^2 \sim 2x^2（当x \rightarrow \infty时）。最后的结论有点难以理解，因为渐近线不能相加或相减。为了确定该说法的正确性，我们需要指出\sqrt{x^4+8x^3-9}+x^2和2x^2的比值当x\rightarrow \infty时趋于1，因为$

$$\lim\limits_{x \to \infty}\frac{\sqrt{x^4+8x^3-9}+x^2}{2x^2}=\lim\limits_{x \to \infty}\frac{1}{2}(\frac{\sqrt{x^4+8x^3-9}}{x^2}+\frac{x^2}{x^2}).$$


$将分母上的x^2拖入根式（为x^4）并化简，上述极限变为$
$$\lim\limits_{x \to \infty}\frac{1}{2}(\sqrt{\frac{x^4+8x^3-9}{x^4}}+1)=\lim\limits_{x \to \infty}\frac{1}{2}(\sqrt{1+\frac{8}{x}-\frac{9}{x^4}}+1)=\frac{1}{2}(\sqrt{1+0-0}+1)=1.$$


$这就证明了当x\rightarrow \infty时，\sqrt{x^4+8x^3=9}+x^2 \sim 2x^2.我们再回到原积分，得到$
$$\frac{1}{\sqrt{x^4+8x^3-9}-x^2}=\frac{\sqrt{x^4+8x^3-9}+x^2}{8x^3-9}\sim \frac{2x^2}{8x^3}=\frac{1}{4x},当x\rightarrow \infty.$$
$运用极限比较判别法，由于\int_9^{\infty}1/(4x)dx发散，因而原积分发散。顺便说一下，你能猜到原被积函数在x\rightarrow \infty时渐进等价于1/4x吗？这个不容易想到，所以如果要用最高次幂起决定作用的结论，要保证有且仅有一个最高次幂。$

#### 21.3.2 三角函数在$\infty$和$-\infty$附近的表现
$我们知道的有用结论仅仅是，对任意实数A有$
$$|\sin(A)|\leq 1 \quad 和 \quad |\cos(A)|\leq 1.$$
$例如，积分$
$$\int_5^{\infty}\frac{|\sin(x^4)|}{\sqrt{x}+x^2}dx$$
$收敛还是发散呢？我们从|\sin(x^4)|\leq 1开始。注意，将A的正弦值换成x^4的正弦值是没有关系的，因为任何数的正弦（或余弦）的绝对值都不超过1.因此，我们有$
$$\int_5^{\infty}\frac{|\sin(x^4)|}{\sqrt{x}+x^2}dx\leq \int_5^{\infty}\frac{1}{\sqrt{x}+x^2}dx.$$
$太棒了，我们去除了表达式中的所有三角函数，右边积分的唯一瑕点出现在\infty 处。由于对于大数x，最高次幂起主要作用，所以我们有当x\rightarrow \infty，\sqrt{x}+x^2 \sim x^2.现在取倒数可得$
$$当x\rightarrow \infty时，\frac{1}{\sqrt{x}+x^2}\sim \frac{1}{x^2}.$$
$由p判别法，我们知道\int_5^{\infty}1/x^2dx收敛，极限比较判别法告诉我们$
$$\int_5^\infty\frac{1}{\sqrt{x}+x^2}dx$$
$也收敛。最后，我们有$
$$\int_5^\infty\frac{|\sin(x^4)|}{\sqrt{x}+x^2}dx\leq \int_5^\infty \frac{1}{\sqrt{x}+x^2}dx<\infty,$$
$所以由比较判别法知原积分收敛。$

$|\sin(A)|\leq 1和|\cos(A)|\leq 1的另一个漂亮应用是，相对于x的任何正数次幂，任何数的正弦或余弦都可忽略，至少在x\rightarrow \infty或x \rightarrow -\infty 时是这样的，例如$
$$当x\rightarrow \infty 时，2x^3-3x^{0.1}+\sin(100x^2{200}) \sim 2x^3.$$

$这个结论对于了解积分$
$$\int_8^\infty \frac{1}{2x^3-3x^{0.1}+\sin(100x^{200})}dx$$
$收敛与否是很用的。由极限比较判别法和上面的渐近等价关系可知，该积分与\int_8^\infty 1/2x^3dx敛散性一致。因为据p判别法，最后一个积分收敛，则原积分收敛。$
#### 21.3.3 指数在$\infty$和$-\infty$附近的表现
$这是一个非常有用的原理：$**指数比多项式增长得快.**$用下面得形式来表示这个原理：$
$$\lim\limits_{x \to \infty}\frac{x^n}{e^x}=0,$$

$$对所有的x>0,e^{-x}\leq \frac{C}{x^n}.$$

$例1，考虑$
$$\int_1^\infty x^3e^{-x}dx.$$


$好消息是，被积函数是正的且只有\infty一个瑕点；坏消息是，因子x^3在x\rightarrow \infty时增长很快。然而因子e^{-x}减小（到0）非常快，其速度要远远快于x^3的增长速度。为了证明这个，我们将关注$
$$e^{-x}\leq \frac{C}{x^5}.$$
$这正好是上面的不等式，只是将n选为5，为什么选5呢？因为它能起作用：$
$$\int_1^\infty x^3e^{-x}dx\leq \int_1^\infty x^3\frac{C}{x^5}dx=C\int_1^\infty \frac{1}{x^2}dx<\infty$$
$我们已经用p判别法得到C\int_1^\infty 1/x^2dx收敛。由比较判别法可知，原积分也收敛。我是怎么知道用x^5的呢？如果换成e^{-x}\leq C/x^4会发生什么？它将不会起作用：$
$$\int_1^\infty x^3e^{-x}dx\leq \int_1^\infty x^3\frac{C}{x^4}dx=C\int_1^\infty \frac{1}{x}dx=\infty.$$


$例2:$
$$\int_{10}^\infty(x^{1000}+x^2+\sin(x)e^{-x^2+6})dx.$$


$e^x在-\infty附近是什么表现呢？这与讨论e^{-x}在\infty附近的表现是一回事。$
$例3：$
$$\int_{-\infty}^{-4}x^{1000}e^xdx,$$

$例4：$
$$\int_4^\infty x^{1000}e^xdx$$

$例5：$
$$\int_{18}^\infty \frac{x^2}{7^x-4^x}dx.$$



#### 21.3.4 对数在$\infty$附近的表现
$\qquad首先注意我们不考虑对数在-\infty附近的情形，因为负数不能取对数，所以讨论当x\rightarrow -\infty时的\ln(x)是没有意义的。$
$\qquad另一方面，$**对数在**$\infty$**处增长得很慢.**$若a>0是你选的某个正数，则不管它有多小，都有：$
$$\lim\limits_{x \to \infty}\frac{\ln(x)}{x^\alpha}=0.$$
$根据上节的讨论，必有一个常数C使得：$
$$对所有x>1,\ln(x)\leq Cx^\alpha.$$
$例1：$
$$\int_2^\infty \frac{\ln(x)}{x^{1.001}}dx.$$
$\ln(x)\leq Cx^\alpha,其中\alpha小到不会影响1.001大于1这样一个性质。例如，如果采用\ln(x)\leq Cx^{0.5},由p判别法可得：$
$$\int_2^\infty \frac{\ln(x)}{x^{1.001}}dx\leq \int_2^\infty \frac{Cx^{0.5}}{x^{1.001}}dx=C\int_2^\infty\frac{1}{x^0.501}dx=\infty.$$
$又白费力气了。我们讨论的积分小于等于\infty，没有任何意义，那我们就更精细一点，采用\ln(x)\leq Cx^{0.0005}是一个很小的数，0.0005是一个很小的数，小到被1.001减后的差任大于1.我们看一下这个不等式的应用结果：$
$$\int_2^\infty \frac{\ln(x)}{x^{1.001}}dx\leq \int_2^\infty \frac{Cx^{0.0005}}{x^{01001}}dx=C\int_2^\infty\frac{1}{x^1.0005}dx<\infty.$$
$上面右边的积分根据p判别法可知是收敛的，因为1.0005大于1.由比较判别法可知，左边的积分也收敛。$


$提醒一下，对数增长缓慢的原理并不是对每个含有对数的反常积分都有效。考虑下面6个反常积分：$
$$\int_2^\infty \frac{\ln(x)}{x^{1.001}}dx, \int_2^\infty\frac{1}{x^{1.001}\ln(x)}dx,
\int_2^\infty \frac{\ln(x)}{x}dx,$$
$$\int_2^\infty \frac{1}{x\ln(x)}dx,\int_{3/2}^\infty \frac{\ln(x)}{x^{0.999}}dx,\int_2^\infty \frac{1}{x^{0.999}\ln(x)}dx.$$

### 21.4 常见函数在0附近的表现
#### 21.4.1 多项式和多项式型函数在0附近的表现
$\qquad 对多项式，最低次幂在x\rightarrow 0时起决定作用，这与x\rightarrow \infty时的情况正好相反。假设p是多项式，则有：$
$$若p(x)的最低次项是bx^m，则当x\rightarrow 0,p(x) \sim bx^m.$$

$例如，当x\rightarrow 0,5x^4-x^3+2x^2 \sim 2x^2.我们通过证明它们之比的极限为1来说明：$
$$\lim\limits{x \to 0}\frac{5x^4-x^3+2x^2}{2x^2}=\lim\limits{x \to 0}(\frac{5x^2}{2}-\frac{x}{2}+1)=0-0+1=1.$$

$对于多项式函数，并不是总能那么容易找到最低次项，不过该原理仍适用，甚至对常数也适用。$

$例1：$
$$\int_0^5\frac{1}{x^2+\sqrt{x}}dx.$$
$唯一的瑕点是x=0,现在我们知道$
$$当x\rightarrow 0^+时，\frac{1}{x^2+\sqrt{x}}\sim \frac{1}{\sqrt{x}},因为\int_0^5\sqrt{x}dx收敛（p判别法），则$$
$$\int_0^5\frac{1}{x^2+\sqrt{x}}dx.$$
$也收敛（极限比较判别法）$
$例2：$
$$\int_0^1\frac{x+3}{x+x^5}dx$$

#### 21.4.2 三角函数在0附近的表现
$这些是很用的结论：$
$$当x\rightarrow 0,\sin(x) \sim x,\tan(x) \sim x 且\cos(x)\sim 1.$$
$例1：$
$$\int_0^1\frac{\sin(x)}{x^{3/2}}dx.$$
$注意：虽然我们只讨论当x\rightarrow 0的情况，但这并不意味着瑕点必须在0处，也可能在\infty处的，像下面的例子：$
$$\int_1^\infty \sin(\frac{1}{x})dx.$$
$$\sin(\frac{1}{x})\sim \frac{1}{x},当x \rightarrow \infty.$$
#### 21.4.3 指数函数在0附近的表现
$感觉上，指数函数对0没有作用，更准确地，$
$$当x\rightarrow 0时，e^x \sim 1和e^{-x}\sim 1$$

$例1：$
$$\int_0^1\frac{e^x}{x^5}dx.$$
$例2：$
$$\int_0^1\frac{e^{-1/x}}{x^5}dx.$$
$例3:$
$$\int_0^2\frac{dx}{\sqrt{e^x-1}}$$
$提示：需使用经典极限\lim\limits_{x \to 0}\frac{e^x-1}{x}=1$
#### 21.4.4 对数函数在0附近的表现
$\qquad这里的原理，当x\rightarrow 0^+时对数函数缓慢趋于-\infty。现在通过取绝对值让对数函数趋于\infty，要知道当0<x<1时对数值为负，所以无论a>0有多小，都存在常数C使得$
$$对于所有0<x<1,|\ln(x)| \leq \frac{C}{x^\alpha}$$

$这是由极限\lim\limits_{x \to 0^+}x^\alpha \ln(x)=0$


$例1：$
$$\int_0^1 \frac{|\ln(x}{x^{0.9}}dx,$$

$例2：$
$$\int_0^{1/2}\frac{1}{x^2|\ln(x)|}dx.$$


$例2：$
$$\int_0^{1/2}\frac{1}{x^{0.9}|\ln(x)|}dx.$$

#### 21.4.5 更一般的函数在0附近的表现
$若一个函数有在0附近收敛于该函数的麦克劳林级数，则函数在x\rightarrow 0时渐近等价于级数的最低次项，即：$
$$f(x)=a_nx^n+a_{n+1}x^{n+1}+...,当x\rightarrow 0,则f(x) \sim a_nx^n.$$
$例1：$
$$\int_0^1\frac{dx}{1-\cos(x)} \qquad 和 \qquad \int_0^1\frac{dx}{(1-\cos(x))^{1/3}}.$$

### 21.5 如何应对不在0或$\infty$处的瑕点
$若瑕点出现在有限而非0处，做换元。具体情况如下：$
- $若积分\int_a^bf(x)dx的唯一瑕点出现在x=a处，做换元t=x-a,注意dt=dx.新的积分则只有0一个瑕点。$
- $若积分\int_a^bf(x)dx的唯一瑕点出现在x=b处，做换元t=b-x,注意dt=-dx.用多出的负号来做积分上下限交换，新的积分则只有0一个瑕点$


