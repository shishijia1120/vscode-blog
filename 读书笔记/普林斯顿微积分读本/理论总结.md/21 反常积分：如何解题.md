## 21 反常积分：如何解题
在上一章中，我们介绍了一些很有用的判别法.为了更加有效地利用这些方法，你需要了解一些常见函数的性质，特别是它们在$0$和$\infty$附近怎样变化的.所谓常见函数是指：多项式函数、三角函数、指数函数和对数函数.


### 21.1 如何开始
给定一个反常积分$\int_a^b f(x)dx$(我们总是假设$f$是连续的或者有有限个不连续的点).之所以称其为反常积分，是因为被积函数$f$在区间$[a,b]$上至少有一个瑕点.瑕点经常出现在$f$的破裂点，如有垂直渐近线的点处，还出现在$\infty和-\infty$处.例如，积分
$$\int_{-\infty}^\infty \frac{1}{x^2-1}dx$$

在$\infty和-\infty$处有瑕点(主要包含它们，就一定有瑕点)，同样$x=1和x=-1$处也有瑕点(因为被积函数在这些点未定义).

#### 21.1.1 拆分积分
下面是基本的对策：
- $(1) 确定区间[a,b]上的所有瑕点；$
- $(2) 将积分拆分成若干积分之和，使得每个积分至多有一个瑕点，并使这些瑕点作为相应积分的上限或下限;$
- $(3) 分别讨论每个积分，如果某一积分发散，则整个积分发散.原反常积分收敛的唯一情形是，每个积分都收敛.$

注意：如果没有瑕点，则积分收敛！

#### 21.1.2 如何处理负函数值
如果$f(x)$在区间$[a,b]$上的某些$x$处取负值，你需要特别小心，这经常出现在三角函数或对数函数中.幸运的是，你能够将问题化简为只有正被积函数的积分.下面是处理负函数值的三种方法.
- $(1) 如果被积函数f(x)在区间[a,b]上既有正值又有负值，应该考虑使用绝对收敛判别法.$

$$如果\int_a^b |f(x)|dx收敛，那么\int_a^b f(x)dx也收敛.$$

\
这个判别法特别适用于讨论当积分区间不是有界的，且包含三角函数的反常积分.但注意不能用绝对收敛判别法判断积分发散！

- $(2) 假设被积函数f(x)在区间[a,b]上恒负(或为0)，即在[a,b]上f(x) \leq 0.则$
$$\int_a^b f(x)dx=-\int_a^b (-f(x))dx$$

- $(3) 如果上面两种情形都不适用，可以用反常积分的正式定义试一下.$
$$\int_0^\infty \cos(x)dx.$$

### 21.2 积分判别法总结
在下面的所有判别法中，被积函数$f(x)$被假定为积分区间上恒正.
- **比较判别法的发散情形**：$若认为\int_a^b f(x)dx发散，那就去找一个积分也发散的较小函数，即找一个使得在区间(a,b)上有f(x) \geq g(x)的非负函数g(x)，且\int_a^bg(x)dx发散。则有$

$$\int_a^b f(x)dx \geq \int_a^b g(x)dx =\infty.$$

\
$因此\int_a^bf(x)dx发散.$

- **比较判别法的收敛情形：**$若认为\int_a^bf(x)dx收敛，那就去找一个积分也收敛的较大函数，即找一个使得在区间(a,b)上有f(x) \leq g(x)的函数g(x)，且\int_a^b g(x)dx收敛，则有$
$$\int_a^b f(x)dx \leq \int_a^b g(x)dx < \infty,$$

$因此\int_a^bf(x)dx也收敛.$



- **极限比较判别法中瑕点为无穷的情形：**$找一个在区间[a,\infty)上没有瑕点、形式较简单的非负函数g，且有当x \rightarrow \infty时，f(x) \sim g(x)，则$
$\quad (1) 若\int_a^\infty f(x)dx收敛，则\int_a^\infty f(x)dx收敛；$
$\quad (2) 若\int_a^\infty f(x)dx发散，则\int_a^\infty f(x)dx发散；$

- **极限比较判别法中瑕点为有限值的情形：**$找一个在区间[a,\infty)上没有瑕点、形式较简单的非负函数g，且有当x \rightarrow a时，f(x) \sim g(x)，则$
$\quad (1) 若\int_a^b f(x)dx收敛，则\int_a^b f(x)dx收敛；$
$\quad (2) 若\int_a^b f(x)dx发散，则\int_a^b f(x)dx发散；$

因此，需要我们找到一个合适的函数$g$来做比较.通过选择$g(x)为1/x^p$的形式，并选择合理的$p$值，能够解决很多的问题.这类函数积分的敛散性可以确定地由$p$判别法描述.

- **p判别法，$\int^\infty$的情形：** 对任意有限值$a>0$，积分
$$\int_a^\infty \frac{1}{x^p}dx,当p>1时收敛，当p \leq 1时发散;$$

- **p判别法，$\int_0$的情形：** 对任意有限值$a>0$，积分
$$\int_0^a \frac{1}{x^p}dx,当p<1时收敛，当p \geq 1时发散;$$


### 21.3 常见函数在$\infty$和$-\infty$附近的表现
现在该回答最重要的问题了：如何选择用于比较的函数$g$?这取决于瑕点在$\infty 、-\infty、0$，还是其他的有限值处，我们将分别讨论.

#### 21.3.1 多项式和多项式型函数在$\infty$附近的表现
自多项式被研究以来，在$x \rightarrow \infty 或 x \rightarrow -\infty$时最高次项起决定作用.更准确地说，设$p$为多项式，则
- $$若p(x)的最高次项是ax^n，则当x\rightarrow \infty或x\rightarrow -\infty时，有p(x) \sim ax^n.$$

\
例如，我们有
$$当 x \rightarrow \infty 时， x^5+4x^4+1 \sim x^5.$$

不用这种说法，也可以通过指出当$x \rightarrow \infty$时，$x^5+4x^4+1$和$x^5$的商的极限为1来验证.过程如下：
$$\lim \limits_{x \rightarrow \infty}\frac{x^5+4x^4+1}{x^5}=\lim \limits_{x \rightarrow \infty}(1+\frac{4}{x}+\frac{1}{x^5})=1.$$

- $若p是一个多项式型函数而不是多项式，则有一个类似原理适用.$

- $有时最高次幂不好确定.$
例如
$$\sqrt{x^4+8x^3-9}-x^2$$

由于我们有许多新的渐进关系，故可以用极限比较判别法分析很多反常积分.
例如，考虑
- $$\int_1^\infty \frac{1}{2+20\sqrt{x}}dx$$

- $$\int_0^\infty \frac{1}{x^5+4x^4+1}dx.$$

由于当$x \rightarrow \infty$时，有$x^5+4x^4+1 \sim x^5$，则对倒数也一样有
$$当 x \rightarrow \infty时，\frac{1}{x^5+4x^4+1} \sim \frac{1}{x^5}.$$

这里需要当心!我们希望讨论的积分与积分$\int_0^\infty 1/x^5dx$表现一样，但问题是这个积分在$x=0$还有一个瑕点.事实上，该积分只因0点的瑕点而发散，这将导致整个结论错误.为了避免这些错误，我们需要将原积分分成两部分:
$$\int_0^1 \frac{1}{x^5+4x^4+1}dx \qquad 和\qquad \int_1^\infty \frac{1}{x^5+4x^4+1}dx$$

第一个因没有瑕点而收敛.对于第二个积分，我们有
$$\frac{1}{x^5+4x^4+1} \sim \frac{1}{x^5}, 当x \rightarrow \infty.$$

由于$\int_1^\infty 1/x^5dx收敛，则积分$
$$\int_1^\infty \frac{1}{x^5+4x^4+1}dx$$

也收敛.两个积分都收敛，所以原积分也收敛.


这种情况经常出现，所以要小心，记着确保将积分进行拆分.基本上，如果"极限比较函数"$g$有原函数没有的瑕点，为了避免产生新的瑕点，你需要将原函数进行拆分.

例子：
- $$\int_2^\infty \frac{3x^5+2x^2+9}{x^6+22x^4+\sqrt{4x^{13}+18x}}dx.$$

。。。
- $$\int_9 ^\infty \frac{1}{\sqrt{x^4+8x^3-9} -x^2}dx.$$
。。。


#### 21.3.2 三角函数在$\infty$附近的表现
我们知道的有，对任意实数A有
$$|\sin(A)|\leq 1 \qquad 和 \qquad |\cos(A)| \leq 1.$$

上述不等式有两个主要的应用，一是可以在很多情况下使用比较判别法.例如，积分
- $\int_5^\infty \frac{|\sin(x^4)|}{\sqrt{x}+x^2}dx$ 


另一个漂亮的应用是，相对于$x$的任何正数次幂，任何数的正弦或余弦值都可忽略，至少在$x\rightarrow \infty或x \rightarrow -\infty$时是这样的.例如
$$当 x\rightarrow \infty时，2x^3-3x^{0.1}+\sin(100x^{200}) \sim 2x^3.$$

为什么？因为当$x$是大数时，正弦项与$2x^3$相比相当地小.更准确地，我们有
$$\lim \limits_{x \rightarrow \infty}\frac{2x^3-3x^{0.1}+\sin(100x^{200})}{2x^3}=\lim \limits_{x \rightarrow \infty}(1-\frac{3}{2x^{2.9}}+\frac{\sin(100x^{200})}{2x^3}).$$

关键点，可以用三明治定理得出
$$\lim \limits_{x \rightarrow \infty}\frac{\sin(100x^{200})}{2x^3}=0.$$

#### 21.3.3 指数函数在$\infty$附近的表现
这是一个非常有用的原理：**指数比多项式增长得快**.
$$\lim \limits_{x \rightarrow \infty}\frac{x^n}{e^x}=0,$$

其中$n$是任意正数，甚至很大的数.

。。。
所以$y=f(x)$的图像必然有最大高度，我们定义为$C$.意思是对所有的$x \geq 0$，$f(x)=\frac{x^n}{e^x} \leq C.$(注意对不同的$n$有不同的$C$与之对应，但这无关紧要.)现在，将$1/e^x$写为$e^{-x}$，并两边同时除以$x^n$，得到一个有用的不等式
$$对所有的x>0，e^{-x} \leq \frac{C}{x^n}.$$

如果将$e^{-x}$换成$e^{-p(x)}$也是对的，这里$p(x)$是当$x\rightarrow \infty$时趋于无穷的任何一个多项式型表达式，底数$e$也可以换成其他大于1的数.。。。

例子：
$$\int_1^\infty x^3 e^{-x}dx.$$
。。。
$$e^{-x} \leq \frac{C}{x^5}.$$

为什么$n$选5呢？因为它能起作用：
$$\int_1^\infty x^3 e^{-x}dx \leq \int_1^\infty x^3 \frac{C}{x^5}dx=C \int_1^\infty \frac{1}{x^2}dx < \infty.$$

如果$n$换成4：
$$\int_1^\infty x^3 e^{-x}dx \leq \int_1^\infty x^3 \frac{C}{x^4}dx=C \int_1^\infty \frac{1}{x}dx = \infty.$$

我们完全白费功夫了.另一方面，如果我们之前用了$x^{4.0001}$就会有用，你只要保证所选的指数为比4大的任意数，该论证就能有作用.

例子：
$$\int_10^\infty (x^{1000}+x^2+\sin(x)e^{-x^2+6})dx.$$


- $e^x$在$-\infty$附近是什么表现呢？
$$\int_{-\infty}^{-4}x^{1000}e^xdx,$$

\
首先做变量代换$t=-x,$由$dt=-dx,$我们有
$$\int_{-\infty}^{-4}x^{1000}e^xdx=-\int_{\infty}^4 (-t)^{1000} e^{-t}dt= \int_4^\infty t^{1000} e^{-t}dt.$$

- 再来考虑加上指数和多项式后会发生什么呢.如你所希望，如果指数变得很大，与多项式相比，它的变化起决定作用.
例如：
$$\int_9^\infty \frac{x^10}{e^x-5x^{20}}dx,$$

。。。
$e^x-5x^{20},e^x$

- $$\int_18^{\infty} \frac{x^2}{7^x-4^x}dx.$$
。。。



#### 21.3.4 对数函数在$\infty$附近的表现












### 21.4 常见函数在0附近的表现

#### 21.4.1 多项式和多项式型函数在0附近的表现


#### 21.4.2 三角函数在0附近的表现



#### 21.4.3 指数函数在0附近的表现


#### 21.4.4 对数函数在0附近的表现


#### 21.4.5 更一般的函数在0附近的表现


### 21.5 如何应对不在0或$\infty$处的瑕点

