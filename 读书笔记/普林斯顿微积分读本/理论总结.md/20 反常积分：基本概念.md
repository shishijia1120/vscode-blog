## 20 反常积分：基本概念
### 20.1 收敛和发散
如果出现下面的情况，积分$\int_a^b f(x)dx$就是反常积分：
- $(1) 函数f在闭区间[a,b]内是无界的;$
- $(2) b=\infty;$
- $(3) a=-\infty.$

第一种情况：如果函数$f(x)$在$x$接近于某点$c$是无界的，那么我们说该函数在$x=c$点有一个**破裂点**.大多数情况下，它就是指有垂直渐近线.

当在$x=a$处有破裂点时，我们有：
$$如果仅仅在x接近于a点该函数f(x)是无界的，则定义\int_{a}^bf(x)dx=\lim \limits_{ \varepsilon \rightarrow 0^+}\int_{a+\varepsilon}^b f(x)dx.$$

在此假设这个极限存在.如果能找到这样的极限，我们就说这个积分收敛；否则认为该积分发散,就像其他的极限一样，由于极限的结果可能为$\infty或-\infty$，或当$\varepsilon \rightarrow 0^+$时它的图像上下振荡，因而这个极限可能没有意义.

#### 20.1.1 反常积分的一些例子
- $\int_{0}^1 \frac{1}{x}dx=\lim \limits_{\varepsilon \rightarrow 0^+}\int_{\varepsilon}^1\frac{1}{x}dx=\lim \limits_{\varepsilon \rightarrow 0^+} \ln|x|_{\varepsilon}^1=\lim \limits_{\varepsilon \rightarrow 0^+}(\ln(1)-\ln(\varepsilon))=\infty.该积分发散$
- $\int_{0}^1 \frac{1}{\sqrt{x}}dx=\lim \limits_{\varepsilon \rightarrow 0^+}\int_{\varepsilon}^1\frac{1}{x^{1/2}}dx=\lim \limits_{\varepsilon \rightarrow 0^+}2x^{1/2}|_{\varepsilon}^1=\lim \limits_{\varepsilon \rightarrow 0^+}(2\sqrt{1}-2\sqrt{\varepsilon})=2.该积分收敛.$

从几何角度来解释，$1/\sqrt{x}$的图像实际上比$1/x$的图像足够接近于$y$轴，以致于它所对应的积分是收敛的;而$1/x$没有那么接近于$y$轴，所以它所对应的积分是发散的.但糟糕的是，对于所有在$x=0$点有渐近线的函数，很难区分哪个函数足够接近于$y$轴，哪个足够远离$y$轴.大多数情况下，你需要分别对待每个积分.

。。。

#### 20.1.2 其他破裂点
- $$如果函数仅仅在x接近于b点是无界的，则定义\int_{a}^bf(x)dx=\lim \limits_{\varepsilon \rightarrow 0^+}\int_a^{b-\varepsilon}f(x)dx,$$

\
在此假设这个极限存在；如果它不存在，那么像前面的例子一样，它是发散的.

- $如果函数f仅仅是在区间(a,b)内的c点无界，那么需要把这个积分分成两部分：\int_{a}^cf(x)dx 和\int_{c}^b f(x)dx.$

上述积分分别为
$$\lim \limits_{\varepsilon \rightarrow 0^+}\int_a^{c-\varepsilon}f(x)dx \qquad和\qquad\lim \limits_{\varepsilon \rightarrow 0^+}\int_{c+\varepsilon}^b f(x)dx,$$

关键点是：只有当这两部分的积分都收敛时，积分$\int_a^b f(x)dx$才是收敛的；如果任何一个发散，那么整个积分就是发散的.


为计算反常积分，如果必要就把它分解的，每一部分最多只有一个瑕点，而且该点要在积分的上下限.(在这里，瑕点指的是破裂点.下一节会有不是破裂点的瑕点.)

来看积分：
$$I=\int_0^3 \frac{1}{x(x-1)(x+1)(x-2)}dx,$$

瑕点是$x=0,1,2和-1，积分区间在0到3之间.$


把原始的积分分成下面5个积分:
$$I_1=\int_{0}^{1/2}\frac{1}{x(x-1)(x+1)(x-2)}dx, \qquad I_2=\int_{1/2}^{1}\frac{1}{x(x-1)(x+1)(x-2)}dx,$$

$$I_3=\int_{1}^{3/2}\frac{1}{x(x-1)(x+1)(x-2)}dx, \qquad I_4=\int_{3/2}^{2}\frac{1}{x(x-1)(x+1)(x-2)}dx,$$

$$I_5=\int_{2}^{3}\frac{1}{x(x-1)(x+1)(x-2)}dx.$$

注意，这5个积分的瑕点都不超过一个，且这些点都在积分的上下限位置.


### 20.2 关于无穷区间上的积分
。。。



### 20.3 比较判别法(理论)
如果函数$f$和$g$在$x=a$点都有垂直渐近线，在其他部分没有破裂点，且区间$[a,b]$内所有$x$都有$0 \leq f(x) \leq g(x),$那么我们有
$$0 \leq \int_{a+\varepsilon}^b f(x)dx \leq \int_{a+\varepsilon}^b g(x)dx$$

对于任何$\varepsilon > 0$成立.如果反常积分$\int_a^bg(x)dx$收敛，那么不等式右边就是个有限的数.


### 20.4 极限比较判别法(理论)
假设有两个函数在破裂点$x=a$是非常接近的(它们再也没有其他的破裂点)，那么积分$\int_a^bf(x)dx$和$\int_a^bg(x)dx$同时收敛或同时发散，它们的行为是相同的.


#### 20.4.1 函数互为渐近线
假设有两个函数$f$和$g$满足
$$\lim \limits_{x \rightarrow a}\frac{f(x)}{g(x)}=1.$$

这就是说，当$x$接近于$a$时，$f(x)/g(x)$的比值非常接近于1的.如果比值是1，那么函数$f(x)$和$g(x)$是相等的；因为比值仅仅是接近于1，所以$f(x)$是非常接近于$g(x)$的.但这并不意味着函数$f(x)$和$g(x)$的差是非常小的!

所以，我们说如果比值的极限是1，那么当$x \rightarrow a $时，$f(x) \sim g(x);$即
$$当x \rightarrow a 时，f(x) \sim g(x)同\lim \limits_{x \rightarrow a}\frac{f(x)}{g(x)}=1有着同样的意义.$$

这并不是说当$x$接近于$a$时，$f(x)$大约等于$g(x)$;它说明当$x$接近于$a$时，$f(x)$和$g(x)$的比值接近于1.


例子：
$$\lim \limits_{x \rightarrow \infty} \frac{3x^3-1000x^2+5x-7}{3x^3}=1, \qquad \lim \limits_{x \rightarrow 0}\frac{\sin(x)}{x}=1,$$

$$\lim \limits_{x \rightarrow 0}\frac{e^x-1}{x}=1,\qquad \qquad 
\qquad \qquad \lim \limits_{x \rightarrow 0}\frac{\ln(1+x)}{x}=1.$$

。。。
实际上，你可以对渐进等价的函数做幂运算，然后得到一对新的渐进等价的函数.你甚至可以让两个渐进等价的函数相除或相乘，假设它们的极限对应的$x$值相同.

加或减这些关系却不适用于上述规则.因为例如当$x \rightarrow 0$时，以$\tan(x) \sim x 和\sin(x) \sim x$开始，那么不能得到$\tan(x)-\sin(x) \sim x-x.x-x$是0，没有什么能同0是渐进等价的.为什么没有呢？因为，如果当$x\rightarrow a$时有$f(x) \sim 0,$这时我们有
$$\lim \limits_{x \rightarrow a}\frac{f(x)}{0}=1.$$

#### 20.4.2 关于判别法的陈述

。。。


### 20.5 $p$判别法(理论)
 
。。。
问题是，我们能选择什么样的$g$函数？最常用的函数是$1/x^p$，其中$p > 0$.

可以使用极限公式得到$p$判别法.
- $P判别法，\int^\infty的情况：对于任何有限值a>0，积分$
$$\int_a^\infty \frac{1}{x^p}dx$$

\
$\qquad在p >1 时是收敛的，在p \leq 1时是发散的.$

- $p判别法，\int_0的情况：对于任何有限值a>0，积分$
$$\int_0^a \frac{1}{x^p}dx$$

$\qquad 在p<1时是收敛的，在p\geq 1时发散的.$

注意，这两种情况是相反的，只是$p=1$除外.其中的积分
$$\int_0^a\frac{1}{x^p}dx \qquad 或 \qquad \int_a^\infty \frac{1}{x^p}dx$$

是收敛的，而另一个积分是发散的.$p=1$的情况对应于$1/x$，我们已经见过，这两个积分在这种情况下都是发散的.

$p判别法真的很有用，其实际应用很广泛，所以千万不要混肴这两种情况！$要记住这种方法的正确情况，就要记住$1/x^2$和$1/\sqrt{x}$的情况，我仅仅记得两个事实：
$$\int_a^\infty \frac{1}{x^2}dx 收敛 , \qquad \int_0^a\frac{1}{\sqrt{x}}dx也收敛.$$

依据这两个事实，就能记住整个$p$判别法！由第一种情况我们知道趋于$\infty$时的情况与趋于0时的情况是相反的，我知道积分
$$\int_0^a \frac{1}{x^2}dx$$

是发散的；同理，由第二种情况我们知道，积分
$$\int_a^\infty \frac{1}{\sqrt{x}}dx$$

也是发散的.

(有个经典的图)

注意，因为$1.0000001>1$，所以积分
$$\int_1^\infty \frac{1}{x^{1.0000001}}dx$$

收敛，尽管$\int_1^\infty 1/xdx$是发散的！仅仅把$x$的幂从1变为1.0000001，这个微小的变化足够引起质变了.这展示出了收敛和发散的精妙之处.

现在证明$p$判别法，幸运的是，这仅仅需要使用20.1节的公式.首先，考虑积分
$$\int_a^\infty \frac{1}{x^p}dx,$$

。。。


$$\int_a^\infty \frac{1}{x^p}dx=\lim \limits_{N \rightarrow \infty}\int_a^N x^{-p}dx=\lim \limits_{N \rightarrow \infty}\frac{1}{1-p}x^{1-p}|_a^N=\frac{1}{1-p}((\lim \limits_{N \rightarrow \infty}N^{1-p})-a^{1-p}).$$

现在如果极限
$$\lim \limits_{N \rightarrow \infty}N^{1-p}$$

存在，那么整个积分$\int_a^\infty 1/x^pdx$是收敛的.如果这个极限不存在，那么该积分是发散的.那么，将上述极限重写为
$$\lim \limits_{N \rightarrow \infty}\frac{1}{N^{p-1}}.$$

如果$p>1$，那么$p-1>0$，所以当$N$很大时$N^{p-1}$非常大；它的倒数变得很小；所以极限是0.最初的积分是收敛的.另一方面，如果$p<1$，那么$p-1<0$，所以$N^{1-p}$非常大，这个极限趋于无穷大，说明原始积分是发散的.这证明了$p$判别法的一半.另一半证明与此类似，只是使用$\varepsilon \rightarrow 0^+$而不是$N \rightarrow \infty$.

### 20.6 绝对收敛判别法
如果这个函数在积分区间不停地在正负之间振荡，则可以应用绝对收敛判别法.陈述如下：
$$如果\int_a^b|f(x)|dx是收敛的，那么\int_a^b f(x)dx也是收敛的.$$

注意：如果原始积分的绝对值是发散的，那么这个原始积分可能还是收敛的!


例子：
- $\int_1^\infty \frac{\sin(x)}{x^2}dx.$
- $\int_0^\infty \cos(x)dx.$

#### 为什么绝对收敛法有用
假设我们知道
$$\int_a^b |f(x)|dx$$

收敛.有一个很好的技巧：设对于$f$的$x$的定义区间$[a,b],$有$g(x)=|f(x)|+f(x).$那么$g$有两个重要特性：首先，$g(x)\geq 0$；其次，$g(x) \leq 2 |f(x)|.$(两种情况下，都假定$x$是$f$定义区间$[a,b]$中的任意数.)

对$g$使用比较判别法:
$$0 \leq \int_a^b g(x)dx \leq 2\int_a^b |f(x)|dx < \infty.$$

结论是
$$\int_a^b g(x)dx$$

也是收敛的.那又怎样呢?注意，$f(x)=g(x)-|f(x)|,$所以
$$\int_a^b f(x)dx=\int_a^b g(x)dx -\int_a^b|f(x)|dx.$$

右侧的两个积分都是收敛的——第一个已经证明了，第二个假设为收敛的——所以，左侧的积分也是收敛的.





