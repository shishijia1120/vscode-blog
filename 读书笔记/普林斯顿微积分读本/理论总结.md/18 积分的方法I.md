## 18 积分的方法I


### 18.1 换元法
如果$f$是可导函数，那么
$$\int \frac{f'(x)}{f(x)}=\ln|f(x)|+C.$$

所以如果分子为分母的导数，这时的积分结果恰好是分母的对数(分母要取绝对值并加C)。

$令t=f(x),所以有dt=f'(x)dx$
$$\int \frac{f'(x)}{f(x)}dx=\int \frac{1}{f(x)}(f'(x)dx)=\int \frac{1}{t}dt=\ln|t|+C.$$

#### 例题
$$\int \frac{3x^2+7}{x^3+7x-9}dx=\ln|x^3+7x-9|+C.$$

$$\int \frac{1}{x \ln(x)}dx=\int \frac{1/x}{\ln(x)}dx=\ln|\ln(x)|+C.$$

#### 18.1.1 换元法和定积分

##### 例题
$$\int_0^{\sqrt[3]{\pi /2}}x^2\cos(x^3)dx$$

在定积分中使用换元法，有两种方法。

1. 先计算不定积分，然后把积分上下限写上。
$$\int x^2 \cos(x)dx=\int \cos(t)\frac{dt}{3}=\frac{1}{3}\int \cos(t)dt=\frac{1}{3}\sin(t)+C=\frac{1}{3}\sin(x^3)+C.$$
2. 一直计算定积分
$$\int_0^{\sqrt[3]{\pi /2}}x^2\cos(x^3)dx=\frac{1}{3}\int_0^{\pi/2}\cos(t)dt.$$

##### 更复杂的例子
$$\int_{1/sqrt{2}}^{\sqrt{3}/2}\frac{1}{\sin^{-1}(x)\sqrt{1-x^2}}dx.$$

$令t=\sin^{-1}(x),dt/dx=1/\sqrt{1-x^2}.$

#### 18.1.2 如何换元
怎样选择被替代的函数呢？基本思想是寻找其导数也在被积函数中的那些部分。
$$\int  $$









#### 18.1.3 换元法的理论解释
。。。

### 18.2 分部积分法
前面换元法是逆用链式求导法则，还有一种方法可以逆用乘积法则，我们称之为分部积分法。

。。。
#### 例题
$$\int xe^xdx.$$

$$u=x \qquad \qquad v=e^x$$

$$du=dx \qquad \qquad dv=e^xdx;$$

$$\int u dv =uv - \int v du$$

$$\int x \overbrace{e^xdx}=x e^x-\int e^xdx.$$

$得到\int xe^xdx=xe^x-e^x+C.$

### 18.3 部分分式
怎样对一个有理函数求积分，
$$\int \frac{p(x)}{q(x)}dx,$$

其中p和q为多项式.

**基本方法是：** 首先会看怎样处理有理函数，我们通过一些代数运算把它分解成几个更简单的有理函数的和的形式；然后将看到如何对这些简单的有理函数求积分.
更简单的有理函数如一个常数除以一个线性函数，要么像一个线性函数除以一个二次函数。

#### 18.3.1 部分分式的代数运算
我们的目的是把一个有理函数分成许多更简单的部分。第一步是确保这个函数的分子的次数小于分母的次数。如果不是这样，我们需要先做一个多项式的除法。

$\qquad$除法进行结束后，接下来，来分解分母中的因式。如果分母是一个二次函数，请检验它的判别式：如果判别式为负，你不能对它进行因式分解。否则，可以手动进行因式分解或使用二次公式。如果分母很复杂，你就不得不猜想一个根，然后再使用多项式的除法.
$\qquad$在因式分解分母之后，下一步要写下的东西叫做"分部".这是通过把分母的一个或更多的因式加到一起构成的，它依据如下的规则：
1. 如果有线性式$(x+a)$，那么这个分部有如下形式：
$$\frac{A}{x+a}.$$

2. 如果有线性式的平方($x+a)^2$,那么这个分部有如下形式：
$$\frac{A}{(x+a)^2}+\frac{B}{x+a}.$$

3. 如果有二次多项式$(x^2+ax+b),$那么这个分部有如下形式：
$$\frac{Ax+B}{x^2+ax+b}.$$

4. 如果有线性式的三次方($x+a)^3$,那么这个分部有如下形式：
$$\frac{A}{(x+a)^3}+\frac{B}{(x+a)^2}+\frac{C}{x+a}.$$

5. 如果有线性式的四次方($x+a)^4$,那么这个分部有如下形式：
$$\frac{A}{(x+a)^4}+\frac{B}{(x+a)^3}+\frac{C}{(x+a)^2}+\frac{D}{(x+a)}.$$

##### 例子
$$\int \frac{x+2}{x^2-1}dx$$

- 分母可因式分解为$(x+1)(x-1);$所以我们有两个线性因子，分部为：
$$\frac{A}{x-1}+\frac{B}{x+1}.$$

$$\frac{x+2}{(x^2-1)}=\frac{A}{x-1}+\frac{B}{x+1}.$$

- 等式两侧同时乘以分母可得：
$$x+2=A(x+1)+B(x-1)$$

- 求解常数A和B(两种方法)：

1. 替代法：替代x，分别设x=1，-1得到：
$$\begin{cases}
        1+2=A(1+1) \\
        -1+2=B(-1-1)
\end{cases}$$

$\qquad A=\frac{3}{2} ,B=-\frac{1}{2}$

2. 将原始方程重写为:
$$x+2=(A+B)x+(A-B).$$

$\qquad A=\frac{3}{2} ,B=-\frac{1}{2}$

到目前为止，我们看到除非分子的次数小于分母的次数，否则都要做一个多项式的除法，然后对分母进行因式分解，写下它的每一个分部，再使用上述两种方法中的一个计算这些未知的常数。最后我们写下这些积分的各个部分。

#### 18.3.2 对每一部分积分
我们需要知道在把原始积分分成小部分后怎样求解每一部分的积分。

1. 简单的积分形式是：
$$\int \frac{1}{ax+b}dx.$$

$\qquad令t=ax+b，dt=adx$

$$\int \frac{1}{t}(\frac{1}{a}dt)=\frac{1}{a}\int \frac{1}{t}dt=\frac{1}{a}\ln|t|+C.$$

2. 若分母是线性因式的幂，这种方法也是适用的：
$$\int \frac{1}{(4x+5)^2}dx,$$

$\qquad 令t=4x+5换元.$
$$\int \frac{1}{(4x+5)^2}dx=\frac{1}{4}\int \frac{1}{t^2}dt=-\frac{1}{4}(1/t)+C=-\frac{1}{4(4x+5)}+C.$$

3. 当分母是一个二次函数时，情况就会变得很复杂，像这样：
$$\int \frac{Ax+B}{ax^2+bx+c}dx.$$

请注意，如果分母可以因式分解，那么就转化为了第一种情况.

如果分母的二次多项式不能因式分解，即它的判别式$b^2-4ac为负.$这类积分的一个例子是
$$\int \frac{x+8}{x^2+6x+13}dx.$$

这个分母不能因式分解，所以对于这道题不能使用刚才的代数运算方法.我们没有必要去使用任何分部，所要计算的就是求这个积分.其做法是：把分母写成平方的形式，然后再换元。在这个例子中，先完成配方：
$$x^2+6x=13=x^2+6x+9+13-9=(x+3)^2+4.$$

换元$t=x+3,dt=dx$

$$\int \frac{x+8}{x^2+6x+13}dx=\int \frac{x+8}{(x+3)^2+4}dx=\int \frac{(t-3)+8}{t^2+4}dt=\int \frac{t+5}{t^2+4}dt.$$

第二步是把这个积分分成两个积分，并把常数5移到积分符号的外边。所以上述积分变为：
$$\int \frac{t}{t^2+4}dt+5\int \frac{1}{t^2+4}dt.$$

$\int \frac{t}{t^2+4}dt=\frac{1}{2}\int \frac{2t}{t^2+4}dt=\frac{1}{2}\ln|t^2+4|+C.$

$5\int \frac{1}{t^2+4}dt=5\times \frac{1}{2}\tan^{-1}(\frac{t}{2})+C.$

##### 有用的公式
$$\int \frac{1}{t^2+a^2}dt=\frac{1}{a}\tan^{-1}(\frac{t}{a})+C.$$

**注意：** 如果分母的最高项的系数不是1，最好在配方之前把这个系数提出去.


#### 18.3.3 方法和一个完整的例子
这是一个关于有理函数积分的完整方法.

- 第一步——**先看分子分母最高项的次数，如有必要请做除法。** 查看分子的次数是否小于分母次数。如果你运气好，直接进入第二步；如果不是，就要做一个多项式的除法了，然后再进入第二步。
- 第二步——**对分母进行因式分解。** 使用二次公式或猜想一个根，然后再做除法，以便因式分解被积函数的分母.
- 第三步——**分部.** 像之前描述的那样，分别写出带有未知常数的"分部".写下一个像这样的等式：
        $\qquad \qquad \qquad \qquad \qquad \qquad $被积函数=分部
- 第四步——**计算常数的值。** 把方程两边同时乘以分母，通过任一方法计算常数的值：（a）换掉x的值；（b）系数相等法;或者结合使用(a)和(b)两种方法.
- 第五步——求解分母为线性项次幂的积分。求解分母是线性函数次幂的积分；答案将会是对数形式或该线性项的负次幂.
- 第六步——对分母是二次函数的被积函数求积分。对于分母是二次函数且不能因式分解的被积函数求积分，先配方，然后换元，再把它尽可能分解成两个积分。


$$\int \frac{x^5-7x^4+19x^3-10x^2-19x+18}{x^4-5x^3+9x^2}dx.$$