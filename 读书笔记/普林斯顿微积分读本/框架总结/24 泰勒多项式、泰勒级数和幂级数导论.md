## 24 泰勒多项式、泰勒级数和幂级数导论
### 24.1 近似值和泰勒多项式
对任意实数$x$，我们有
$$e^x \approx 1+x+\frac{x^2}{2}+\frac{x^3}{6}.$$

$x$越趋近于0，近似程度就越好.

#### 24.1.1 重访线性化
在点$(a,f(a)$附近，与曲线$y=f(x)$最近似的直线方程是:
$$y=f(a)+f'(a)(x-a).$$
这就是$f在x=a$的线性化。

#### 24.1.2 二次近似
这次讨论抛物线，在点$(a,f(a)$附近，与曲线$y=f(x)$最近似的二次曲线方程是:
$$y=f(a)+f'(a)(x-a)+\frac{f''(a)}{2}(x-a)^2.$$

我们称该二次函数为$P_2=f(a)+f'(a)(x-a)+\frac{f''(a)}{2}(x-a)^2.$
现在，我们搜集一些关于$P_2$的好结论.
- 1) 当$x=a$时，$P_2$与$f$的零阶导相等.
- 2) 对$P_2$求导可得$P'_2(x)=f'(a)+f''(a)(x-a).$若代入$x=a$，可知$P'_2(a)=f'(a)$.当$x=a$时，一阶导$P'_2与f'$也相等.
- 3) 再求一次导可得$P''_2(x)=f''(a).$当$x=a$，有$P''_2(a)=f''(a)$.所以当$x=a$时，二阶导$P'_2与f'$也相等.
- 4) 另一方面，由于$f''(a)$为常数，所以对所有$x$有$P'''_2(x)=0$，对所有更高阶导数均有相同的结论.(毕竟，$P_2$是二次的，任何二次函数的三阶或更高阶导数必处处为0!)

所以$P_2与f$在$x=a$有相同的零阶导、一阶导和二阶导，但$P_2$的三阶导或更高阶导恒为0.可以说，P_2提取了$f在x=a$处二阶导及以下的所有信息.

另一个关于$P_2$的好结论是：若忽视$P_2(x)$方程右边的最后一项，就得到$f(a)+f'(a)(x-a).$这恰恰是上一节的线性化，所以可以认为最后的项$\frac{1}{2}f''(a)(x-a)^2$为所谓的二阶修正项。这意味着我们能够找到比切线更好的近似.二阶修正项有助于更接近于曲线，至少当$x$在$a$附近时是这样的.(当$f''(a)=0$是例外，在这种情况下，$P_2$仅为线性化，并不能使近似更好.)

#### 24.1.3 高阶近似
问题：对$a$附近的$x$，哪个次数为$N$或更低的多项式最近似于$f(x)?$

**泰勒近似定理**：$$ 若f在x=a光滑，则在所有次数为N或更低的多项式中，当x在a附近时，最近似于f(x)的是$$

$$P_N(x)=f(a)+f'(a)(x-a)+\frac{f''(a)}{2!}(x-a)^2+\frac{f^{(3)}(a)}{3!}(x-a)^3+\cdots+\frac{f^{(N)}(a)}{N!}(x-a)^N.$$

用求和号表示该公式为：
$$P_N(x)=\sum_{n=0}^N \frac{f^{(n)}(a)}{n!}(x-a)^n.$$

我们称多项式$P_N$为$f(x)$在$x=a$处的N阶泰勒多项式.注意$P_N$的次数可能小于$N$.例如，若$f^{(N)}(a)=0$，则上述和式的最后一项为0，$P_N$的次数至多为$N-1$.因此，我们称之为$N$阶泰勒多项式而不是$N$次泰勒多项式.

再次强调$P_N$的重要性质是对所有$n=0,1,\cdots,N.$
$$P_N^{(n)}(a)=f^{(n)}(a),$$

即当$x=a$时，$P_N$的所有$N$阶导数及以下的导数值都与$f$对应值相等，但是$P_N$的所有更高阶导数必须处处为0.函数$P_N$提取了$f$在$x=a$处直到$N$阶导数的所有信息.

$$P_3(x)=1+x+\frac{1}{2}x^2+\frac{1}{6}x^3.$$

在所有的次数为3或更低次的多项式中，这个多项式是与$x$在0附近的$e^x$最近似的.每次使$N$加1都会使近似通过加上另一个修正像而变得更好.

其实泰勒近似定理依赖于泰勒定理；近似定理也有一些模糊不清的说法"最好的近似"究竟是什么意思？

#### 24.1.4 泰勒定理
我们想用$P_N(x)$的值来获取$f(x)$的近似值，所以考虑误差项，即真实值和近似值之差：
$$R_N(X)=f(x)-P_N(x).$$

实际上，$R_N(x)$被称为N阶误差项，也称为N阶余项，因为它就是从$f(x)$取走$P_N(x)$所余下的部分。
**泰勒定理：**
$$关于x=a的N阶余项 R_N(x)=\frac{f^{(N+1)}(c)}{(N+1)!}(x-a)^{N+1}，其中c是介于x与a之间的一个数.$$

注意数$c$依赖于$x和N$，一般不能确定！由于$f(x)=P_N(x)+R_N(x)$，则我们可以写为：
$$f(x)=\sum_{n=0}^N \frac{f^{(n)}(a)}{n!}(x-a)^n+\frac{f^{(N+1)}(c)}{(N+1)!}(x-a)^{N+1}$$

### 24.2 幂级数和泰勒级数
这是另一个结论：
$$e^x=1+x+\frac{x^2}{2!}+\frac{x^3}{3!}+\frac{x^4}{4!}+\frac{x^5}{5!}+\cdots$$

对所有实数$x$均成立.你可能会注意到它与24.1节开头的近似类似，但有两点明显不同.首先，我们不再讨论近似；其次，右边是一个无穷级数。当面对无穷级数时，要小心了.

#### 24.2.1 一般幂级数
关于$x=0$的幂级数是形为
$$a_0+a_1x+a_2x^2+a_3x^3+a_4x^4+\cdots$$

的式子，其中数$a_n$是确定的常数.上述级数也可以用求和号写为:
$$\sum_{n=0}^\infty a_nx^n.$$

对给定的$x$，我们经常将方程写成
$$f(x)=a_0=a_1x+a_2x2+a_3x3+a_4x4+\cdots$$

的形式.意思是若将$x$取值范围内的一个值代入，幂级数就变为收敛于值$f(x)$的常规级数。

例如，我们已经说过(但未证明)的
$$e^x=1+x+\frac{x^2}{2!}+\frac{x^3}{3!}+\frac{x^4}{4!}+\frac{x^5}{5!}+\cdots$$

对所有$x$均成立.另一方面，当我们讨论22.2节等比数列的求和方法时，有
$$1+r+r^2+r^3+r^4+\cdots=\sum_{n=0}^\infty r^n=\frac{1}{1-r}, \quad-1 <r < 1.$$

用$x$代换$r$:
$$1+x+x^2+x^3+x^4+\cdots=\sum_{n=0}^\infty x^n=\frac{1}{1-x}, \quad -1 <x<1.$$

即，当$-1 <x <1,$
$$\frac{1}{1-x}=1+x+x^2+x^3+x^4+\cdots.$$
 
若将$x$换成任意一个在该区间的数.右边就得到一个常规级数，收敛于左边的值.另一方面，若$x>1或x\leq 1$又会怎样呢?左边有意义，但右边没有意义，因为对$x$的这些值，级数发散(当$x$等于1时，两边都无定义.)

当$x=0$时，幂级数
$$a_0+a_1x+a_2x^2+a_3x^3+a_4x^4+\cdots$$

有一些很好的性质：除了开始的$a_0$，其他所有项都没了，所以级数自动收敛.(当然，收敛于a_0!)但这并没有告诉我们，对其他的$x$值，级数是否收敛.

不可否认，0是一个很受欢迎的数，但它并不比其他的实数特殊.我们可将这个特殊的性质转移到其他的数$a$.我们只需将$x$换为$(x-a).$故下面是幂级数在$x=a$的一般表达式：
$$a_0+a_1(x-a)+a_2(x-a)^2+a_3(x-a)^3+a_4(x-a)^4+\cdots.$$

用求和号表示为
$$\sum_{n=0}^\infty a_n(x-a)^n.$$

当$x=a$时该级数当然收敛.因为除了$a_0$外，其他所有项都没有了.数$a$称为幂级数的中心.什么时候需要考虑中心不为0的幂级数呢？一个可能的例子是，你想求收敛于$\ln(x)$的幂级数.该量在$x=0$没有定义，所以想求收敛于$\ln(x)$的在$x=0$的幂级数是愚蠢的行为.另一方面，我们能找到一个以1为中心且收敛于$\ln(x)$的幂级数，至少对$x$的某些值是可以的.实际上，在26.2.1节，我们将看到等式
$$\sum_{n=1}^\infty \frac{(-1)^{n-1}}{n}(x-1)^n=\ln(x)$$

对$-1 < (x-1) < 1$成立，即对$0<x<2$成立.(甚至对x=2也成立):
$$\sum_{n=1}^\infty \frac{(-1)^{n-1}}{n}=1-\frac{1}{2}+\frac{1}{3}-\frac{1}{4}+\frac{1}{5}-\cdots=\ln(2).$$

不过，这个不是很容易证明

#### 24.2.2 泰勒级数和麦克劳林级数
在上一节中，我们看到在$x=a$时的一般幂级数为(求和号表示形式和展开式)
$$\sum_{n=0}^\infty a_n(x-a)^n=a_0+a_1(x-a)+a_2(x-a)^2+a_3(x-a)^3+a_4(x-a)^4+\cdots$$

在$x=a$收敛，也可能在$x$的其他值收敛.


假设我们从一个光滑函数$f$开始.用$f$的所有导数定义一个在$x=a$的幂级数
$$\sum_{n=0}^\infty \frac{f^{(n)}(a)}{n!}(x-a)^n.$$

将求和号展开后变为
$$f(a)+f'(a)(x-a)+\frac{f''(a)}{2!}(x-a)^2+\frac{f^{(3)}(a)}{3!}(x-a)^3+\frac{f^{(4)}(a)}{4!}(x-a)^4+\cdots.$$

该幂级数的系数为$a_n=f^{(n)}(a)/n!.$该级数称为$f$关于$x=a$的泰勒级数.所以，从函数开始，我们定义了幂级数.

仔细看一下上面泰勒级数的定义，应该很面熟吧。和泰勒多项式$P_N(x)$的定义很像。唯一的区别是，和式没有终止于$n=N$，而是一直持续到$\infty$.换句话说，泰勒多项式$P_N(x)$是泰勒级数的$N$项部分和.

**麦克劳林级数** ：它是$f$关于$x=0$的泰勒级数的另一个名字，所以，
$$\sum_{n=0}^\infty \frac{f^{(n)}(0)}{n!}x^n,$$

展开式为
$$f(0)+f'(0)+\frac{f''(0)}{2!}x^2+\frac{f^{(3)}(0)}{3!}x^3+\frac{f^{(4)}(0)}{4!}x^4+\cdots.$$

无论什么时候看到麦克劳林级数这几个字，脑子里想着$a=0$的泰勒级数就可以了。

#### 24.2.3 泰勒级数的收敛性
那么，你是怎么知道泰勒级数是否何时收敛于原来的函数呢？跟21.1.4节一样，从
$$f(x)=P_N(x)+R_N(x)$$

开始，记住，
$$P_N(x)=\sum_{n=0}^N \frac{f^{(n)}(a)}{n!}(x-a)^n \quad  和\quad R_N(X)=\frac{f^{(N+1)}(c)}{(N+1)!}(x-a)^{N+1}.$$

这将$f(x)$表示为近似值$P_N(x)$与误差项或者余项$R_N(x)$的和.这里比较聪明的想法是：令$N$越来越大，这样就有希望使近似值$P_N(x)$越来越接近于实际值$f(x)$;也就是希望误差$R_N(x)$越来越小.

我们尝试用等式来描述上面的论述.假设对某些$x$，我们已知
$$\lim \limits_{N  \rightarrow \infty}R_N(x)=0.$$

对等式$f(x)+P_N(x)+R_N(x)取N\rightarrow \infty$的极限，得到
$$\lim \limits_{N  \rightarrow \infty}f(x)=\lim \limits_{N  \rightarrow \infty}P_N(x)+\lim \limits_{N  \rightarrow \infty}R_N(x)=\lim \limits_{N  \rightarrow \infty}P_N(x).$$

由于$f(x)$不依赖于$N$，左边就是$f(x)$,所以我们知道
$$f(x)=\lim \limits_{N  \rightarrow \infty}P_N(x)=\lim \limits_{N  \rightarrow \infty} \sum_{n=0}^N \frac{f^{(n)}}{n!}(x-a)^n=\sum_{n=0}^\infty \frac{f^{(n)}}{n!}(x-a)^n.$$

所以$f(x)$等于它的泰勒级数！换句话说，**若想证明一个函数在某些数$x$处等于它的泰勒级数，可尝试证明当$N \rightarrow \infty$时，$R_N(x)\rightarrow 0.$**
\

- $证明对f(x)=e^x,a=0做这些讨论：$
即证明$$\lim \limits_{N  \rightarrow \infty}R_N(x)=\lim \limits_{N  \rightarrow \infty}e^c \frac{x^{N+1}}{(N+1)!}=0.$$

- 求$f(x)=\cos(x)的麦克劳林级数并证明它对所有x都收敛于f(x).$

### 24.3 一个有用的极限
这一节根幂级数没有关系，只是关于前面几节中用过两次的极限证明：
$$\lim \limits_{N \rightarrow \infty}\frac{x^{N+1}}{(N+1)!}=0$$

对所有实数$x成立，令$n=N+1$(就像积分中的换元)，则与证明
$$\lim \limits_{n \rightarrow \infty}\frac{x^n}{n!}=0$$

对所有实数$x$成立一样.有一些方法可证明后一个结论，不过这有一个不显眼的方法.我先来解释一下要用到的逻辑，然后再用该方法.我将证明级数
$$\sum_{n=0}^\infty \frac{x^n}{n!}$$

收敛。不必考虑$x$是什么.(是的，我们知道它其实收敛于$e^x$，但这是等到我们证明极限为0之后才知道的!)不管怎样，级数收敛于什么没有关系，仅仅知道级数收敛就足够了.为什么？因为那样的话，第$n$项$x^n/n!$一定随着$n$趋于$\infty$而趋于0，否则第$n$项判别法就不对了.因此，我们用比式判别法来证明级数对所有$x$收敛.固定$x，a_n=x^n/n!,$看一下比值的极限：
$$L=\lim \limits_{n \rightarrow \infty}|\frac{a_{n+1}}{a_n}|=\lim \limits_{n \rightarrow \infty}|\frac{x^{n+1}/(n+1)!}{x^n/n!}|=\lim \limits_{n \rightarrow \infty}|\frac{x^{n+1}}{x^n}\frac{n!}{(n+1)!}|.$$

最后极限为
$$\lim \limits_{n \rightarrow \infty}|x|\frac{1}{n+1}=0.$$

由于$|x|$固定且$1/(n+1)$趋于0，极限为0，小于1，所以级数收敛，且我们也顺便证明了极限的正确性.固定$x$，然后对该特定的$x$运用比式判别法，来判别级数收敛的方法将在26.1.2节多次用到.