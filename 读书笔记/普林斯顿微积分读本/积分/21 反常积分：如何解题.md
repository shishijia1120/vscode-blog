<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({ tex2jax: {inlineMath: [['$', '$']]}, messageStyle: "none" });
</script>


## 21 反常积分：如何解题
> 上一章中，我们介绍了一些很有用的判别方法。为了更加有效地利用这些方法，你需要了解一些常见函数的性质，特别是它们在0和$\infty$附近是怎么变化的。常见函数是指：多项式函数、三角函数、指数函数和对数函数。
### 21.1 如何开始
$给定一个反常积分\int_a^bf(x)dx，之所以称其为反常积分，是因为被积函数f在区间[a,b]上至少有一个瑕点。瑕点经常出现在f的破裂点，如有垂直渐近线的点出，还出现在\infty和-\infty处.例如，积分$
$$\int _{-\infty}^{\infty} \frac{1}{x^2-1}dx$$
#### 21.1.1 拆分积分
$下面是基本的对策：$

- $ 1. 确定区间[a,b]上的所有瑕点；$
$2. 将积分拆分成若干积分之和，使得每个积分至多有一个瑕点，并使这些瑕点作为相应积分的上限或下限；$
$3. 分别讨论每个积分，如果某一积分发散，则整个积分发散。每个积分都收敛，则整个积分收敛。$

$有一个重要情形：如果没有瑕点会怎样呢？也就是说，假设有积分\int_a^bf(x)dx，它的积分区间[a,b]是有界的（故没有\infty和-\infty），并且f在闭区间[a,b]上有界的，即f没有瑕点，所以我们知道积分\int _a^bf(x)dx收敛。总之，$**如果没有瑕点，则积分收敛！**
####  21.1.2 如何处理负函数值
$如果f(x)在区间[a,b]上的某些x处取负值，你需要特别小心，这经常出现在三角函数或对数函数中。幸运的是，你能够将问题简化为只有正被积函数的积分。下面是处理负函数值的三种方法：$

- $(1) 如果被积函数f(x)在区间[a,b]上既有正值又有负值，应该考虑使用绝对收敛判别法。$
$$如果\int_a^b|f(x)|dx收敛，那么\int_a^bf(x)dx也收敛。$$
**记住：绝对收敛判别法只能帮你判断积分收敛，不能用绝对收敛判别法判断积分发散！**
$(2) 假设被积函数f(x)在区间[a,b]上恒负（或为0），则$
$$\int_a^bf(x)dx=-\int_a^b(-f(x))dx$$
$现在-f(x)非负，所以可以用比较判别法或p判别法来看\int_a^b(-f(x))dx收敛还是发散.$
$(3) 如果上面两种情形都不适用，可以用反常积分的正式定义试一下。$
### 21.2 积分判别法总结
>目前你可以使用的最有价值的工具是比较判别法、极限比较判别法和p判别法。

**在下面的所有判别法中，被积函数f(x)被假定为在积分区间上恒为正。**
- **比较判别法的发散情形：**
  $\qquad 若认为\int_a^bf(x)dx发散，那就去找一个积分也发散的较小函数，即找一个使得在区间(a,b)上有f(x)\geq g(x)的非负函数g(x)，且\int_a^bg(x)dx发散，则有$
  $$\int_a^bf(x)dx\geq \int_a^bg(x)dx=\infty,$$
  $因此\int_a^bf(x)dx发散.$

\
- **比较判别法的收敛情形：**
  $\qquad 若认为\int_a^bf(x)dx收敛，那就去找一个积分也收敛的较大函数，即找一个使得在区间(a,b)上有f(x)\leq g(x)的函数g(x)，且\int_a^bg(x)dx收敛，则有$
  $$\int_a^bf(x)dx\leq \int_a^bg(x)dx<\infty,$$
  $因此\int_a^bf(x)dx收敛.$
\
  
$极限判别法是比较判别法的替代形式。使用该判别法的重点是，能找到一个和被积函数在瑕点附近敛散性一致的函数。$
- **极限比较判别法中瑕点为无穷的情形：**
  $\qquad  找一个区间[a,\infty]上没有瑕点、形式较简单的非负函数g，且有当x\rightarrow \infty时，f(x)\sim g(x)，则$
   $(1)\quad  \int_a^\infty g(x)dx收敛，则\int_a^\infty f(x)dx收敛.$
   $(2)\quad  \int_a^\infty g(x)dx收发散，则\int_a^\infty f(x)dx发散.$
  $当然，将区间[a,\infty)换位(-\infty,b]也成立.还有一种情形也成立，即瑕点为积分区间左端点处的有限值a.$

\

- **极限比较判别法中瑕点为有限值的情形：**
  $\qquad  找一个区间[a,b]上没有瑕点、形式较简单的非负函数g，且有当x\rightarrow a时，f(x)\sim g(x)，则$
  $(1)\quad  \int_a^\infty g(x)dx收敛，则\int_a^\infty f(x)dx收敛.$
   $(2)\quad  \int_a^\infty g(x)dx收发散，则\int_a^\infty f(x)dx发散.$
  $不用说，针对唯一的瑕点在右端点x=b,且有当x\rightarrow b(而不是a)时f(x)\sim g(x)的情形，结论相同.$

  \
$\qquad 因此，需要我们找到一个合适的函数g来做比较。通过选择g(x)为1/x^p的形式，并选择合理的p值，能够解决很多问题。这类函数积分的敛散性可以准确地由p判别法描述.$
- **p判别法，$\int^{\infty}的情形：$**
  $对任意有限值a>0，积分$
  $$\int_a^{\infty}\frac{1}{x^p}dx，当p>1时收敛，当p\leq 1时发散；$$

\\
- **p判别法，$\int_0的情形：$**
  $对任意有限值a>0，积分$
  $$\int_0^{a}\frac{1}{x^p}dx，当p<1时收敛，当p\geq 1时发散.$$

### 21.3 常见函数在$\infty和-\infty附近的表现$
$现在该回答最重要的问题了：如何选择用于比较的函数g？这取决于瑕点在\pm\infty 、0，还是其他的有限值处，我们将分别讨论。$
#### 21.3.1 多项式和多项式型函数在$\infty和-\infty$附近的表现
$\quad自多项式被研究起来，在x\rightarrow \infty或x\rightarrow -\infty时最高次项起决定作用。更准确地说，设p为多项式，则$
$$若p(x)的最高次项是ax^n，则当x\rightarrow \infty或x\rightarrow -\infty时，有p(x)\sim ax^n.$$
$例子：$
$$\int_2^{\infty}\frac{3x^5_2x^2+9}{x^6+22x^4+\sqrt{4x^{13}+18x}}dx.$$
$这个问题有点复杂，唯一的瑕点是\infty.我们有$
$$当x\rightarrow \infty 时，\frac{3x^5+2x^2+9}{x^6+22x^4+\sqrt{4x^{13}+18x}}\sim \frac{3x^5}{2x^{13/2}}=\frac{3}{2}\frac{1}{x^{3/2}}$$
$由p判别法可知积分$
$$\frac{3}{2}\int_2^{\infty}\frac{1}{x^{3/2}}dx$$
$收敛，所以由极限比较判别法可知原积分也收敛.$


$最后，考虑$
$$\int_9^{\infty}\frac{1}{\sqrt{x^4+8x^3-9}-x^2}dx.$$
$如上面讨论，由于\sqrt{x^4}与x^2相消，分母的最高次幂难以确定，我们需将分子分母同时乘以分母的共轭表达式。我们有$
$$\int_9^{\infty}\frac{1}{\sqrt{x^4+8x^3-9}-x^2}dx=\int_9^{\infty}\frac{1}{\sqrt{x^4+8x^3-9}-x^2}\times \frac{\sqrt{x^4+8x^3-9}+x^2}{\sqrt{x^4+8x^3-9}+x^2}$$
$可将其化简为$
$$\int_9^{\infty}\frac{\sqrt{x^4+8x^3-9}+x^2}{8x^3-9}dx.$$


$分母很容易处理：当x\rightarrow \infty时，8x^3-9\sim 8x^3.分子呢？由于x^4+8x^3-9\sim x^4，有\sqrt{x^4+8x^3-9}\sim x^2，最后\sqrt{x^4+8x^3-9}+x^2 \sim 2x^2（当x \rightarrow \infty时）。最后的结论有点难以理解，因为渐近线不能相加或相减。为了确定该说法的正确性，我们需要指出\sqrt{x^4+8x^3-9}+x^2和2x^2的比值当x\rightarrow \infty时趋于1，因为$

$$\lim\limits_{x \to \infty}\frac{\sqrt{x^4+8x^3-9}+x^2}{2x^2}=\lim\limits_{x \to \infty}\frac{1}{2}(\frac{\sqrt{x^4+8x^3-9}}{x^2}+\frac{x^2}{x^2}).$$


$将分母上的x^2拖入根式（为x^4）并化简，上述极限变为$
$$\lim\limits_{x \to \infty}\frac{1}{2}(\sqrt{\frac{x^4+8x^3-9}{x^4}}+1)=\lim\limits_{x \to \infty}\frac{1}{2}(\sqrt{1+\frac{8}{x}-\frac{9}{x^4}}+1)=\frac{1}{2}(\sqrt{1+0-0}+1)=1.$$


$这就证明了当x\rightarrow \infty时，\sqrt{x^4+8x^3=9}+x^2 \sim 2x^2.我们再回到原积分，得到$
$$\frac{1}{\sqrt{x^4+8x^3-9}-x^2}=\frac{\sqrt{x^4+8x^3-9}+x^2}{8x^3-9}\sim \frac{2x^2}{8x^3}=\frac{1}{4x},当x\rightarrow \infty.$$
$运用极限比较判别法，由于\int_9^{\infty}1/(4x)dx发散，因而原积分发散。顺便说一下，你能猜到原被积函数在x\rightarrow \infty时渐进等价于1/4x吗？这个不容易想到，所以如果要用最高次幂起决定作用的结论，要保证有且仅有一个最高次幂。$

#### 21.3.2 三角函数在$\infty$和$-\infty$附近的表现
$我们知道的有用结论仅仅是，对任意实数A有$
$$|\sin(A)|\leq 1 \quad 和 \quad |\cos(A)|\leq 1.$$
$例如，积分$
$$\int_5^{\infty}\frac{|\sin(x^4)|}{\sqrt{x}+x^2}dx$$
$收敛还是发散呢？我们从|\sin(x^4)|\leq 1开始。注意，将A的正弦值换成x^4的正弦值是没有关系的，因为任何数的正弦（或余弦）的绝对值都不超过1.因此，我们有$
$$\int_5^{\infty}\frac{|\sin(x^4)|}{\sqrt{x}+x^2}dx\leq \int_5^{\infty}\frac{1}{\sqrt{x}+x^2}dx.$$
$太棒了，我们去除了表达式中的所有三角函数，右边积分的唯一瑕点出现在\infty 处。由于对于大数x，最高次幂起主要作用，所以我们有当x\rightarrow \infty，\sqrt{x}+x^2 \sim x^2.现在取倒数可得$
$$当x\rightarrow \infty时，\frac{1}{\sqrt{x}+x^2}\sim \frac{1}{x^2}.$$
$由p判别法，我们知道\int_5^{\infty}1/x^2dx收敛，极限比较判别法告诉我们$
$$\int_5^\infty\frac{1}{\sqrt{x}+x^2}dx$$
$也收敛。最后，我们有$
$$\int_5^\infty\frac{|\sin(x^4)|}{\sqrt{x}+x^2}dx\leq \int_5^\infty \frac{1}{\sqrt{x}+x^2}dx<\infty,$$
$所以由比较判别法知原积分收敛。$

$|\sin(A)|\leq 1和|\cos(A)|\leq 1的另一个漂亮应用是，相对于x的任何正数次幂，任何数的正弦或余弦都可忽略，至少在x\rightarrow \infty或x \rightarrow -\infty 时是这样的，例如$
$$当x\rightarrow \infty 时，2x^3-3x^{0.1}+\sin(100x^2{200}) \sim 2x^3.$$

$这个结论对于了解积分$
$$\int_8^\infty \frac{1}{2x^3-3x^{0.1}+\sin(100x^{200})}dx$$
$收敛与否是很用的。由极限比较判别法和上面的渐近等价关系可知，该积分与\int_8^\infty 1/2x^3dx敛散性一致。因为据p判别法，最后一个积分收敛，则原积分收敛。$
#### 21.3.3 指数在$\infty$和$-\infty$附近的表现
$这是一个非常有用的原理：$**指数比多项式增长得快.**$用下面得形式来表示这个原理：$
$$\lim\limits_{x \to \infty}\frac{x^n}{e^x}=0,$$

$$对所有的x>0,e^{-x}\leq \frac{C}{x^n}.$$

$例1，考虑$
$$\int_1^\infty x^3e^{-x}dx.$$


$好消息是，被积函数是正的且只有\infty一个瑕点；坏消息是，因子x^3在x\rightarrow \infty时增长很快。然而因子e^{-x}减小（到0）非常快，其速度要远远快于x^3的增长速度。为了证明这个，我们将关注$
$$e^{-x}\leq \frac{C}{x^5}.$$
$这正好是上面的不等式，只是将n选为5，为什么选5呢？因为它能起作用：$
$$\int_1^\infty x^3e^{-x}dx\leq \int_1^\infty x^3\frac{C}{x^5}dx=C\int_1^\infty \frac{1}{x^2}dx<\infty$$
$我们已经用p判别法得到C\int_1^\infty 1/x^2dx收敛。由比较判别法可知，原积分也收敛。我是怎么知道用x^5的呢？如果换成e^{-x}\leq C/x^4会发生什么？它将不会起作用：$
$$\int_1^\infty x^3e^{-x}dx\leq \int_1^\infty x^3\frac{C}{x^4}dx=C\int_1^\infty \frac{1}{x}dx=\infty.$$


$例2:$
$$\int_{10}^\infty(x^{1000}+x^2+\sin(x)e^{-x^2+6})dx.$$


$e^x在-\infty附近是什么表现呢？这与讨论e^{-x}在\infty附近的表现是一回事。$
$例3：$
$$\int_{-\infty}^{-4}x^{1000}e^xdx,$$

$例4：$
$$\int_4^\infty x^{1000}e^xdx$$

$例5：$
$$\int_{18}^\infty \frac{x^2}{7^x-4^x}dx.$$



#### 21.3.4 对数在$\infty$附近的表现
$\qquad首先注意我们不考虑对数在-\infty附近的情形，因为负数不能取对数，所以讨论当x\rightarrow -\infty时的\ln(x)是没有意义的。$
$\qquad另一方面，$**对数在**$\infty$**处增长得很慢.**$若a>0是你选的某个正数，则不管它有多小，都有：$
$$\lim\limits_{x \to \infty}\frac{\ln(x)}{x^\alpha}=0.$$
$根据上节的讨论，必有一个常数C使得：$
$$对所有x>1,\ln(x)\leq Cx^\alpha.$$
$例1：$
$$\int_2^\infty \frac{\ln(x)}{x^{1.001}}dx.$$
$\ln(x)\leq Cx^\alpha,其中\alpha小到不会影响1.001大于1这样一个性质。例如，如果采用\ln(x)\leq Cx^{0.5},由p判别法可得：$
$$\int_2^\infty \frac{\ln(x)}{x^{1.001}}dx\leq \int_2^\infty \frac{Cx^{0.5}}{x^{1.001}}dx=C\int_2^\infty\frac{1}{x^0.501}dx=\infty.$$
$又白费力气了。我们讨论的积分小于等于\infty，没有任何意义，那我们就更精细一点，采用\ln(x)\leq Cx^{0.0005}是一个很小的数，0.0005是一个很小的数，小到被1.001减后的差任大于1.我们看一下这个不等式的应用结果：$
$$\int_2^\infty \frac{\ln(x)}{x^{1.001}}dx\leq \int_2^\infty \frac{Cx^{0.0005}}{x^{01001}}dx=C\int_2^\infty\frac{1}{x^1.0005}dx<\infty.$$
$上面右边的积分根据p判别法可知是收敛的，因为1.0005大于1.由比较判别法可知，左边的积分也收敛。$


$提醒一下，对数增长缓慢的原理并不是对每个含有对数的反常积分都有效。考虑下面6个反常积分：$
$$\int_2^\infty \frac{\ln(x)}{x^{1.001}}dx, \int_2^\infty\frac{1}{x^{1.001}\ln(x)}dx,
\int_2^\infty \frac{\ln(x)}{x}dx,$$
$$\int_2^\infty \frac{1}{x\ln(x)}dx,\int_{3/2}^\infty \frac{\ln(x)}{x^{0.999}}dx,\int_2^\infty \frac{1}{x^{0.999}\ln(x)}dx.$$

### 21.4 常见函数在0附近的表现
#### 21.4.1 多项式和多项式型函数在0附近的表现
$\qquad 对多项式，最低次幂在x\rightarrow 0时起决定作用，这与x\rightarrow \infty时的情况正好相反。假设p是多项式，则有：$
$$若p(x)的最低次项是bx^m，则当x\rightarrow 0,p(x) \sim bx^m.$$

$例如，当x\rightarrow 0,5x^4-x^3+2x^2 \sim 2x^2.我们通过证明它们之比的极限为1来说明：$
$$\lim\limits{x \to 0}\frac{5x^4-x^3+2x^2}{2x^2}=\lim\limits{x \to 0}(\frac{5x^2}{2}-\frac{x}{2}+1)=0-0+1=1.$$

$对于多项式函数，并不是总能那么容易找到最低次项，不过该原理仍适用，甚至对常数也适用。$

$例1：$
$$\int_0^5\frac{1}{x^2+\sqrt{x}}dx.$$
$唯一的瑕点是x=0,现在我们知道$
$$当x\rightarrow 0^+时，\frac{1}{x^2+\sqrt{x}}\sim \frac{1}{\sqrt{x}},因为\int_0^5\sqrt{x}dx收敛（p判别法），则$$
$$\int_0^5\frac{1}{x^2+\sqrt{x}}dx.$$
$也收敛（极限比较判别法）$
$例2：$
$$\int_0^1\frac{x+3}{x+x^5}dx$$

#### 21.4.2 三角函数在0附近的表现
$这些是很用的结论：$
$$当x\rightarrow 0,\sin(x) \sim x,\tan(x) \sim x 且\cos(x)\sim 1.$$
$例1：$
$$\int_0^1\frac{\sin(x)}{x^{3/2}}dx.$$
$注意：虽然我们只讨论当x\rightarrow 0的情况，但这并不意味着瑕点必须在0处，也可能在\infty处的，像下面的例子：$
$$\int_1^\infty \sin(\frac{1}{x})dx.$$
$$\sin(\frac{1}{x})\sim \frac{1}{x},当x \rightarrow \infty.$$
#### 21.4.3 指数函数在0附近的表现
$感觉上，指数函数对0没有作用，更准确地，$
$$当x\rightarrow 0时，e^x \sim 1和e^{-x}\sim 1$$

$例1：$
$$\int_0^1\frac{e^x}{x^5}dx.$$
$例2：$
$$\int_0^1\frac{e^{-1/x}}{x^5}dx.$$
$例3:$
$$\int_0^2\frac{dx}{\sqrt{e^x-1}}$$
$提示：需使用经典极限\lim\limits_{x \to 0}\frac{e^x-1}{x}=1$
#### 21.4.4 对数函数在0附近的表现
$\qquad这里的原理，当x\rightarrow 0^+时对数函数缓慢趋于-\infty。现在通过取绝对值让对数函数趋于\infty，要知道当0<x<1时对数值为负，所以无论a>0有多小，都存在常数C使得$
$$对于所有0<x<1,|\ln(x)| \leq \frac{C}{x^\alpha}$$

$这是由极限\lim\limits_{x \to 0^+}x^\alpha \ln(x)=0$


$例1：$
$$\int_0^1 \frac{|\ln(x}{x^{0.9}}dx,$$

$例2：$
$$\int_0^{1/2}\frac{1}{x^2|\ln(x)|}dx.$$


$例2：$
$$\int_0^{1/2}\frac{1}{x^{0.9}|\ln(x)|}dx.$$

#### 21.4.5 更一般的函数在0附近的表现
$若一个函数有在0附近收敛于该函数的麦克劳林级数，则函数在x\rightarrow 0时渐近等价于级数的最低次项，即：$
$$f(x)=a_nx^n+a_{n+1}x^{n+1}+...,当x\rightarrow 0,则f(x) \sim a_nx^n.$$
$例1：$
$$\int_0^1\frac{dx}{1-\cos(x)} \qquad 和 \qquad \int_0^1\frac{dx}{(1-\cos(x))^{1/3}}.$$

### 21.5 如何应对不在0或$\infty$处的瑕点
$若瑕点出现在有限而非0处，做换元。具体情况如下：$
- $若积分\int_a^bf(x)dx的唯一瑕点出现在x=a处，做换元t=x-a,注意dt=dx.新的积分则只有0一个瑕点。$
- $若积分\int_a^bf(x)dx的唯一瑕点出现在x=b处，做换元t=b-x,注意dt=-dx.用多出的负号来做积分上下限交换，新的积分则只有0一个瑕点$