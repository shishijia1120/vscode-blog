## 19 积分的方法II

### 19.1 应用三角恒等式的积分

有三大类型的三角恒等式，它们在积分计算中非常有用。第一大类型是关于cos(2x)的倍角公式。

$$\cos^2(x)=\frac{1}{2}(1+\cos(2x)) \quad
和 \quad \sin^2(x)=\frac{1}{2}(1-\cos(2x))$$

----

### 19.2 关于三角函数的幂的积分
现在我们将要研究怎样求解被积函数是三角函数的幂的形式的积分。

#### 19.2.1 sin和cos的幂
**黄金法则**：$如果\sin(x)或\cos(x)其中一个的幂是奇数，那就一定要抓住它——它是你的朋友!(如果两个都为奇数，把幂低的那个选做你的朋友.)$
$如果你已经抓住了奇次幂，这时需要做的是拿出一项同dx放在一起，再用下列公式中的一个处理剩下的项(现在是偶次幂了)$
$$\cos^2(x)=1-\sin^2(x) \quad 或 \quad \sin^2(x)=1-\cos^2(x).$$

例子1 ：
$$\int \cos^7(x)\sin^{10}(x)dx=\int \cos^6(x)\sin^{10}(x)\cos(x)dx.$$

$现在处理\cos^6(x)，6是偶数，所以可以写为\cos^6(x)=(\cos^2(x))^3=(1-\sin^2(x))^3，这样积分为：$
$$\int (1-\sin^2(x))^3 \sin^{10}(x)\cos(x)dx.$$

$现在如果设t=\sin(x)，则dt=\cos(x)dx，所以很容易用t为变量来表示这个积分:$
$$\int (1-t^2)^3t^10 dt=\int(1-3t^2+3t^4-t^6)t^{10}dt=\int(t^10-3t^{12}+3t^{14}-t^6)dt,$$

$结果为：$
$$\frac{t^{11}}{11}-\frac{3t^{13}}{13}+\frac{t^{15}}{5}-\frac{t^{17}}{17}+C.$$

$再把它换回以x为变量的积分，就得到了答案：$
$$\int \cos^7(x) \sin^{10}(x)dx=\frac{\sin^{11}(x)}{11}-\frac{3\sin^{13}(x)}{13}+\frac{\sin^{15}(x)}{5}-\frac{\sin^{17}(x)}{17}+C.$$

$借用一个\cos(x)来帮助我们改变被积函数把\cos(x)和dx结合在一起做换元t=\sin(x)，从而使被积函数仅仅关于\sin(x):$

----
$如果它们的幂都为偶数，例如\int \cos^2(x)\sin^4(x)dx，那应该使用倍角公式。$
$$\cos^2(x)=\frac{1}{2}(1+\cos(2x)) \quad
和 \quad \sin^2(x)=\frac{1}{2}(1-\cos(2x))$$

$直接用这两个公式做替代，可以看到关于\cos 的幂的更简单的被积函数。$
$这时你可以使用刚才的计算方法，看积分的每一部分是奇次还是偶次。$

$$\int \cos^2(x)\sin^4(x)dx=\int \frac{1}{2}(1+\cos(2x))(\frac{1}{2}(1-\cos(2x)))^2dx.$$

$现在把它展开：$
$$\frac{1}{8}\int (1-\cos(2x)-\cos^2(2x)+\cos^3(2x))dx.$$


$$\int \cos^3(2x)dx=\int \frac{1}{2}(1+\cos(4x))dx=\frac{1}{2}(x+\frac{1}{4}\sin(4x))+C.$$

$$\int \cos^3(2x)dx=\int(1-\sin^2(2x))\cos(2x)dx=\frac{1}{2}\int (1-t^2)dt=\frac{1}{2}(t-\frac{t^3}{3})+C$$

$$=\frac{\sin(2x)}{2}-\frac{\sin^3(2x)}{6}+C.$$

$综合到一起化简：$
$$\int \cos^2(x)\sin^4(x)dx$$

$$=\frac{1}{8}(x-\frac{\sin(2x)}{2}-\frac{x}{2}-\frac{\sin(4x)}{8}+\frac{\sin(2x)}{2}-\frac{\sin^3(2x)}{6})+C$$

$$=\frac{x}{16}-\frac{\sin(4x)}{64}-\frac{\sin^3(2x)}{48}+C.$$

----

#### 19.2.2 tan的幂
$$考虑\int \tan^n(x)dx，其中n是整数。我们先研究前几种情况.$$

1. $当n=1时，我们计算\int \tan(x)dx.$

$\qquad 设t=\cos(x)，dt=-\sin(x)dx:$
$$\qquad \int \tan(x)dx=\int \frac{\sin(x)}{\cos(x)}dx=-\int \frac{dt}{t}=-\ln(t)+C=-\ln|\cos(x)|+C.$$

$\qquad 这个答案也可以被写为\ln|\sec(x)|+C.$

2. $当n=2时，我们有必要使用毕达哥拉斯等式：$
   $$\tan^2(x)=\sec^2(x)-1.$$

$\qquad 所以有：$

$$\int \tan^2(x)dx=\int (\sec^2(x)-1)dx=\tan(x)-x+C.$$

3. $对于更高次幂(n \geq 3)，就不得不把\tan^2(x)先提出来再改写为(\sec^2(x)-1).$
$\quad 这样就有了两个积分.前面的积分可以通过设t=\tan(x)来计算并使用dt=\sec^2(x)dx.$
$\quad 第二个积分是\tan(x)的更低次幂，所要做的是重复这个方法.$

$$\int \tan^6(x)dx=\int \tan^4(x)\tan^2(x)dx=\int \tan^4(x)(\sec^2(x)-1)dx$$

$$=\int \tan^4(x)\sec^2(x)dx-\int \tan^4(x)dx.$$

$计算第一个积分，设t=\tan(x),dt=\sec^2(x)dx.$
$$\int \tan^4(x)\sec^2(x)dx=\int t^4 dt=\frac{t^5}{5}+C=\frac{\tan^5(x)}{5}+C.$$

$计算第二个积分：$
$$\int \tan^4(x)dx=\int 
\tan^2(x)\tan^2(x)dx=\int \tan^2(x)(\sec^2(x)-1)dx$$

$$=\int \tan^2(x) \sec^2(x)dx - \int \tan^2(x)dx.$$

$设t=\tan(x)，所以有dt=\sec^2(x)dx.$
$$\int \tan^2(x) \sec^2(x)dx=\int t^2 dt=\frac{t^3}{3}+C=\frac{\tan^3(x)}{3}+C.$$

$与此同时：$
$$\int \tan^2(x)dx=\int (\sec^2(x)-1)dx=\tan(x)-x+C.$$

$合并结果，得到：$
$$\int \tan^6(x)dx=\frac{\tan^5(x)}{5}-\frac{\tan^3(x)}{3}+\tan(x)-x+C.$$

----

#### 19.2.3 sec的幂



----

#### 19.2.4 cot的幂
$我们可以用解决\tan(x)的幂的方法来解决这类问题，可以使用毕达哥拉斯等式把\cot^2(x)改写：$
$$\cot^2(x)=\csc^2(x)-1$$

$当设t=\cot(x)时，有dt=-\csc^2(x)dx.不要忘记负号！尝试计算\int \cot^6(x)dx.$

----

#### 19.2.5 csc的幂
$计算这个就和计算\sec(x)的幂一样。可以把\csc^2(x)提出来，然后用分部积分法，应用dv=\csc^2(x)dx.$
$请注意：v=-\cot(x)，而dv也有一个负号，这是你需要注意的地方。$
$尝试计算\int \csc^6(x)dx，将这个结果和\int \sec^6(x)dx的结果相比较，你会看到更多相似的地方.$

----

#### 19.2.6 约化公式

----

### 19.3 关于三角换元法的积分

#### 19.3.1 类型1：$\sqrt{a^2-x^2}$

#### 19.3.2 类型2：$\sqrt{x^2+a^2}$

#### 19.3.3 类型3：$\sqrt{x^2-a^2}$

#### 19.3.4 配方和三角换元法

#### 19.3.5 关于三角换元法的总结

#### 19.3.6 平方根的方法和三角换元法





----

### 19.4 积分技巧总结
