<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({ tex2jax: {inlineMath: [['$', '$']]}, messageStyle: "none" });
</script>


## 20 反常积分：基本概念

### 20.1 收敛和发散
$在上一章中，我们见过积分$

$$\int_a^bf(x)dx.$$
$该被积函数f如果在[a,b]区间内是有界的，并是连续的（如有有限个间断点也可），那么这个积分就是有意义的。如果这个积分有无限多个不连续点，该积分也可能是有意义的。但如果函数f不是有界的，情况又怎么样呢？$

- $如果出现下面的情况，积分\int_a^bf(x)dx就是反常积分：$
$(1)函数f在并区间[a,b]内是无界的；$
$(2)b=\infty;$
$(3)a=-\infty;$

**讨论第一种情况**$(函数f在并区间[a,b]内是无界的)：$
$\quad如果函数f(x)在x接近于点c时是无界的，那么我们说该函数x=c点有一个破裂点。大多数情况下，它就是指有垂直渐近线。$
$\quad由于该区域不停地向上延伸，那么其面积就是无限的。这个结论是正确的吧？不一定，如果该区域足够狭长，那么出现一个数学奇迹，面积就是有限的了。为了研究什么情况下一块无限区域的面积会是有限的，我们需要使用极限。其基本思想是：当在x=a处有破裂点时，我们有：$
$$如果仅仅在x接近于a点该函数f(x)是无界的，则定义\int_a^bf(x)dx=\lim\limits_{\varepsilon \to 0^+}\int_a^bf(x)dx.$$

$在此假设这个极限存在。如果能找到这样的极限，我们就说这个积分收敛;否则认为该积分发散。就像其他的极限一样，由于极限的结果可能为\infty或-\infty，或当\varepsilon\rightarrow 0^+时它的图像上下振荡，因而这个极限可能没有意义。$
$\quad 当看到一个反常积分时，我们需要知道的一件非常重要的事情是：它是收敛的还是发散的。这个积分的收敛值是多少并不是很重要（假设它是收敛的）。在实际中，如果你知道积分是收敛的，可以通过复杂的计算求的收敛值。如果积分是发散的，而你使用计算机估算这个积分值，那么可能会得到意想不到的结果（计算机还不能真正理解无限或疯狂的上下振荡）。$
#### 20.1.1 反常积分的一些例子
$$\int_0^1\frac{1}{x}dx和\int_0^1\frac{1}{\sqrt{x}}dx.$$
$这两个都是反常积分，因为它们的被积函数在x=0点都有垂直渐近线。所以我们可以使用公式：$
$$\int_0^1\frac{1}{x}dx=\lim\limits_{\varepsilon \to 0^+}\ln|x|_\varepsilon^1=\lim\limits_{\varepsilon \to 0^+}(\ln(1)-\ln(\varepsilon))=\infty.$$
$所以这个反常积分是发散的。$
$这二个积分的情况：$
$$\int_0^1\frac{1}{\sqrt{x}}dx=\lim\limits_{\varepsilon \to 0^+}\int_\varepsilon^1\frac{1}{x^{1/2}}dx=\lim\limits_{\varepsilon \to 0^+}2x^{1/2}|_{\varepsilon}^1=\lim\limits_{\varepsilon \to 0^+}(2\sqrt{1}-2\sqrt{\varepsilon})=2.$$
$我们得到了一个有限的数，所以这个积分是收敛的。$

$\qquad 假设你遇到反常积分\int_a^bf(x)dx，它的被积函数只在x=a点有垂直渐近线，你仅仅想知道该积分是收敛的还是发散的，这时,b的值对我们没有影响，可以把它换成任意大于a的有限的数，只要不选择新的垂直渐近线或新的破裂点。$
$$\int_a^bf(x)dx=\lim\limits_{\varepsilon \to 0^+}\int_{a+\varepsilon}^bf(x)dx,$$
$在此假设这个极限存在，现在把b换成其他任意的数c，但比数a大，如果x=a依然是函数f的破裂点，那么我们有$
$$\int_a^cf(x)dx=\lim\limits_{\varepsilon \to 0^+}\int_{a+\varepsilon}^cf(x)dx$$
$再次假设极限是存在的，我们可以在x=b点把最后一个积分分开，而得到$
$$\int_a^cf(x)dx=\lim\limits_{\varepsilon \to 0^+}(\int_{a+\varepsilon}^bf(x)dx+\int_b^cf(x)dx).$$

$\varepsilon对第二个积分没有任何影响；实际上，因为函数f在b和c点之间是有界的。所以这个积分收敛于一个数M.我们已经证明了$
$$\int_a^cf(x)dx=\lim\limits_{\varepsilon \to 0^+}\int_{a+\varepsilon}^bf(x)dx+M.$$
$如果右侧的极限存在，那么积分\int_a^bf(x)dx收敛。增加一个数M它仍然为有限的，所以\int_a^bf(x)dx还是收敛的。相反，如果极限不存在，这时增加一个数M对情况也没有影响，所以\int_a^bf(x)dx和\int_a^cf(x)dx同时发散。$

#### 20.1.2 其他破裂点
- $如果x=b是破裂点（函数f在积上限b是无界的），所以$
$$如果函数仅仅在x接近于b点是无界的，则定义\int_a^bf(x)dx=\lim\limits_{\varepsilon \to 0^+}\int_a^{b-\varepsilon}f(x)dx,$$

- $如果函数f在区间[a,b]内有破裂点c，那该怎么办呢？如果f仅仅是在该区间(a,b)内的c点无界，那么需要把这个积分分成两部分：$
  $\int_a^cf(x)dx  和\int_c^bf(x)dx.$
  $使用极限定义这些积分：$
  $$\lim\limits_{\varepsilon \to 0^+}f(x)dx  \quad  和  \quad  \lim\limits_{\varepsilon \to 0^+}\int_{c+\varepsilon}^bf(x)dx,$$
  $关键点是：只有当这两部分的积分都收敛时，积分\int_a^bf(x)dx才是收敛的；如果任何一个发散，那么整个积分就是发散的。$
$为计算反常积分，如果必要就把它分解，每一部分最多只能有一个瑕点，而且该点要在积分的上下限上（此处，瑕点指的是破裂点）$



### 20.2 关于无穷区间上的积分
- $现在要研究当积分上下限有一个或同是无穷时的情况；也就是说，积分区间是无界的。为计算$
$$\int_a^\infty f(x)dx,$$
$其中a是常数，函数f在区间[a,\infty)没有破裂点，我们可以定义：$
$$\int_a^\infty f(x)dx=\lim\limits_{N \to \infty}\int_a^Nf(x)dx,$$

$在此假设这个极限是存在的，则这个积分是收敛的；否则是发散的。$

- $如果在区间(-\infty,b]上函数f没有其他的破裂点，可以使用相似的定义$
  $$\int_{-\infty}^b f(x)dx=\lim\limits_{N \to \infty}\int_{-N}^bf(x)dx,$$

- $如果函数f在整个区间内都没有破裂点，那么要计算$
   $$\int_{-\infty}^\infty f(x)dx$$
   $尽管它没有瑕点，但仍然两个瑕点：\infty 和-\infty。需要把积分分成两部分，每个部分只有一个瑕点，选一个你喜欢的数，如：$
   $$\int_{-\infty}^0 f(x)dx \quad和  \quad \int_0^\infty f(x)dx.$$



### 20.3 比较判别法（理论）
- $我们想知道积分\int_a^bf(x)dx的情况，但现在仅仅知道积分\int_a^bg(x)dx的情况。如果在区间(a,b)内，函数f(x)\geq g(x)\geq 0,且积分\int_a^bg(x)dx是发散的，那么积分\int_a^bf(x)dx也是发散的。可写为：$
$$\int_a^bf(x)dx\geq \int_a^bg(x)dx=\infty.$$
$所以第一个积分也是发散的。$
-  $另一方面，对于收敛性，方向要反过来。我们想知道积分\int_a^bf(x)dx的情况，但现在知道积分\int_a^bg(x)dx是收敛的，如果在区间(a,b)内，0\leq f(x)\leq g(x),且积分\int_a^bg(x)dx是收敛的，那么积分\int_a^bf(x)dx也一定是收敛的。数学上的表示形式是：$
  $$\int_a^bf(x)dx\leq \int_a^bg(x)dx<\infty,$$
  $所以两个积分都是收敛的（注意左边积分是正的，所以它不可能发散到-\infty）$

### 20.4 极限比较判别法（理论）
>$比较判别法是用一个函数的反常积分的结果去判别另一个函数的反常积分。极限比较判别法是类似的，但并不需要一个比被判别的函数更大的函数。相反，我们仅仅需要两个近似的函数，其基本思想是：假设有两个函数在破裂点x=a是非常接近的（它们再也没有其他的破裂点），那么积分\int_a^bf(x)dx和\int_a^bg(x)dx同时收敛或同时发散，它们的行为是相同的。$

#### 20.4.1 函数互为渐近线
$假设有两个函数f和g满足$
$$\lim\limits_{x \to a}\frac{f(x)}{g(x)}=1.$$
$即：$
$$当x\rightarrow a时，f(x)\sim g(x)同\lim\limits_{x \to a}\frac{f(x)}{g(x)}=1有着同样的意义.$$

$\qquad这不是说明当x接近于a时，f(x)大约等于g(x);它说明当x接近于a时，f(x)和g(x)的比值接近于1.我们说当x\rightarrow a ,函数f(x)和g(x)是渐近等价的.当然你可以用x\rightarrow \infty或x \rightarrow a^+来替代x\rightarrow a,只需要在极限中做同样的替代。$
$\qquad 加或减这些关系却不适应上述规则。例如当x\rightarrow 0 时，以\tan(x) \sim x 和\sin(x) \sim x开始，那么不能从第一个中减去第二个得到\tan(x)-\sin(x)\sim x-x.x-x是0，没有什么能同0是渐近等价的。为什么没有呢？因为当x\rightarrow a时有f(x)\sim 0,这时我们有$
$$\lim\limits_{x \to a}\frac{f(x)}{0}=1.$$
$这讲不通，因为等式的左边没有任何意义。所以可以对这种渐近等价关系做乘积、除法、取幂，$**但一定不要加法和减法。**


#### 20.4.2 关于判别法的陈述
$正式地说，如果当x\rightarrow a时，f(x)\sim g(x),且这两个函数在区间[a,b上没有其他的瑕点了，那么积分\int_a^bf(x)dx和\int_a^bg(x)dx是同时收敛或同时发散的。（如果同时收敛，它们的收敛值可能不同）这就是$**极限比较判别法**

### 20.5 p判别法（理论）
$\qquad我们有了比较判别法和极限比较判别法，需要知道怎样去使用它们。我们的基本策略是：选择一个能与函数f相比较的函数g。我们希望函数g足够简单到可以判断它是收敛的还是发散的。$
$\qquad问题是，我们能选择什么样的g函数？最常用的函数是\frac{1}{x^p}，其中p>0.可以使用极限公式得到p判别法。$

- **p判别法，$\int^\infty$的情况：**$对于任何有限值a>0,积分$
  $$\int_a^\infty\frac{1}{x^p}dx$$
  $在p>1时是收敛的，在p\leq 1时是发散的。$

- **p判别法，$\int_0$的情况：**$对于任何有限值a>0,积分$
  $$\int_0^a\frac{1}{x^p}dx$$
  $在p<1时是收敛的，在p\geq 1时是发散的。$

**证明p判别法：**
$$\int_a^\infty\frac{1}{x^p}dx,$$
$其中常数a>0,如果p=1,该积分变为1/x，我们已经知道，这个积分在这种情况下是发散的。另外，我们有：$
$$\int_a^\infty\frac{1}{x^p}dx=\lim\limits_{N \to \infty}\int_a^Nx^{-p}dx=\lim\limits_{N \to \infty}\frac{1}{1-p}x^{1-p}|_a^N$$
$$=\frac{1}{1-p}((\lim\limits_{N \to \infty}N^{1-p})-a^{1-p}).$$

$现在如果极限$
$$\lim\limits_{N \to \infty}N^{1-p}$$
$存在，那么整个积分\int_a^\infty 1/x^pdx是收敛的。如果这个极限不存在，那么该积分是发散的。所以，将上述极限重写为$
$$\lim\limits_{N \to \infty}\frac{1}{N^{p-1}}.$$
$如果p>1,那么p-1>0,所以当N很大时N^{p-1}非常大；它的倒数变得很小，所以极限是0，最初积分是收敛的。另一方面，如果p<1,那么p-1<0,所以N^{1-p}非常大,这个极限趋于无穷大，说明积分是发散的。这证明了p判别法的一半。另一半证明与此类似，只使用\varepsilon \rightarrow 0^+而不是N \rightarrow \infty.$


### 20.6 绝对收敛判别法
$\qquad比较判别法的一个假设是函数f和g都是非负的。但如果你想判断一个负函数的走势，该怎么办呢？如果这个函数一直为负，则可把负号提出了后把它归为正函数的情况。另一方面，如果这个函数在积分区间不停地在正负之间振荡，则可以应用$**绝对收敛判别法**$，陈述如下：$
$$如果\int_a^b|f(x)|dx是收敛的，那么\int_a^bf(x)dx也是收敛的。$$

$注意：如果原始积分的绝对值是发散的，那么这个原始积分可能还是收敛的！$
$只有当该积分的绝对值情况是收敛的，才能使用绝对收敛法。$

$\qquad为什么绝对收敛判别法可以起作用，假设我们知道$
$$\int_a^b|f(x)|dx$$
$收敛。有一个很好的技巧：设对于f的x的定义区间[a,b]，有g(x)=|f(x)|+f(x).那么g有两个重要特性：首先g(x)\geq 0;其次，g(x)\leq 2|f(x)|.(两种情况下，都假定x是f定义区间[a,b]中的任意数.)$
$\qquad 无论如何，我们现在可以对g使用比较判别法了：$
$$0\leq \int_a^bg(x)dx\leq 2\int_a^b|f(x)|dx<\infty.$$
$结论是$
$$\int_a^bg(x)dx$$
$也是收敛的。那又怎样呢？注意，f(x)=g(x)-|f(x)|,所以$
$$\int_a^bf(x)dx=\int_a^bg(x)dx-\int_a^b|f(x)|dx.$$

$右侧的两个积分都是收敛的——第一个已经证明了，第二个假设为收敛的——所以，左侧的积分也是收敛的。$

