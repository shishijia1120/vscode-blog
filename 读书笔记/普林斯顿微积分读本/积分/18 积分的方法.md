<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({ tex2jax: {inlineMath: [['$', '$']]}, messageStyle: "none" });
</script>

## 18 积分的方法
> 让我们开始发展一套求反导数的技巧。以学习下方法：
> - 换元法
> - 分部积分法
> - 使用部分分式对有理函数求积分
### 18.1 换元法
$使用链式求导法则，我们可以很容易地求出$
$$\frac{d}{dx}(e^{x^2})=2xe^{x^2}$$
$可以得$
$$\int 2xe^{x^2}dx=e^{x^2}+C$$

$例1：现在考虑从下面的不定积分开始：$
$$\int x^2\cos(x^3)dx.$$
$让我们从设t=x^3开始，所以\cos(x^3)变为\cos(t)。我们的目的是：要用t替代表达式中的每一个x。我们已经把\cos(x^3)替换掉，但还需要替换x^2和dx.$
$事实上，dx很重要的。你不能随便地把它改为dt!因为t=x^3，所以有\frac{dt}{dx}=3x^2，我们可以把dx移到等式地右侧，这样有dt=3x^2dx.得\frac{1}{3}dt=x^2dx.这样$
$$\int x^2\cos(x^3)dx=\int \cos(x^3)(x^2dx)=\int \cos(t)(\frac{1}{3}dt)=\frac{1}{3}\int \cos(t)dt=\frac{1}{3}\sin(t)+C.$$
$所以最后的答案为$
$$\int x^2\cos(x^3)d=\frac{1}{3}\sin(x^3)+C.$$

$例2：$
$$\int e^{2x}\sec^2(e^{2x})dx.$$
$例3：$
$$\int \frac{3x^2+7}{x^3+7x-9}dx.$$
$提示：\int \frac{f'(x)}{f(x)}dx=\ln|f(x)|+C.$

$例4：$
$$\int \frac{x}{x^2+8x}=\frac{1}{2}\int \frac{2x}{x^2+8}=\frac{1}{2}\ln|x^2+8|+C$$
$例5：$
$$\int \frac{1}{x\ln(x)}dx=\int \frac{1/x}{\ln(x)}dx.$$



#### 18.1.1 换元法和定积分
$在定积分中也可以使用换元法，解决这样的问题有两种方法。例如1，计算$
$$\int_0^{\sqrt[3]{\pi /2}}x^2\cos(x^3)dx,$$
$\qquad使用换元法计算定积分的方法：先求不定积分，然后分别代入积分上下限去求定积分。$
$\qquad这里还有一个方法！在整个计算过程中你都一直计算定积分，但一定要记住，把积分的上下限也用变量t来表示。例子中，用t=x^3去换元，然后使用\frac{1}{3}dt=x^2dx换到以变量为t的积分。现在当x=0时，我们有t=0^3=0,所以积分下限为0.但对积分上限，当x=\sqrt[3]{\pi/2},我们有t=(\sqrt[3]{\pi/2})^3=\pi/2.换元后结果为：$
$$\int_0^{\sqrt[3]{\pi /2}}x^2\cos(x^3)dx=\frac{1}{3}\int_0^{\pi/2}\cos(t)dt.$$


$例2：$
$$\int_{1/sqrt{2}}^{\sqrt{3}/2}\frac{1}{\sin^{-1}(x)\sqrt{1-x^2}}dx.$$
$t=\sin^{-1}(x)$ $\qquad \qquad \qquad \qquad \qquad \qquad$  $\int_{1/\sqrt{2}}^{\sqrt{3}/2}\frac{1}{\sin^{-1}(x)\sqrt{1-x^2}}dx$


$dt=\frac{1}{\sqrt{1-x^2}}dx$  $\qquad \qquad \qquad \qquad \qquad \qquad$  $=\int_{\pi/4} ^{\pi/3}\frac{1}{t}dt=\ln|t| |_{\pi/4}^{\pi/3}$




$当x=\frac{1}{\sqrt{2}},t=\sin^{-1}(\frac{1}{\sqrt{2}})=\frac{\pi}{4}$   
$\qquad \qquad \qquad \qquad \qquad \qquad \qquad \qquad \quad$ $=\ln|\frac{\pi}{3}|-\ln|\frac{\pi}{4}|=\ln(\frac{4}{3}).$

$当x=\frac{\sqrt{3}}{2},t=\sin^{-1}(\frac{\sqrt{3}}{2})=\frac{\pi}{3}$

#### 18.1.2 如何换元


#### 18.1.3 换元法的理论解释
$\qquad 假设你想在某些积分中做这样的换元t=x^2,dt=2xdx.可解释为：当t发生微小变化时，它的变化量是它所对应的x的微小量的2x倍。更好的方式用，链式法则来解释：$
$\qquad 设想你已经做了一个换元t=g(x)，我们用以t为变量的\int f(t)dt结束求解，设结果为F(t)+C(C为常数).所以这个积分以t为变量可写为$
$$\int f(t)dt=F(t)+C.$$
(不懂)




### 18.2 分部积分法
$\qquad我们已经看到换元法是怎样利用链式求导法则。还有一种方法可以利用乘积法则，我们称之为分部积分法。回忆乘积法则：如果u和v是关于x的函数，则有：$
$$\frac{d}{dx}(uv)=v\frac{du}{dx}+u\frac{dv}{dx}.$$
$两边同时再对x求积分，得到：$
$$\int u\frac{dv}{dx}dx=\int \frac{d}{dx}(uv)dx-\int v\frac{du}{dx}dx.$$
$等同：$
$$\int u\frac{dv}{dx}dx=uv-\int v\frac{du}{dx}dx.$$
$这就是分部积分公式，这种形式非常实用。简单表示为：$
$$\int udv=uv-\int vdu.$$
$例1：$
$$\int xe^xdx.$$


$$u=x \qquad \qquad v=e^x$$
$$du=dx \qquad \qquad dv=e^xdx;$$

$$\int u dv =uv - \int v du$$
$$\int x \overbrace{e^xdx}=x e^x-\int e^xdx.$$

$得到\int xe^xdx=xe^x-e^x+C.$

$究竟为什么决定选择u=x和dv=e^xdx呢？如果设u=e^x和dv=xdx呢？我们可以这样做的。在这种情况下，会有：$
$$u=e^x \qquad \qquad v=\frac{1}{2}x^2$$
$$du=e^xdx \qquad \qquad dv=xdx;$$
$注意我们通过对dv=xdx，求积分得到v=\frac{1}{2}x^2(记住我们不需要+C)通过分部积分法有：$
$$\int u dv =uv - \int v du$$
$$\int x e^xdx=\int e^x \overbrace{xdx}=e^x.\frac{1}{2}x^2-\int \frac{1}{2}x^2\overbrace{e^xdx}.$$

$整个解题过程没有任何错误，但它很不实用。最后的积分是比原始积分更复杂的积分！所以最好使用第一种方法。这里的规则是：如果e^x存在，通常让dv=e^xdx，因为这样可以很简单地得到v即为e^x.$

**一些变形**
$这里面有很多复杂地情况，有时你需要多次计算分部积分$
$例1：$
$$\int x^2\sin(x)dx?$$



$有时在两次分部积分之后情况并未好转。如果你运气好，那么将会得到原始积分的倍数。如果很不走运，只能重新再来了。$

$例2：$
$$\int \cos(x)e^{2x}dx.$$

$有种类型的积分没有乘积的形式，有：$
$$\int \ln(x)dx,\int (\ln(x))^2dx, \int \sin^{-1}(x)dx, \int \tan^{-1}dx.$$

### 18.3 部分分式
$\qquad让我们研究怎么对一个有理函数求积分，我们将要计算积分$
$$\int \frac{p(x)}{q(x)}dx,$$
$其中p和q为多项式。这种类型在积分中所占的比例很大。$

$\qquad基本方法：通过一些代数运算把它分解成几个更简单的有理函数的和的形式，然后将看到如何对这些简单的有理函数求积分。$


#### 18.3.1 部分分式的代数运算
$\qquad 我们的目的是把一个有理函数分成许多更简单的部分。第一步是确保这个函数的分子的次数小于分母的次数。如果不是这样，我们需要先做一个多项式的除法。$
$例1：$
$$\int \frac{5x^2+x-3}{x^2-1}dx.$$
$分子分母次数相同，做一个多项式除法。所以有：$
$$\frac{5x^2+x-3}{x^2-1}=5+\frac{x+2}{x^2-1}.$$
$两边同时对x求积分，我们有：$
$$\int \frac{5x^2+x-3}{x^2-1}=\int (5+\frac{x+2}{x^2-1})dx.=5x+\int \frac{x+2}{x^2-1}dx.$$

$\qquad 接下来，我们将要分解分母中的因式。$


#### 18.3.2 对每一部分积分
$我们需要知道在把原始积分分成小部分怎样求解每一部分的积分。简单的积分形式是例1：$
$$\int \frac{1}{ax+b}dx.$$
$可以设t=ax+b$
$例2：$
$$\int \frac{1}{(4x+5)^2}dx,$$

$\qquad 当分母是一个二次函数时，情况会变得很复杂，像这样：$
$$\int \frac{Ax+B}{x^2-1}dx.$$
$我们把分母因式分解为(x-1)(x+1)，这样可得两个被积函数的分母为线性式的积分。如果是这种情况，我们就没有必要对分母为二次多项式的被积函数求积分了.$
$\qquad 如果分母的二次多项式不能因式分解.也就是说，它的判别式b^2-4ac为负，例子：$
$$\int \frac{x+8}{x^2+6x+13}dx.$$
$\qquad 其做法是：把分母写成平方放入形式，然后再换元。$
$$x^2+6x+13=x^2+6x+13-9=(x+3)^2+4.$$
$所以有：$
$$\int \frac{x+8}{x^2+6x+13}dx=\int \frac{x+8}{(x+3)^2+4}dx$$
$现在换元t=x+3，所以有x=t-3并且dx=dt:$
$$=\int \frac{t+5}{t^2+4}dt=\int \frac{t}{t^2+4}dt+5\int \frac{1}{t^2+4}dt.$$
$第一个积分：\int \frac{t}{t^2+4}dt=\frac{1}{2}\int \frac{2t}{t^2+4}dt=\frac{1}{2}\ln|t^2+4|+C.$
$第二个积分：5\int \frac{1}{t^2+4}dt，$
$仅仅需要记住这个有用的公式：$
$$\int \frac{1}{t^2+a}dt=\frac{1}{a}\tan^{-1}(\frac{t}{a})+C.$$
$当a=2,为5\times \frac{1}{2}\tan^{-1}(\frac{t}{2})+C.$
$积分结果为：\frac{1}{2}\ln(t^2+4)+\frac{5}{2}\tan^{-1}(\frac{t}{2})+C.$
$现在用x+3代替t，结果为：$
$$\frac{1}{2}\ln((x+3)^2+4)+\frac{5}{2}\tan^{-1}(\frac{x+3}{2})+C.$$

$表达式(x+3)^2+4可以化简展开，实际上没有必要展开它。仅仅回到我们配方的地方，你就会发现需要的方程了。所以，我们最终证明了：$
$$\int \frac{x+8}{x^2+6x+13}dx=\frac{1}{2}\ln(x^2+6x+13)+\frac{5}{2}\tan^{-1}(\frac{x+3}{2})+C.$$
$\qquad 如果分母的最高项的系数不是1，我建议你在配方之前把这个系数提出去。所以，计算：$
$$\int \frac{x+8}{2x^2+12x+26}dx,$$
$把2提出来，把几个积分表达式写为:$
$$\frac{1}{2}\int \frac{x+8}{x^2+6x+13}dx.$$



#### 18.3.3 方法和一个完整的例子

$\qquad 这是一个关于有理函数积分的完整方法.$
$\qquad 第一步——先看分子分母最高项的次数，如有必要请做除法。查看分子的次数是否小于分母次数。如果你运气好，直接进入第二步；如果不是，就要做一个多项式的除法了，然后再进入第二步。$
$\qquad 第二步——对分母进行因式分解。使用二次公式或猜想一个根，然后再做除法，以便因式分解被积函数的分母.$
$\qquad 第三步——分部.被积函数=分部$
$\qquad 第四步——计算常数的值。把方程两边同时乘以分母，通过任一方法计算常数的值：（a）换掉x的值；（b）系数相等法;或者结合使用(a)和(b)两种方法.$
$\qquad 第五步——求解分母为线性项次幂的积分。求解分母是线性函数次幂的积分；答案将会是对数形式或该线性项的负次幂.$
$\qquad 第六步——对分母是二次函数的被积函数求积分。对于分母是二次函数且不能因式分解的被积函数求积分，先配方，然后换元，再把它尽可能分解成两个积分。$



$$\int \frac{x^5-7x^4+19x^3-10x^2-19x+18}{x^4-5x^3+9x^2}dx.$$
$下面详细介绍怎样应用上述方法解决这个问题。$
$\qquad 第一步——先看分子分母最高项的次数，如要必要请做除法。$
$$\frac{x^5-7x^4+19x^3-10x^2-19x+18}{x^4-5x^3+9x^2}=x-2+\frac{8x^2-19x+18}{x^4-5x^3+9x^2}.$$
$现在对两边同时求积分可得：$
$$\int \frac{x^5-7x^4+19x^3-10x^2-19x+18}{x^4-5x^3+9x^2}dx=\int (x-2+\frac{8x^2-19x+18}{x^4-5x^3+9x^2})dx.$$
$现在求解积分：$
$$\int \frac{8x^2-19x+18}{x^4-5x^3+9x^2}dx.$$
$分子的次数仅仅为2，这个数低于分母的次数4.$
$\qquad 第二步——对分母进行因式分解。$
$$x^4-5x^3+9x^2=x^2(x^2-5x+9).$$
$这个二次项x^2(x^2-5x+9)的判别式为(-5)^2-4\times(9)=-11.因为它是负的，所以这个二项式不能因式分解。我们已经完成了第二步。$
$第三步——分部.我们已经有两个因子x^2和x^2-5x+9.不要把第一个因子x^2看作二次函数，而应看作一个线性函数的平方.为了证明这个观点，它可以写为(x-0)^2.所以因子x^2产生分部：$
$$\frac{A}{x^2}+\frac{B}{x}$$
$另外，因子x^2-5x+9产生分部：$
$$\frac{x^2-5x+9}{Cx+D}.$$
$将两者放在一起，我们有$
$$\frac{8x^2-19x+18}{x^4-5x^3+9x^2}=\frac{A}{x^2}+\frac{B}{x}+\frac{Cx+D}{x^2-5x+9}.$$
$\qquad 第四步——计算常数的值。得到：$
$$8x^2-19x+18=A(x^2-5x+9)+Bx(x^2-5x+9)+(Cx+D)x^2.$$
$A=2,B=-1,c=1,D=1，代入表达式中有：$
$$\frac{8x^2-19x+18}{x^4-5x^3+9x^2}=\frac{2}{x^2}+\frac{-1}{x}+\frac{x+1}{x^2-5x+9}.$$
$这就是说：$
$$\int \frac{x^5-7x^4+19x^3-10x^2-19x+18}{x^4-5x^3+9x^2}dx=2\int \frac{1}{x^2}dx-\int \frac{1}{x}dx+\int \frac{x+1}{x^2-5x+9}dx.$$
$分别对三个简单的积分。$
$\qquad 第五步——求解分母为线性次幂的积分.前两个积分是很容易求的：$
$$2\int \frac{1}{x^2}dx-\int \frac{1}{x}dx=-\frac{2}{x}-\ln|x|+C.$$
$\qquad 对分母是二次函数的被积函数求积分。需要计算第三个积分：$
$$\int \frac{x+1}{x^2-5x+9}dx.$$
$通过配方得：$
$$x^2-5x+9=(x^2-5x+\frac{25}{4})+9-\frac{25}{4}=(x=-\frac{5}{2})^2+\frac{11}{4}.$$
$现在让我们重写积分表达式：$
$$\int \frac{x+1}{x^2-5x+9}dx=\int \frac{x+1}{(x-\frac{5}{2})^2+\frac{11}{4}}dx.$$
$用t=x-\frac{5}{2}做换元，这时x=t+\frac{5}{2}且dt=dx,所以这个积分变为：$
$$\int \frac{t+\frac{5}{2}+1}{t^2+\frac{11}{4}}dt=\int \frac{t+\frac{7}{2}}{t^2+\frac{11}{4}}dt,$$
$这里以t为变量，现在把它分成两个积分：$
$$\int \frac{t}{t^2+\frac{11}{4}}dt 和\frac{7}{2}\int \frac{1}{t^2+\frac{11}{4}}dt.$$

$先计算第一个积分，分子分母同时乘以2，可得：$
$$\int \frac{t}{t^2+\frac{11}{4}}dt=\frac{1}{2}\int \frac{2t}{t^2+\frac{11}{4}}dt=\frac{1}{2}\ln|t^2+\frac{11}{4}|+C.$$
$换回以x为变量得状态，需要用x-\frac{5}{2}替代t：$
$$\frac{1}{2}\ln(t^2+\frac{11}{4})+C=\frac{1}{2}\ln((x-\frac{5}{2})^2+\frac{11}{4})+C.$$
$计算第二部分,使用公式:$
$$\int \frac{1}{t^2+a^2}dt=\frac{1}{a}\tan^{-1}(\frac{t}{a})+C,$$
$其中a=\sqrt{\frac{11}{4}}$
$$\int \frac{t+\frac{7}{2}}{t^2+\frac{11}{4}}dt=\frac{7}{2}\times \frac{2}{\sqrt{11}}\tan^{-1}(\frac{t}{\sqrt{11}/2})+C=\frac{7}{\sqrt{11}}\tan^{-1}(\frac{2t}{\sqrt{11}})+C.$$
$把t=x-\frac{5}{2}代入可得：$
$$\frac{7}{\sqrt{11}}\tan^{-1}(\frac{2x-5}{\sqrt{11}})+C.$$
$最后总结分式的结果.$