## 4 随机变量的深入内容

----
### 4.1 随机变量函数的概率密度函数
$$在已知X的概率密度函数(PDF)的情况下，我们计算Y的PDF(也称为导出的密度函数)。主要考虑如下的两步的方法。$$

----
**计算连续随机变量X的函数Y=g(X)的概率密度函数(PDF)**

1. $使用如下公式计算Y的概率函数(CDF)$
$$F_Y(y)=P(g(X)\leq y)=\int_{\{x|g(x)\leq y\}}f_X(x)dx.$$
2. $对F_Y求导，得到Y的PDF：$
$$f_Y(y)=\frac{dF_Y}{dy}(y).$$
----

#### 4.1.1 线性函数

P212页有基本说明

----
**随机变量X的线性函数的概率密度函数**

$假设X是连续随机变量，概率密度函数为f_X，a和b是实数且a\neq 0，如果$

$$Y=aX+b,$$

$则$
$$f_Y(y)=\frac{1}{|a|}f_X(\frac{y-b}{a}).$$

----
**证明该公式**
$首先计算Y的分布函数，然后求导。只证明a>0的情形，a<0时的证明类似。$
$$F_Y(y)=P(Y\leq y)$$

$$\qquad \qquad \quad=P(aX+b \leq y)$$

$$\qquad \qquad \quad=P(X \leq \frac{y-b}{a})$$

$$\qquad \qquad=F_X(\frac{y-b}{a})$$
$对上述等式微分，运用复合函数求导方法，可得$
$$f_Y(y)=\frac{dF_Y(y)}{dy}(y)=\frac{1}{a}f_X(\frac{y-b}{a}).$$

----
1. $指数随机变量的线性函数$
2. $正态随机变量的线性函数$

----
#### 4.1.2 单调函数

$$线性函数的概率密度函数的计算方法和公式可以推广到g是单调函数的情形。假设X是连续随机变量，$$

$$且取值空间在一个给定的区间I里，即当x \notin I时，f_X(x)=0.现在考虑随机变量Y=g(X)，$$

$且在区间I上函数g是严格单调的，即以下两种情形之一：$

1. $严格单调递增：对任意的x，x^{'} \in I，满足x < x^{'}，则g(x) < g(x^{'});$

2. $严格单调递减：对任意的x，x^{'} \in I，满足x < x^{'}，则g(x) > g(x^{'});$

$进一步地，假设g是可微的。它的导数在递增情形是非负的，在递减情形时是非正的。$
$$严格单调函数的一个重要性质是它是"可逆的"，也就是说，存在函数h，称为g的逆，使得对任意的x \in I，有$$

$$y=g(x)当且仅当x=h(y).$$
$对于严格单调函数g，使用如下方便的公式来计算Y=g(X)的概率密度函数。$

----
**连续随机变量X的严格单调函数Y=g(X)的概率密度函数计算公式**
$假设g是严格单调函数，其逆函数h满足：对X的取值空间内任意一点x，$

$$y=g(x)当且仅当x=h(y),$$

$而且函数h是可微的，则Y在支撑集{y|f_Y(y) >0}内的概率密度函数是$
$$f_Y(y)=f_X(h(y))|\frac{dh}{dy}(y)|.$$

----
**证明上式**

。。。。。。

----


#### 4.1.3 两个随机变量的函数

$$h一个随机变量的情形一样，我们采用两步法：先计算分布函数，然后微分得到概率密度函数。$$

例题见217


----
#### 4.1.4 独立随机变量和——卷积
$设X和Y是两个独立的随机变量，考虑它们的和Z=X+Y的分布。$
$首先，我们推导当X和Y都是离散的情况下Z的分布列。$

$$设X和Y是仅取整数值的独立随机变量，它们的分布列分别为P_X和P_Y。则对于任意整数z，$$

$$P_Z(z)=P(X+Y=z)$$

$$\qquad \qquad \qquad \qquad \quad=\sum_{\{(x,y)|x+y=z\}}P(X=x,Y=y)$$

$$\qquad \qquad \qquad \qquad=\sum_xP(X=x,Y=z-x)$$

$$\qquad \qquad \qquad=\sum_x P_X(x)P_Y(z-x).$$

**图见p220**

$$现在我们假设X和Y为独立的连续随机变量，它们的概率密度函数分别为f_X和f_Y。$$

$我们希望求出Z=X+Y的概率密度函数，为此，我们首先求出X和Z的联合概率密度函数，$

$然后通过积分求出Z的概率密度函数。$
$首先注意到$
$$P(Z \leq z|X=x)=P(X+Y \leq z| X=x)$$

$$\qquad \qquad \qquad \quad =P(x+Y \leq z| X=x)$$

$$\qquad \qquad=P(x+Y \leq z)$$

$$\qquad \qquad=P(Y \leq z-x),$$

$$第三个等号由X和Y的独立性所致，两变同时取z得微分，可知f_{Z|X}(z|x)=f_Y(z-x).利用乘法法则，有$$

$$f_{X,Z}(x,z)=f_X(x)f_{Z|X}(z|x)=f_X(x)f_Y(z-x),$$

$最后由上式可推得$
$$f_Z(z)=\int_{-\infty}^\infty f_{X,Z}(x,z)dx=\int_{-\infty}^\infty f_X(x)f_Y(z-x)dx.$$

$$这个公式和离散情况下的公式是完全类似的，只是用积分替代了求和，用概率密度函数代替了分布列。$$

$图4.8给出了这个公式的一个直观理解。$

$$f_Z(z)\delta=P(z \leq X+Y \leq z+\delta)$$

$$\qquad \qquad \qquad =\int_{-\infty}^\infty \int_{z-x}^{z-x+\delta}f_X(x)f_Y(y)dydx$$

$$\qquad \qquad \approx \int_{-\infty}^\infty f_X(x)f_Y(z-x)\delta dx.$$
$去掉上式左右两边的\delta即得所求公式。$

----
1. $相互独立正态随机变量之和得分布$
2. $两独立随机变量之差$

----
#### 4.1.5 卷积的图像计算法
见p223

----

### 4.2 协方差和相关
$X和Y得协方差记为cov(X,Y)，其定义如下：$
$$cov(X,Y)=E[(X-E[X])(Y-E[Y])].$$

$当cov(X,Y)=0时，我们说X和Y是不想关的。$

$$粗略地说，一个正或者负的协方差表示在一个试验中的X-E[X]和Y-E[Y]的值"趋向"有相同或者相反的符号。$$

$因此，协方差的符号提供了一个X和Y之间关系的重要定量指标。$
$协方差的另一种表达为$
$$cov(X,Y)=E[XY]-E[X]E[Y],$$

**推导协方差的一些性质**
$对任意的随机变量X、Y、Z，以及任意实数a和b，$
$$cov(X,X)=var(X),$$

$$cov(X,aY+b)=a \cdot cov(X,Y),$$

$$cov(X,Y+Z)=cov(X,Y)+cov(X,Z).$$

$$要提醒注意的是下面的事实：如果X和Y是相互独立的，则E[XY]=E[X]E[Y]，即有cov(X,Y)=0.$$

$$因此，如果X和Y是相互独立的，它们是不相关的。但是，逆命题不成立。$$

----
例子和结论
。。。。。

----
**随机变量和的方差**
。。。。。。
$$协方差可以用于计算多个随机变量(不必独立)之和的方差。特别地，设随机变量X_1,\cdots,X_n具有有限的方差，则$$

$$var(X_1+X_2)=var(X_1)+var(X_2)+2cov(X_1,X_2).$$

$更一般的结论是$
$$var(\sum_{i=1}^nX_i)=\sum_{i=1}^nvar(X_i)+\sum_{\{i,j|i\neq j\}}cov(X_i,X_j).$$

$上述公式可以如下推导：简记\widetilde{X_i}=X_i-E[X_i],$
$$var(\sum_{i=1}^n X_i)=E[(\sum_{i=1}^n \widetilde{X_i})^2]$$

$$=E[\sum_{i=1}^n \sum_{j=1}^n \widetilde{X_i}\widetilde{X_j}]$$

$$=\sum_{i=1}^n \sum_{j=1}^n E[\widetilde{X_i} \widetilde{X_j}]$$

$$=\sum_{i=1}^n E[\widetilde{X_i}^2]+\sum_{\{(i,j)|i \neq j\}}E[\widetilde{X_i}\widetilde{X_j}]$$

$$=\sum_{i=1}var(X_i)+\sum_{\{(i,j)|i \neq j\}}cov(X_i,X_j).$$

----

**协方差和相关**
- $X和Y的协方差公式如下：$
$$cov(X,Y)=E[(X=E[X])(Y-E[Y])]=E[XY]-E[X]E[Y].$$

- $如果cov(X,Y)=0，则称X和Y把相关。$
- $如果X和Y是独立的，则它们不相关，反之不总独立。$
- $两变量和的方差公式：$
$$var(X+Y)=var(X)+var(Y)+2cov(X,Y).$$
- $具有正方差的随机变量X和Y的相关系数\rho(X,Y)定义为：$
$$\rho(X,Y)=\frac{cov(X,Y)}{\sqrt{var(X)var(Y)}},$$

$且满足$
$$-1 \leq \rho(X,Y) \leq 1 .$$

----
### 4.3 再论条件期望和条件方差
>本节再次讨论随机变量X在给定另一个随机变量Y之下的条件期望，可将这个条件期望看成依赖于Y的函数，因而是随机变量。我们将导出全期望定理的另一个版本，称为重期望法则，用通俗的语言说，就是条件期望的期望等于无条件期望。同时，我们也推导全方差法则，该法则涉及条件方差和无条件方差。

$$一个随机变量X的条件期望E[X|Y=y]的值，依赖于Y的值y.因为E[X|Y=y]是y的函数，所以E[X|Y]是Y的函数，$$

$因此也成为一个随机变量，它的分布依赖于Y的分布。$


----
例子P229

**结论**
$$不管随机变量Y是离散的、连续的、或混合的，只要随机变量X具有有限的期望E[X]，下面的法则成立。$$

$$重期望法则：E[E[X|Y]]=E[X]。$$


----
例子P231

**条件期望的一个重要性质**
$对任意给定的函数g，均有$
$$E[Xg(Y)|Y]=g(Y)E[X|Y].$$
$在给定Y的条件下，g(Y)是一个常数，所以可以从期望中提出来。$

----

#### 4.3.1 条件期望作为估计量




#### 4.3.2 条件方差
$首先介绍随机变量$
$$var(X|Y)=E[(X-E[X|Y])^2|Y]=E[\widetilde{X}^2 |Y].$$

$$这是一个关于Y的函数，对于给定的Y值y，它等于在已知{Y=y}的条件下，X的条件方差为$$

$$var(X|Y=y)=E[\widetilde{X}^2|Y=y].$$

$$利用结论E[\widetilde{X}^2]=0和重期望法则，我们可以将估计误差的方差写成$$

$$var(\widetilde{X})=E[E[\widetilde{X}^2|Y]]=E[var(X|Y)],$$

$所以等式var(X)=var(\widetilde{X})+var(\widetilde{X})就可以写为如下形式.$

----

**全方差法则：**

$$var(X)=E[var(X|Y)]+var(E[X|Y]).$$

----
**条件期望和条件方差的性质**
- $E[X|Y=y]的值依赖于y.$
- $$E[X|Y]是随机变量Y的函数，因此它也是一个随机变量，当Y的值为y时，它的值就等于E[X|Y=y].$$
- $E[E[X|Y]]=E[X](重期望法则).$
- $$E[X|Y=y]可视为Y=y时对X的估计。相应的估计误差E[X|Y]-X是一个零均值的随机变量，$$

$且与E[X|Y]是不相关的.$
- $var(X|Y)也是个随机变量，当Y的值为y时，它的值就等于var(X|Y=y).$
- $var(X)=E[var(X|Y)]+var(E[X|Y])(全方差法则).$

----
### 4.4 矩母函数
>在本节中，我们引进与随机变量相关的矩母 函数这个概念，矩母函数是对概率(分布列或者概率密度函数)的另一种表述。它不是特别直观的，但是在解决某些类型的数学计算时很方便.

$一个与随机变量X相关的矩母函数是参数s的函数M_X(s)，定义如下$
$$M_X(s)=E[e^{sX}].$$

$$当从上下文中可以明显看出所指随机变量是X时，矩母函数也可以简记为M(s)。$$

$更具体，当X是离散随机变量时，相关矩母函数为$

$$M(s)=\sum_x e^{sx}P_X(x),$$

$当X是连续随机变量时，有$
$$M(s)=\int_{-\infty}^\infty e^{sx}f_X(x)dx.$$

----
**例题**
1. $泊松随机变量的矩母函数$
2. $指数随机变量的矩母函数$
3. $随机变量线性函数的矩母函数$
4. $正态分布随机变量的矩母函数$

----

#### 4.4.1 从矩母函数到矩
$$"矩母函数"这一名称是由于随机变量的矩可以通过矩母函数的公式轻易计算出而得来的。$$

$为验证这一点，现在考虑一个连续随机变量X，根据定义$

$$M(s)=\int_{-\infty}^\infty e^{sx}f_X(x)dx,$$

$在M(s)定义式两边取s得导数$
$$\frac{d}{ds}M(s)=\frac{d}{ds}\int_{-\infty}^\infty e^{sx}f_X(x)dx$$

$$\qquad \qquad =\int_{-\infty}^\infty \frac{d}{ds} e^{sx}f_X(x)dx$$

$$\qquad \qquad =\int_{-\infty}^\infty xe^{sx}f_X(x)dx.$$

$上面的等式对s取任何值都成立.考虑s=0时得特殊情况，有$

$$\frac{d}{ds}M(s)|_{s=0}=\int_{-\infty}^\infty xf_X(x)dx=E[X].$$

$更一般地，如果我们对M(s)取n次s的导数，通过类似的计算有$
$$\frac{d^n}{ds^n}M(s)|_{s=0}=\int_{-\infty}^\infty x^nf_X(x)dx=E[X^n]. $$

----

#### 4.4.2 矩母函数的可逆性
>矩母函数M_X(s)的一个非常重要的性质是它可逆，即可用它来确定随机变量X的概率律。当然，为了使矩母函数M_X(s)能够确定相应的概率律，一些合适的数学条件是必要的。幸运的是，我们所列举的例子中的矩母函数都满足这些条件。

----
**矩母函数可逆的条件**

$$假定随机变量X的矩母函数M_X(s)满足：存在一个正数a，对在区间[-a,a]中的任意s，M_X(s)都是有限的，$$

$则矩母函数M_X(s)唯一地决定X的分布函数.$

$$实际上，有显示的公式可以让我们从随机变量的矩母函数导出它的分布列或概率密度函数，但是使用起来相当困难。$$

$$实际上，矩母函数通常可以基于已知分布-矩母函数组合的表格，通过"类型配合"进行反演。$$

----

#### 4.4.3 独立随机变量和
>矩母函数的方法对于处理随机变量和的问题尤其便利，我们将看到，独立随机变量的和的矩母函数是和项的矩母函数的乘积。这样也提供了卷积公式之外的另一个便利的公式。

$$记X和Y是独立的，对于任意的s，e^{sX}和e^{sY}是相互独立的随机变量，因此，它们乘积的期望即为它们期望的乘积，即$$

$$M_Z(s)=E[e^{sX}]E[e^{sY}]=M_X(s)M_Y(s).$$

$同样地，如果X_1,\cdots ,X_n是独立的随机变量，且$
$$Z=X_1+\cdots+X_n,$$

$相应的矩母函数之间有下面的关系：$
$$M_Z(s)=M_{X_1}(s)+\cdots+M_{X_n}(s).$$

----
**例题**
1. $二项随机变量的矩母函数$
2. $独立泊松随机变量之和仍为泊松随机变量$
3. $独立正态随机变量之和仍为正态随机变量$
----
**矩母函数及其性质的小结**
- $随机变量X的矩母函数定义如下：$
$$M_X(s)=E[e^{sX}]=\begin{cases}
    \sum_x e^{sz}P_X(x)， \qquad若X为离散型, \\
    \int_{-\infty}^\infty e^{sz}f_X(x)dx, \qquad 若X为连续型
\end{cases}$$
- $随机变量的分布完全由它的矩母函数确定.$
- $利用矩母函数计算随机变量的各阶矩:$
$$M_X(0)=1, \quad \frac{d}{ds}M_X(s)|_{s=0}=E[X], \quad \frac{d^n}{ds^n}M_X(s)|_{s=0}=E[X^n].$$

- $若Y=aX+b，则M_Y(s)=e^{sb}M_X(as).$
- $若X和Y相互独立，则M_{X+Y}(s)=M_X(s)M_Y(s).$

----
**常见的离散随机变量的矩母函数**
P245



**常见连续随机变量的矩母函数**
- $(a,b)上的均匀分布(a \leq x \leq b)
$
$$f_X(x)=\frac{1}{b-a}, \qquad M_X(s)=\frac{1}{b-a} \cdot \frac{e^{sb}-e^{sa}}{s}.$$
- $参数为\lambda 的指数分布(x \geq 0)$
  $$f_X(x)=\lambda e^{-\lambda x}, \qquad M_X(s)=\frac{\lambda}{\lambda -s},(s < \lambda).$$
- $参数为(\mu, \sigma^2 )的正态分布(-\infty < x < \infty)$

$$f_X(x)=\frac{1}{\sqrt{2\pi \sigma}}e^{-(x-\mu)^2/2\sigma^2}, \qquad M_X(s)=e^{(\sigma^2s^2/2)+\mu s}.$$

-----

#### 4.4.4 联合分布的矩母函数
。。。。。。

----

### 4.5 随机数个相互独立的随机变量之和

。。。。。。。


-----
**随机数个相互独立随机变量之和的性质**
$$记X_1,X_2,\cdots 为均值E[X]方差var(X)的同分布随机变量。记N为取值于非负整数的随机变量。$$

$我们假定上述所有变量相互独立，下面考虑变量和$

$$Y=X_1+\cdots+X_N.$$

$那么：$
$$E[Y]=E[X]E[N]。$$

$$var(Y)=var(X)E[N]+(E[X])^2var(N).$$

- $矩母函数M_Y(s)可由计算矩母函数M_N(s)的公式得到，将其中的e^S全部替换成M_X(s)即可。$



----

### 4.6 小结和讨论
P249