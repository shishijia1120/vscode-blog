## 矩阵代数

### 2.1 矩阵运算
- $A=[a_{ij}]$的对角线元素是$a_{11},a_{22},a_{33},\cdots,$它们组成$A$的主对角线.对角矩阵是一个方阵，它的非对角线元素全是0.

#### 和与标量乘法
- 我们称两个矩阵相等，若它们有相同的维数(即有相同行数和列数)，而且对应元素相等.

**定理1** 设$A,B,C$是相同维数的矩阵，$r$与$s$为数，则有
1. $A+B=B+A$
2. $(A+B)+C=A+(B+C)$
3. $A+0=A$
4. $r(A+B)=rA+rB$
5. $(r+s)A=rA+sA$
6. $r(sA)=(rs)A$

#### 矩阵乘法
- 当把矩阵$B$乘以向量$x$，它将$x$变换为向量$Bx$，若这向量又乘以矩阵$A$，结果得向量$A(Bx)$，见图.
![alt 文本](../../../图片/线结5.png)
于是$A(Bx)$是由$x$经符合映射变换所得，此映射是1.7所研究的线性变换.我们的目的是将此复合映射表示为乘以一个矩阵的变换，此矩阵记为$AB$，即
$$A(Bx)=(AB)x \qquad \qquad \qquad \qquad(1)$$

见图.
![alt 文本](../../../图片/线结6.png)

若$A$是$m \times n$矩阵，$B$是$n \times p$矩阵，$x$属于$R^p$，用$b_1,\cdots,b_p$表示$B$的各列，而$x$得元素为$x_1,\cdots,x_p$，则
$$Bx=x_1b_1+\cdots+x_pb_p$$

由于乘以$A$的线性性质
$$A(Bx)=A(x_1b_1)+\cdots+A(x_pb_p)=x_1Ab_1+\cdots+x_pAb_p$$

向量$A(Bx)$是向量$Ab_1,\cdots,Ab_p$的线性组合，以$x$的元素为权，若我们把这些向量表示成一个矩阵的各列，就有
$$A(Bx)=[Ab_1 \quad Ab_2 \quad \cdots \quad Ab_p]x$$

于是乘以矩阵$[Ab_1 \quad Ab_2 \quad \cdots \quad Ab_p]$把$x$变为$A(Bx)$，我们已经找到了所需要的矩阵.


- **定义** 若$A$是$m \times n$矩阵，$B$是$n\times p$矩阵，$B$的列是$b_1,\cdots,b_p$，则乘积$AB$是$m\times p$矩阵，它的各列是$Ab_1,\cdots,Ab_p$，即
$$AB=A[b_1 \quad b_2 \quad \cdots \quad b_p]=A[b_1 \quad Ab_2 \quad \cdots \quad Ab_p]$$

$AB$的每一列都是$A$的各列的线性组合，以$B$的对应列的元素为权.

由定义可知，$AB$的行数等于$A$的行数，列数等于$B$的列数.



#### 矩阵乘法的性质
- **定理2** 设$A$为$m \times n$矩阵，$B、C$的维数使下列各式的乘积有定义.
1. $A(BC)=(AB)C$
2. $A(B+C)=AB+AC$
3. $(B+C)A=BA+CA$
4. $r(AB)=(rA)B=A(rB),r为任意数$
5. $I_mA=A=AI_m$


#### 矩阵的乘幂
$A^k$

#### 矩阵的转置

- **定理3** 设$A$与$B$表示矩阵，其维数使下列和与积有定义，则
1. $(A^T)^T=A.$
2. $(A+B)^T=A^T+B^T.$
3. $对任意数r，(rA)^T=rA^T.$
4. $(AB)^T=B^TA^T.$

若干个矩阵的乘积的转置等于它们的转置的乘积，但乘积的顺序相反.

### 2.2 矩阵的逆
- 一个$n \times n$矩阵$A$是可逆的，若存在一个$n \times n$矩阵$C$使
$$AC=I 且 CA=I$$

这时称$C$是$A$的逆阵.实际上，$C$由$A$唯一确定，因为若$B$是另一个$A$的逆阵，那么将有$B=BI=B(AC)=(BA)C=IC=C$，于是，若$A$可逆，它的逆是唯一的，我们将它记为$A^{-1}$，于是
$$AA^{-1}=I 且 A^{-1}A=I$$

不可逆矩阵有时称为奇异矩阵，而可逆矩阵也称为非奇异矩阵.


- **定理4** 设$A=\begin{bmatrix}
    a \quad b \\
    c \quad d \\
\end{bmatrix}，若ad-bc \neq 0$，且$A$可逆且
$$A^{-1}=\frac{1}{ad-bc}\begin{bmatrix}
    d \quad -b \\
    -c \quad a \\
\end{bmatrix}$$

若$ad-bc=0$，则$A$不可逆.


- **定理5** 若$A$是可逆$n \times n$矩阵，则对每一$R^n$中的$b$，方程$Ax=b$有唯一解$x=A^{-1}b.$

- **定理6**
1. 若$A$是可逆矩阵，则$A^{-1}$也可逆而且$(A^{-1})^{-1}=A.$
2. 若$A$和$B$都是$n \times n$可逆矩阵，$AB$也可逆，且其逆是$A$和$B$的逆矩阵按相反顺序的乘积，即$(AB)^{-1}=B^{-1}A^{-1}.$
3. 若$A$可逆，则$A^T$也可逆，且其逆是$A^{-1}$的转置，那$(A^T)^{-1}=(A^{-1})^T.$

定理6的推广：若干个$n \times n$可逆矩阵的积也是可逆的，其逆等于这些矩阵的逆按相反顺序的乘积.

#### 初等矩阵
- 把单位矩阵进行一次行变换，就得到初等矩阵.

- 若对$m \times n$矩阵$A$进行某种初等行变换，所得矩阵可写成$EA$，其中$E$是$m \times m$矩阵，是由$I_m$进行同一行变换所得.

- 每个初等矩阵$E$是可逆的，$E$的逆是一个同类型的初等矩阵，它把$E$变回$I$.
$\quad$
- **定理7** $n \times n$矩阵$A$是可逆的，当且仅当$A$行等价于$I_n$，这时，把$A$变为$I_n$的一系列初等行变换同时把$I_n$变成$A^{-1}$.

#### 求$A^{-1}$的算法
- 把增广矩阵$[A \quad I]$进行行化简，若$A$行等价于$I$，则$[A \quad I]$行等价于$[I \quad A^{-1}]$，否则$A$没有逆.


#### 逆矩阵的另一个观点
- 用$e_1,\cdots,e_n$表示$I_n$的各列，则把$[A\quad I]$行变换成$[I \quad A^{-1}]$的过程可看作解$n$个方程组.
$$Ax=e_1,Ax=e_2,\cdots,Ax=e_n \qquad \qquad \qquad(2)$$

其中这些方程组的"增广列"都放在$A$的右边，构成矩阵
$$[A \quad e_1 \quad e_2 \quad \cdots\quad e_n]=[A \quad I]$$

方程$AA^{-1}=I$及矩阵乘法的定义说明$A^{-1}$的列正好是方程(2)的解.这一点是很有用的，因为在某些应用问题中，只需要$A^{-1}$的一列或两列，这时只需要解(2)中的相应方程.

### 2.3 可逆矩阵的特征
- **定理8** (可逆矩阵定理)
设$A$为$n\times n$矩阵，则下列命题是等价的，即对某一特定的$A$，它们同时为真或同时为假.
1. $A$是可逆矩阵.
2. $A$等价于$n \times n$单位矩阵.
3. $A$有$n$个主元位置.
4. 方程$Ax=0$仅有平凡解.
5. $A$的各列线性无关.
6. 线性变换$x|->Ax$是一对一的.
7. 对$R^n$中任意$b$，方程$Ax=b$至少有一个解.
8. $A$的各列生成$R^n$.
9. 线性变换$x|->Ax$把$R^n$映射到$R^n上$.
10. 存在$n \times n$矩阵$C$使$CA=I$.
11. 存在$n \times n$矩阵$D$使$AD=I$.
12. $A^T$是可逆矩阵.

#### 可逆线性变换
- 回忆2.1节矩阵乘法对应于线性变换的复合.当矩阵$A$可逆时，方程$A^{-1}Ax=x$可看作关于线性变换的一个命题，见图.
![alt 文本](../../../图片/线结7.png)

线性变换$T:R^n \rightarrow R^n$称为可逆的，若存在函数$S:R^n \rightarrow R^n$使得
- 对所有$R^n$中的$x，S(T(x))=x$
- 对所有$R^n$中的$x，T(S(x))=x$

下列定理说明若这样的$S$存在，它是唯一的而且必是线性变换.我们称$S$是T的逆，把它写成$T^{-1}$.

- **定理9** 设$T:R^{n} \rightarrow R^n$为线性变换，$A$为$T$的标准矩阵.则$T$可逆当且仅当$A$是可逆矩阵.这时由$S(x)=A^{-1}x$定义的线性变换$S$是满足(1)和(2)的唯一函数.


### 2.4 分块矩阵

#### 加法与标量乘法
。。。


#### 分块矩阵的乘法
- 分块矩阵也可用通常的行列法则进行，就如每一块都是数一样，只要$A$的列的分法与$B$的行的分法一致.

例3 设
$$A=\begin{bmatrix}
    2 \quad -3 \quad 1 \quad 0 \quad -4\\
    1 \quad 5 \quad -2 \quad 3 \quad -1\\
    0 \quad -4 \quad -2 \quad 7 \quad -1\\
\end{bmatrix}=\begin{bmatrix}
    A_{11} \quad A_{12} \\
    A_{21} \quad A_{22} \\
\end{bmatrix},B=\begin{bmatrix}
    6 \quad 4 \\
    -2 \quad 1 \\
    -3 \quad 7 \\
    -1 \quad 3 \\
    5 \quad 2 \\
\end{bmatrix}=\begin{bmatrix}
    B_1 \\B_2
\end{bmatrix}$$

- $A$的5列被分成3列一组和2列一组.$B$的5行按同样的方法分块——被分成3行一组和2行一组.我们称$A$和$B$的分块是与分块乘法相一致的.$AB$的乘积可以写成
$$AB=\begin{bmatrix}
    A_{11} \quad A_{12} \\
    A_{21} \quad A_{22} \\
\end{bmatrix} \begin{bmatrix}
    B_1 \\B_2
\end{bmatrix}=\begin{bmatrix}
    A_{11}B_1 \quad A_{12}B_2 \\
    A_{21}B_1 \quad A_{22}B_2 \\
\end{bmatrix}=\begin{bmatrix}
    -5 \quad 4 \\
    -6 \quad 2 \\
    2 \quad  1\\
\end{bmatrix}$$


- **定理10** (AB的列行展开)
若$A$是$m \times n$矩阵，$B$是$n \times p$矩阵，则
$$AB=[col_1(A) \quad col_2(A) \quad \cdots \quad col_n(A)] \begin{bmatrix}
    row_1(B)\\row_2(B)\\ \vdots  \\ row_n(B)
\end{bmatrix} \qquad \qquad \qquad (1)$$

#### 分块矩阵的逆
- 例5 形如$A=\begin{bmatrix}
    A_{11} \quad A_{12} \\
    0 \quad A_{22} \\
\end{bmatrix}$的矩阵称为分块上三角矩阵，设$A_{11}$是$p \times p$矩阵，$A_{22}$是$q\times q$矩阵，且$A$为可逆矩阵，求$A^{-1}$的表达式.
$\quad$
- **解**用$B$表示$A^{-1}$且把它分块使
$$A=\begin{bmatrix}
    A_{11} \quad A_{22} \\
    0 \quad A_{22} \\
\end{bmatrix} \begin{bmatrix}
    B_{11} \quad A_{12} \\
    B_{21} \quad B_{22} \\
\end{bmatrix}=\begin{bmatrix}
    I_{p} \quad 0 \\
    0 \quad I_{q} \\
\end{bmatrix} \qquad \qquad \qquad (2)$$

这个矩阵方程包含了4个有关未知子矩阵$B_{11},\cdots,B_{22}$的方程，计算(2)式左边的乘积得
$$A_{11}B_{11}+A_{12}B_{21}=I_{p} \qquad \qquad \qquad (3)$$

$$A_{11}B_{12}+A_{12}B_{22}=0 \qquad \qquad \qquad (4)$$

$$A_{22}B_{21}=0 \qquad \qquad \qquad (5)$$

$$A_{22}B_{22}=I_q \qquad \qquad \qquad (6)$$


方程(6)本身并不能说明$A_{22}$可逆，因我们还不知道$B_{22}A_{22}=I_q$，但应用可逆矩阵定理，及$A_{22}$是方阵的事实，可以断定$A_{22}$为可逆且$B_{22}=A_{22}^{-1}$.现在我们利用(5)式求得
$$B_{21}=A_{22}^{-1}=0.$$

因此(3)式简化为
$$A_{11}B_{11}+0=I_p$$

这说明$A_{11}$是可逆得，且$B_{11}=A_{11}^{-1}$，最后由(4)，
$$A_{11}B_{12}=-A_{12}B_{22}=-A_{12}A_{22}^{-1}和B_{12}=-A_{11}^{-1}A_{12}A_{22}^{-1}$$

于是
$$A^{-1}=\begin{bmatrix}
    A_{11} \quad A_{12} \\
    0 \quad A_{22}
\end{bmatrix}^{-1}=\begin{bmatrix}
    A_{11}^{-1} \quad -A_{11}^{-1}A_{12}A_{22}^{-1} \\
    0 \quad A_{22}^{-1} \\
\end{bmatrix}$$

分块对角矩阵是一个分块矩阵，除了主对角线上各分块外，其余全是零分块，这样的一个矩阵是可逆的当且仅当主对角线上各分块都是可逆的.


### 2.5 矩阵因式分解
- 矩阵$A$的因式分解是把$A$表示为两个或更多个矩阵的乘积.

#### LU分解
![alt 文本](../../../图片/线结9.png)

- 在研究如何构造$L$和$U$之前，我们将看看它们为什么这么有用.当$A=LU$时，方程$Ax=b$可写成$L(Ux)=b$，把$Ux$写成$y$，可以由解下面一对方程来求解$x$:
$$Ly=b$$

$$Ux=y \qquad \qquad \qquad (2)$$

首先解$Ly=b$然后解$Ux=y$求得$x$，见下图.每个方程都比较容易解，因$L$和$U$都是三角矩阵.
![alt 文本](../../../图片/线结8.png)


#### LU分解算法
- 设$A$可以化为阶梯形$U$，化简过程中仅用行倍加变换：即把一行的倍数加于它下面的另一行.这样，存在单位下三角初等矩阵$E_1,\cdots,E_p$使
$$E_p\cdots E_1A=U \qquad \qquad \qquad (3)$$

于是
$$A=(E_p \cdots E_1)U=LU$$

其中
$$L=(E_p\cdots E_1)^{-1} \qquad \qquad \qquad (4)$$

可以证明，单位下三角矩阵的逆也是单位下三角矩阵.于是$L$是单位下三角矩阵.
注意(3)中的行变换，它把$A$化为$U$，所以也把(4)中的$L$化为$I$，因
$$E_p\cdots E_1L=(E_p \cdots E_1)(E_p \cdots E_1)^{-1}=I$$

这一点是构造$L$的关键.

**LU分解的算法**
1. 如果可能的话，用一系列的倍加变换把$A$化为阶梯形.
2. 填充$L$的元素使相同的行变换把$L$变为$I$.


### 2.8 $R^n$的子空间
- 通常子空间与某个矩阵$A$有关，它们提供了关于方程$Ax=b$的有用信息.
$\quad$
- **定义** $R^n$中的一个子空间是$R^n$中的集合$H$，具有以下三个性质：
1. 零向量属于$H$.
2. 对$H$中任意的向量$u$和$v$，$u+v$属于$H$.
3. 对$H$中任意向量$u$和数$c$，$cu$属于$H$.

换句话说，子空间对加法和标量乘法运算是封闭的.例如，通过原点的一个平面是一种很典型的子空间，可以看作例1中子空间的一种示例.见图.
![alt 文本](../../../图片/线结10.png)

- 例1 若$v_1和v_2$是$R^n$中的向量，$H=Span\{v_1,v_2\}$，则$H$是$R^n$的子空间.为证明这一点，注意零向量属于$H$(因$0v_1+0v_2$是$v_1$和$v_2$的线性组合)，现取$H$中任意两个向量，比如说
$$u=s_1v_1+s_2v_2, v=t_1v_1+t_2v_2,$$

那么
$$u+v=(s_1+t_1)v_1+(s_2+t_2)v_2$$

这证明了$u+v$是$v_1$和$v_2$的线性组合，因此属于$H$，同样，对任意数$c$，向量$cu$属于$H$，因为$cu=c(s_1v_1+s_2v_2)=(cs_1)v_1+(cs_2)v_2$.

若$v_1$不等于零而$v_2$是$v_1$的倍数，则$v_1$和$v_2$仅生成通过原点的直线.所以通过原点的直线是子空间的另一个例子.见图.
![alt 文本](../../../图片/线结11.png)

#### 矩阵的列空间和零空间
应用中，$R^n$的子空间通常出现在以下两种情况中，它们都与矩阵有关.

- **定义** 矩阵$A$的列空间是$A$的各列的线性组合的集合，记住$Col A$.

若$A=[a_1 \cdots a_n]$，它们各列属于$R^m$，则$Col A$和$Span \{a_1,\cdots,a_n\}$相同，

例4说明$m \times n$矩阵的列空间是$R^m$的子空间.注意，仅当$A$的列生成$R^m$时，$Col A$等于$R^m$.否则，$Col A$仅是$R^m$的一部分.

例4 设
$$A=\begin{bmatrix}
    \quad1 \quad -3 \quad -4 \\
    -4 \qquad 6 \quad -2 \\
    -3 \qquad 7 \qquad 6 \\
\end{bmatrix},b=\begin{bmatrix}
    3 \\ 3 \\ -4
\end{bmatrix},$$

确定$b$是否属于$A$的列空间.

向量$b$是$A$的各列的线性组合，当且仅当$b$可写成$Ax$的形式，$x$属于$R^3$，也就是说，当且仅当方程$Ax=b$有解.把增广矩阵$[A b]$进行行变换.
$$A=\begin{bmatrix}
    \quad1 \quad -3 \quad -4 \quad 3 \\
    -4 \qquad 6 \quad -2 \quad 3\\
    -3 \qquad 7 \quad 6 \quad -4\\
\end{bmatrix} \sim \begin{bmatrix}
    1 \quad -3 \quad -4 \quad 3 \\
    0\qquad 6 \quad -18 \quad 15\\
    0 \qquad 0 \quad 0 \quad 0\\
\end{bmatrix}$$

可知$Ax=b$相容，从而$b$属于$Col A$.
![alt 文本](../../../图片/线结12.png)

例4的解答说明，当线性方程组写成$Ax=b$的形式，$A$的列空间是所有使方程有解的向量$b$的集合.

- **定义** 矩阵$A$的零空间是齐次方程$Ax=0$的所有解的集合，记为$Nul A$.
当$A$有$n$列时，$Ax=0$的解属于$R^n$，$A$的零空间是$R^n$的子集.事实上，$Nul A$具有$R^n$的子空间的性质.
$\quad$
- **定理12** $m \times n$矩阵$A$的零空间是$R^n$的子空间.等价地，$n$个未知数的$m$个齐次线性方程的解的全体是$R^n$的子空间.
**证** 零向量属于$Nul A$(因A0=0)，为证明$Nul A$满足其他两个性质，取$Nul A$中两个向量$u和v$，即设$Au=0和Av=0$，那么由矩阵乘法的性质，
$$A(u+v)=Au+Av=0.$$

于是$u+v$满足$Ax=0$，所以$u+v$属于$Nul A$，同样，对任意数$c$，$A(cu)=c(Au)=c(0)=0.$这就证明了$cu$也属于$Nul A$.

为检验给定向量$v$是否属于$Nul A$，只要计算$Av$，看他是否零向量，因$Nul A$是用其中每个向量必须满足的一个条件来描述的，我们说零空间是隐形定义的.相反，列空间是显性定义的，因$Col A$中的向量可由$A$的各列(利用线性组合)构造出来.为了建立$Nul A$的显性描述，解$Ax=0$这个方程，把解写成参数向量形式.

#### 子空间的基
- 因为子空间一般含有无穷多个向量，子空间中的问题最好能够通过研究生成这个子空间的一个小的有限集合来解决，这个集合越小越好.可以证明，最小可能的生成集合必是线性无关的.
$\quad$
- **定义** $R^n$中子空间$H$的一组基是$H$中一个线性无关集，它生成$H$.

求矩阵的列空间的基比求零空间的基容易.然而，这个方法需要一些说明，让我们从一个简单情形开始.

例7 求下列矩阵的列空间的基：
$$B=\begin{bmatrix}
    1 \quad 0 \quad -3 \quad 5 \quad 0 \\
    0\quad 1 \quad 2 \quad -1 \quad 0\\
    0 \qquad 0 \quad 0 \quad 0 \quad 1 \\
    0 \quad 0 \quad 0 \quad 0 \quad 0 \\
\end{bmatrix}$$

**解** 用$b_1,\cdots,b_5$表示$B$的列，注意$b_3=-3b_1+2b_2,b_4=5b_1-b_2,b_3和b_4$是主元列的线性组合，这意味着$b_1,\cdots,b_5$的任意线性组合实际上仅是$b_1,b_2和b_5$的线性组合.事实上，若$v$是$Col B$的任意向量，例如说，
$$v=c_1b_1+c_2b_2+c_3b_3+c_4b_4+c_5b_5$$

则把$b_3$和$b_4$代入，可把$v$写成
$$v=c_1b_1+c_2b_2+c_3(-3b_1+2b_2)+c_4(5b_1-b_2)+c_5b_5$$

它是$b_1,b_2,b_5$的线性组合，所以$\{b_1,b_2,b_3\}$生成$Col B$，又$b_1,b_2和b_5$为线性无关，因为它们是单位矩阵的列，所以$B$的主元列构成$Col B$的基.

例7中的矩阵$B$是简化阶梯形.为处理一个一般的矩阵$A$，注意$A$的各列之间的线性相关关系可表示为形式$Ax=0$(若某些列不含在特殊的线性相关关系中，则$x$的对应元素为零).当$A$行化简为阶梯形$B$时，它的列虽然改变，但方程$Ax=0$和$Bx=0$有相同的解集，即$A$的列与$B$的列有相同的线性相关关系.

例8 可以证明矩阵
$$A=[a_1 a_2 \cdots a_5]=\begin{bmatrix}
    1 \quad 3 \quad 3 \quad 2 \quad -9 \\
    -2\quad -2 \quad 2 \quad -8 \quad 2\\
    2 \qquad 3 \quad 0 \quad 7 \quad 1 \\
    3 \quad 4 \quad -1 \quad 11 \quad -8 \\
\end{bmatrix}$$

行等价于例7的矩阵$B$，求$Col A$的一组基.

**解** 由例7，$A$的主元列是第1，2，5列.同时有$b_1=-3b_1+2b_2$和$b_4=5b_1-b_2$，因行变换不影响列的线性相关关系，有
$$a_3=-3a_1+2a_2和a_4=5a_1-a_2$$

经验证这是成立的!由例7的讨论，生成$A$的列空间不需要用$a_3和a_4$.同样，$\{a_1,a_2,a_5\}$必是线性无关的，因$a_1,a_2,a_5$之间的任意线性相关关系必然也使$b_1,b_2,b_5$有同样的关系，因$\{b_1,b_2,b_5\}$为线性无关，$\{a_1,a_2,a_5\}$也线性无关，因此是$Col A$的一组基.

例8的讨论可以用来证明下列定理.
- **定理13** 矩阵$A$的主元列构成列空间的基.
**警告** 小心，要用$A$的主元列本身作为$Col A$的基，阶梯形$B$的列本身通常并不在于$A$的列空间内.


### 2.9 维数与秩
- 本节从坐标系的概念开始对子空间和子空间的基继续加以讨论.

#### 坐标系
- 选择子空间$H$的一个基代替一个纯粹生成集的主要原因，是$H$中的每个向量都可以被表示为基向量的线性组合的唯一形式.为了明确原因，假设$B=\{b_1,\cdots,b_p\}$是$H$的基，$H$中的一个向量$x$可以由两种方式生成，设
$$x=c_1b_1+\cdots+c_pb_p，且 x=d_1b_1+\cdots+d_pb_p$$

因为$B$是线性无关的，(2)中的权值必全为零.亦即对$1 \leq j \leq p,c_j=d$，(1)式中的两种表示实际上是相同的.

- **定义** 假设$B=\{b_1,\cdots,b_p\}$是子空间$H$的一组基，对$H$中每一个向量$x$，相对于基$B$的坐标是使$x=c_1b_1+\cdots+c_pb_p$成立的权值$c_1,\cdots,c_p$，且$R^p$中的向量
$$[x]_B=\begin{bmatrix}
    c_1 \\ \cdots \\ c_p\\
\end{bmatrix}$$

称为$x$(相对于$B$)的坐标向量，或$x$的$B-$坐标向量.

例1 设
$$v_1=\begin{bmatrix}
    3\\6 \\2
\end{bmatrix},v_2=\begin{bmatrix}
    -1\\0 \\1
\end{bmatrix},x=\begin{bmatrix}
    3\\12 \\7
\end{bmatrix},B={v_1,v_2}.$$

则因$v_1,v_2$线性无关，$B$是$H=Span\{v_1,v_2\}$的基.判断$x$是否在$H$中，如果是，求$x$相对基$B$的坐标向量.

**解** 如果$x$在$H$中，则下面的向量方程是相容的：
$$c_1\begin{bmatrix}
    3\\6\\2\\
\end{bmatrix}+c_2\begin{bmatrix}
    -1 \\ 0 \\1
\end{bmatrix}=\begin{bmatrix}
    3 \\ 12 \\ 7
\end{bmatrix}$$

如果数$c_1,c_2$存在，即是$x$的$B-$坐标，由行操作得
$$\begin{bmatrix}
    3 \quad -1 \quad 3 \\
    6\quad 0 \quad 12 \\
    2 \qquad 1 \quad 7  \\
\end{bmatrix} \sim \begin{bmatrix}
    1\quad 0 \quad 2 \\
    0\quad 1 \quad 3 \\
    0 \qquad 0 \quad 0  \\
\end{bmatrix} $$

于是$c_1=2,c_2=3,[x]_B=\begin{bmatrix}
    2\\3
\end{bmatrix}$.基$B$确定$H$上的一个"坐标系"，如图所示.
![alt 文本](../../../图片/线结13.png)

注意到虽然$H$中的点也在$R^3$中，它们完全由属于$R^2$中的左边向量确定.上图中的平面上的格子使$H$看起来像$R^2$.映射$ x|\rightarrow[x]_B$是$H$和$R^2$之间保持线性组合关系的一一映射.我们称这种映射是同构的，且$H$与$R^2$同构.

一般地，如果$B=\{b_1,\cdots,b_p\}$是$H$的基，则映射$x|\rightarrow [x]_B$是使$H$和$R^p$的形态一样的一一映射(尽管$H$中的向量可能有多于$p$个元素).

#### 子空间的维数
- 可以证明，若子空间$H$有一组基包含$p$个向量，则$H$的每个基都正好包含$p$个向量，于是下列定义是有意义的.
$\quad$
- **定义** 非零子空间$H$的维数，用$dimH$来表示，是$H$的任意一个基的向量个数.零子空间${0}$的维数定义为零.

$R^n$空间维数为$n$，$R^n$的每个基由$n$个向量组成.$R^3$中一个经过0的平面是2维的，一条经过0的直线是一维的.

要确定$Nul A$的维数，只需求出$Ax=0$中的自由变量个数.
$\quad$
- **定义** 矩阵$A$的秩(记为$rank A$)s 是$A$的列空间的维数.

因为A的主元列形成$Col A$的一个基，$A$的秩正好是$A$的主元列的个数.

例3 确定矩阵的秩
$$A=\begin{bmatrix}
    2 \quad 5 \quad -3 \quad -4 \quad 8 \\
    4\quad  7 \quad -4 \quad -3 \quad 9\\
    6 \qquad 9 \quad -5 \quad 2 \quad 4 \\
    0 \quad -9 \quad 6 \quad 5 \quad -6 \\
\end{bmatrix}$$

简化$A$成阶梯形：
$$A \sim \begin{bmatrix}
    2 \quad 5 \quad -3 \quad -4 \quad 8 \\
    0\quad  -3 \quad 2 \quad 5 \quad  9\\
    0 \qquad -6 \quad 4 \quad 14 \quad 4 \\
    0 \quad -9 \quad 6 \quad 5 \quad -6 \\
\end{bmatrix} \sim \cdots \sim \begin{bmatrix}
    2 \quad 5 \quad -3 \quad -4 \quad 8 \\
    0\quad  -3 \quad 2 \quad 5 \quad -7\\
    0 \qquad 0 \quad 0 \quad 4 \quad -6 \\
    0 \quad 0 \quad  0 \quad 0 \quad 0 \\
\end{bmatrix}$$

矩阵$A$由3个主元列(1、2、4列)，因此$rank A=3$.

从例3的行化简可见在$Ax=0$中有两个自由变量，因为$A$的五列中有两列不是主元列.(非主元列对应于$Ax=0$中的自由变量.)由于主元列的个数加上非主元列的个数正好是$A$的列数，$Col A$和$Nul A$的维数有如下有用的关系.(详细内容见4.6的秩定理.)

- **定理14** (秩定理) 如果一矩阵$A$有$n$列，则$rank A+dim Nul A=n$.

下面的定理在应用中很重要，并在第5章和第6章中用到.该定理(在4.5节中证明)当然是很明显的，若你想到$p$维子空间同构于$R^p$.由可逆矩阵定理知，$R^p$中的$p$个向量线性无关，当且仅当这$p$个向量也生成$R^p$.

- **定理15** (基定理) 设$H$是$R^n$的$p$维子空间，$H$中的任何恰好由$p$个成员组成的线性无关集构成$H$的一个基.并且，$H$中任何生成$H$的$p$个向量集也构成$H$的一个基.

#### 秩和可逆矩阵定理
- 各种与矩阵相关的向量空间的概念为可逆矩阵定理提供了更多的命题.
- **定理** (可逆矩阵定理(续))
设$A$是一$n \times n$矩阵，则下面的每个命题与$A$是可逆矩阵的命题等价：
1. A的列向量构成$R^n$的一个基.
2. $Col A=R^n$.
3. $dimCol A=n$.
4. $rank A=n$.
5. $Nul A={0}$.
6. $dim Nul A=0$.

