## 第1篇 Linux命令
### 1 Linux简介与安装


#### 1.2 Linux的存储设备和目录结构
##### 1.2.1 Linux系统中的存储设备


##### 1.2.2 Linux系统中的目录结构

#### 1.3 虚拟化技术的应用




### 2 Linux系统入门

#### 2.2 登录系统
Linux支持多种登录方式：
- 本地登录：通常用于笔记本等桌面系统或服务器出现故障无法连接网络的情况。本地登录可用使用图形界面和命令行模式两种方式。 
- 远程登录：大多数用户系统和服务器都使用远程登录。远程登陆可以使用SSH、Telnet、VNC、SFTP 4种方式。


##### 2.2.1 图形界面登录

##### 2.2.2 命令行登录


##### 2.2.3 SSH远程登录
常见的远程登陆有SSH、Telnet、VNC、SFTP 4种方式。
如何在Windows和Linux系统中使用SSH远程登录：
1. Windows系统中使用SSH登录需要借助一些工具，常用的工具有PuTTY和SecureCRT等。
2. Linux系统中要使用SSH远程登录到另一个Linux系统。可以使用ssh命令加用户名和IP地址的方法。

##### 2.2.6 SFTP登录
1. Windows系统中的SFTP登录
Windows系统中可以使用的SFTP登录工具有WinSCP和SecureFX，这两个工具的主要作用是从Windows主机远程登录到Linux服务器，并在二者之间进行文件传送。

2. Linux系统中的SFTP登录




#### 2.3 关闭、重启系统
Linux是一个多用户、多任务系统，如果不正确地关闭或重启系统，可能会导致系统中的用户数据丢失。

##### 2.3.1 关闭系统命令之shutdown
应该以root用户的身份执行shutdown等关闭、重启系统等命令。
1. 在1分钟后关闭系统：
    ``` # shutdown -h 1```
2. 立即关闭系统
    ```# shutdown -h now```
3. 指定时间关闭系统
    ```# shutdown -h 15:30```
当根用户发出关机指令后，系统中的其他用户可以得到如下提示：。。。。
4. shutdown命令也可用于重启系统
    ```# shutdowm -r 2```
如果正在使用系统的用户不止一个，关闭系统时应该使用shutdown命令，并采用延时关闭的方法，以避免数据丢失。


##### 2.3.2 关闭系统命令之poweroff
如果确认系统中已经没有用户存在且所有数据都已保存，需要立即关闭系统，可以使用poweroff命令。
    ```# poweroff```

##### 2.3.3 挂起系统命令halt
挂起系统通常应用于笔记本等便携设备中，与shutdown和poweroff命令不同，使用halt只会挂起系统，系统停止运行，而不会切断主机电源。
    ```# halt```
##### 2.3.4 重启系统命令reboot
   ```# reboot```

##### 2.3.5 切换系统运行级别命令init

#### 2.4 Linux命令基础及帮助


#### 2.5 系统与用户的交互程序Shell

##### 2.5.1 Shell分类
Linux系统中安装了多个Shell，这些Shell功能各异，在用法上也大相径庭。常见的Shell：
1. Bourne Shell
2. C Shell
3. Z Shell
4. Korn Shell

##### 2.5.2 更改默认Shell
虽然Linux使用Bash作为默认Shell，但有时可能需更改默认的Shell/
1. 查看系统中安装的Shell版本
系统将安装的Shell程序列表放在/etc/shell文件中，可以通过查看该文件获取Shell列表：
    ```# cat /etc/shells ```
2. 

#### 2.6 Bash中的命令基本操作



#### 2.7 管道和输入/输出
在管理和维护Linux系统的过程中，经常需要对一个命令的输出使用一连串的命令，Bash提供的管道、输入/输出重定向功能可以轻松地完成这个任务，该功能在Linux系统中使用非常频繁。
##### 2.7.1 管道
管道的功能就像这个词本身的含义一样，不同的是现实中的管道用来引导水流，而此处的管道则用来传递文本信息。

1. 管道使用竖线|作为操作符。
   ```# command1 | command2 | command3```
系统执行上面这种命令时，会先执行命令command1，并通过管道将command1的输出结果交给命令command2处理。然后再将命令command2的结果传给下一个命令command3，这样一直将结果传递下去，直到最后一个命令。在这个过程中，管道后面的命令总是使用管道前面的命令输出作为命令的输入。

2. 许多时候需要在某个命令的输出中筛选结果。例如查看系统中是否已经安装了gcc编译器软件包：
   ```# rpm -aq | grep gcc```
上面这条命令中，先使用命令rpm -aq输出系统中已安装的所有软件包，然后利用管道将结果传递给下一条命令grep gcc。后者将从已安装的软件包列表中筛选出名称中含有gcc的行并输出。

3. 管道的另一个常见用法是辅助处理命令输出，例如要输出本地网络接口卡收发数据详情：
   ```# netstat -i | sed 'ld' | awk```

##### 2.7.2 命令的输入/输出和错误
在执行命令时，可能希望命令从某个文件中读取输入，或将命令的输出写入到文件中，这时就要使用到重定向功能。

在Linux系统中，执行每个命令系统都会访问3个文件，这3个文件分别用于接收用户的输入、输出命令的结果和命令错误信息。
访问文件又是通过文件描述符的方式实现的，命令访问3个文件及其文件描述符如下所示。
- 标准输入(默认键盘)：标准输入使用的是文件描述符0。
- 标准输出(默认为显示器)：标准输出使用的文件描述符为1.
- 标准错误(默认为显示器)：用文件描述2表示标准错误。









##### 2.7.3 重定向命令的输入/输出和错误

1. 输出重定向

    在管理和维护系统的过程中，经常需要将一个或多个组合命令的输出结果保存到文件中，以便于分析系统的状况等信息，，这时就要使用到重定向输出。重定向输出使用的操作符是">"和">>"。
\
    例如要将网络信息保存在当前目录中的netstat.txt文件中：
    ```# netstat -tunlp | sed '1,2d' | awk '{OFS="\t"} {print $6,$7}' >netstat.txt ```
    ```# cat netstat.txt```

    \
    另一个重定向的例子是使用>>操作符将内容追加到指定的文件结尾，而不是覆盖原有文件内容，这个过程就像日志文件的添加方式。
    
    例如将当前的时间追加到文件netstat.txt的最后一行：
    ```# date>>netstat.txt```

2. 输入重定向
要对一个命令输入很长的文本总是很困难的，这时可以考虑将文本输入一个文件，然后使用输入重定向的方式将文本作为命令的输入。输入重定向使用的操作符是"<"和"<<"，大多数时候输入重定向使用的是一个文件。
\
    例如要将统计到的网络接口信息以邮件的形式发送给用户user1:
    ```# mail -s 'Network status' user1 < netstat.txt ```
\
    另一个输入重定向符是"<<"，这个操作符被形象地称为here document(这儿文档)。
    ```# cat <<END```
3. 错误重定向
   
   例如将错误重定向到文件：
   ```# rm abcd 当使用rm命令删除一个不存在的文件时，命令将提示错误信息```
   ```# rm abcd 2>error```
   重定向功能成功地将错误信息写入到指定的文件中。当某个命令产生许多输出时，可以使用错误重定向的方向，将错误信息从众多命令输出中分离出来。

   \
   默认情况下，重定向符"<"和">"表示重定向输入和输出，因此在重定向错误时必须使用"2>"明确表示标准错误进行重定向。如果用户愿意，也可以在重定向输入/输出时，使用数字1、2指明要重定向的对象。如果不想看到错误信息，可以将错误信息重定向到系统垃圾池/dev/null。

4. 使用多个重定向

    例如需要检测两台主机之间的连通性，并将连通性测试的结果放入文件netstat中：
    ```# ping 192.168.1.1 -c3 &>/dev/null;echo $?`date` >netstat ```
    \
    也可以同时重定向命令的输入和输出，例如：
    ```# sed '6,13d' <netstat.txt >netstat_1```




### 3 常用命令
#### 3.1 Linux基本命令
##### 3.1.1 切换工作目录命令cd
**命令格式**
```cd [dir]```
**参数说明**
dir表示要切换目录的路径，路径的表示方法可以是相对路径，也可以是绝对路径。如果没有任何参数，会切换工作目录至用户的家目录。

1. 切换路径
    ```cd ../```
    ```cd ../etc```
2. 快速返回家目录
    ```cd ~```
    ```cd ```
##### 3.1.2 查看当前路径命令pwd
**目录格式**
    ```pwd```
##### 3.1.3 查看文件列表命令ls
**命令格式**
    ```ls [option [filename]]```
**常用选项**
- l:以长格式显示文件列表
- d:显示目录的详细信息，而非目录中的文件列表
- a:显示隐藏文件
- k:显示文件大小时以k字节为单位
- S：按文件大小进行排序
- h：以更直观的方式查看文件列表

1. 要查看当前目录下的文件列表：
    ```# ls```   
2. 许多时候需要查看文件及目录的详细信息
    ```# ls -l```
3. 可以指定查看一个文件
    ```# ls -l /dev/sdbl```
4. 查看指定目录下的文件列表
    ```# ls -l /usr```
5. 要查看目录本身而不是其中的的文件，应使用选项d。例如查看目录/usr:
    ```# ls -ld /usr```
6. 查看隐藏文件
    ```# ls -al```

##### 3.1.4 文件链接命令ln
文件链接类似于Windows下的快捷方式，它是指向一个文件的链接。可分为硬链接和软链接。
**命令格式**
```ln [OPTION] Target Link_name```
**常用选项**
- s:创建软链接

**参数说明**
- Target:目标文件
- Link_name:创建后的软链接文件名称

**软链接文件**：一个指向目标文件的快捷方式(指向的目标文件可以不存在)
**硬链接文件**：目标文件的副本，副本在磁盘上的存储位置与目标文件一致，当一个副本的内容发生变化时，所有副本和目标文件的内容都会发生变化。


1. 创建硬链接
    ```# ln /home/user1/a /home/user1/test/b 为文件/home/user1/a建立一个硬链接文件，并命名为/home/user1/b```
    查看建立的硬链接文件：
    ```# ls -l /home/user1/test/b```
2. 创建软链接
    ```# ln -s /home/user1/a /home/user1/test1/c 使用s选项建立软链接文件```
    ```# ls -l /home/user1/test1/c 查看建立的软链接文件```

#### 3.2 文件操作命令

##### 3.2.1 文件命名规则
1. 文件命名规则

2. 文件扩展名
   Linux系统中没有文件扩展名的概念，因此在为文件命名时，不需要强制使用文件扩展名。虽然如此，有时也使用一些特殊的文件扩展后缀表示文件的用途，例如通常使用.conf结尾表示一个配置文件，.sh表示一段Shell程序，.log表示日志文件等。其中gcc编译器要求C语言的源码文件必须使用.c结尾。
3. 特殊字符和隐藏文件
    为一个文件命名时，为避免系统误解文件名，通常不建议使用特殊字符作为文件名称的一部分，如果确实需要使用特殊字符作为文件名的一部分，可以使用反斜杠"/"屏蔽这些字符的特殊含义。
   以"."号开头的文件都是隐藏文件，因此除非确实需要，否则不要使用"."号作为文件名的开头。
##### 3.2.2 创建文件命令touch
**命令格式**
```touch [option] filename```
**命令参数**
touch 命令会创建以参数filename为名称的文件，因此参数filename应该遵循文件命名规则。

1. 创建空文件
    ```# touch ab 使用touch命令创建一个空文件```
2. 创建并修改文件的时间戳记
   ```# touch -d "6/20/10 18:32" ed```
##### 3.2.3 创建目录命令mkdir
**命令格式**
```mkdir [option] dir```
\
**命令选项**
mkdir命令最常用的选项是p，它的功能是可以同时创建一个路径中的多个目录。

1. 例如要创建一个名为test的目录：
   ```# mkdir test```

2. 有时需要按路径创建目录，如果依次创建目录将会非常麻烦，这时可以配合选项p。
   ```# mkdir -p a/b/c/d/e```
##### 3.2.4 移动、重命名文件命令mv
**命令格式**
```mv Sou_file dir```

**参数说明**
- Sou_file:需要移动的文件或目录名
- dir:移动后的位置和文件名。如果此参数指定的文件已经存在，则mv将覆盖已存在的文件；若不存在，则移动文件并重命名。

1. 要将当前目录中的文件a移动到目录test中：
```# mv a test/ 将当前目录中的文件a移动到目录test中```

2. mv也可以用来移动一个目录：
   ```# mv test file/```
3. mv一次可以移动多个文件“
    ```# mv b c d file/ 将b、c、d移动到目录file中```
4. mv命令还可以用来重命名文件或目录：
   ```# mv file test 将目录file重命名为test```
##### 3.2.5 复制文件命令cp

**命令格式**
```cp [option] Source Directory```

**常用选项**
常用选项R，它可以递归的复制目录中的所有文件。

**参数说明**
- Source:要复制的源文件
- Directory:复制文件的新位置。如果此参数是一个新目录名，则将文件复制到新位置时重命名文件。

1. 复制并重命名文件
将/etc/samba/smb.conf备份到当前目录中，并将文件名重命名为smb.conf_backup：
```# cp /etc/samba/smb.conf smb.conf_backup 备份samba服务的配置文件并查看其权限变化情况```

2. 制作光盘镜像
 ```# cp /dev/cdrom linux.iso 为当前驱动中的光盘制作镜像```  
3. 复制目录
如果要复制的源目录中还存在子目录，可能会发生错误，此时可以使用选项R递归地复制子目录。
    ```# cp -R test file/```
4. 复制时保留权限
   在对文件进行复制的过程中，复制的新文件通常都具备了新的文件属主、属组和权限信息，有时可能需要保存原有文件的权限等信息，可使用p选项。
   ```# cp -p /etc/sysconfig/iptables ./backup ```
##### 3.2.6 删除文件命令rm
使用rm命令删除的文件将会直接从硬盘中删除，Linux系统中不存在回收站的概念。
**命令格式**
```rm [option] file```

**常用选项**
- r:删除目录时将目录中的所有内容一并删除
- f:忽略删除的目录中不存在的子目录，并且删除时不提示用户

1. 例如要删除文件ab:
```# rm ab 会提示用户是否确实需要删除文件```
2. 通常删除目录及目录中的所有文件和子目录时，常见的用法是配合使用选项r和f。
   ```# rm -rf test```
3. 删除目录中的所有文件时，可以使用"*"表示所有文件
   ```# rm -rf * 删除当前目录中的所有文件及目录```
##### 3.2.7 删除空目录命令rmdir
rmdir目录仅能删除空目录，大多数时候使用rm命令删除目录。

**命令格式**
```rmdir [option] directory```

1. 删除空目录file:
```# rmdir file 删除一个空目录file```

2. 使用选项p，来删除一个路径上的目录
   ```# rmdir -p a/b/c/d/ ```
##### 3.2.8 查看文件类型命令file
由于Linux系统中的文件没有使用扩展名，因此需要借助file命令来查看文件的类型。

**命令格式**
```file filename```
1. 查看文件a的文件类型：
   ```# file a```
2. 查看文件/usr/bin/file的类型：
   ```# file /usr/bin/file```
3. 查看建立的链接文件：
   ```# file b```
   ```# file -L /bin/csh 使用选项Lz追溯源文件查看文件类型```

#### 3.3 文本文件内容相关命令

##### 3.3.1 查看文本文件内容命令cat
cat命令的作用是查看文本文件内容，使用率极高。它将文本内容输出到屏幕上，然后返回Shell，适合查看行数较少的文本。

**命令格式**
```cat [option] filename```

**常用选项**
- v:显示文件中的控制字符。

1. 查看文本smb.conf的内容：
```# cat smb.conf```
2. 使用-v选项：
   ```# cat -v test.sh```

##### 3.3.2 从文本尾查看文本内容命令tail
tail命令的作用是从文本最后一行开始查看文本。管理员经常使用这个命令查看新产生的日志消息。

**命令格式**
```tail [option] filename```

**常用选项**
- n:指定查看的行数
- f:动态地显示文件内容的变化情况。

1. 要查看系统日志文件的最后几行：
    ```# tail /var/log/messages```
2. tail默认查看文件的最后10行，使用n选项，自定义行数：
    ```# tail -5 /var/log/messages```
3. 使用选项f
    ```# tail -f  /var/log/messages```

##### 3.3.3 从文本首行查看文本内容命令head
head命令将此首行开始显示文本的内容。

**命令格式**
```head [option] filename```

**常用选项**
- n:指定查看行数


##### 3.3.4 分屏显示文本内容命令more和less
- more命令
**命令格式**
```more [option] filename```
1. 使用more命令查看文件smb.conf的内容：
    ```# more smb.conf```
屏幕下方将会显示已查看的内容占整个文本的百分比，其常见的几个交互命令如下：
- Enter键：显示下一行内容
- 空格键：显示下一屏的内容
- b:显示上一屏的内容
- q:退出交互界面并返回
2. 查看较长的命令输出
   ```# rpm -aq | more 输出系统安装的所有软件并交给more显示```

- less命令
与more命令一样，less也采用分屏式的方法查看文本，不同的是less在其基础上扩展了一些功能，操作更加便捷。

**命令格式**
```less [option] filename```

1. 使用less命令查看文件smb.conf:
   ```# less smb.conf```
此时用户可以使用以下交互指令查看文本的内容：
- Page Up/Page Down:
- Home/End:
- 上、下方向键：
- /pattern:
- ?pattern:
- g/G:
- q:

##### 3.3.5 文本内容比较命令diff
有时需要比较两个文件的内容(例如制作补丁包时)，这时可以使用系统自带的diff命令。

**命令格式**
```diff [option] file1 file2```

**常用选项**
- c:
- C:
- b:
- B:
- u:
- r:



##### 3.3.6 文本统计命令wc


**命令格式**
```wc [option] file```

**常用选项**
- c:统计文件的字节数并输出
- m:统计并显示文件的字符数
- l:统计并显示文件的行数
- L:显示文件中最长行的长度
- w:统计并输出文件的字数

1. 不加选项
    ```# wc a.txt 使用wc命令添加a.txt，依次输出行数、词数、字节数及文件名称```
2. 统计字数
    ```# wc -w a.txt 使用选项w统计文件的字数```

#### 3.4 日期时间命令

##### 3.4.1 查看日期时间命令date
**命令格式**
```date [option] [+FORMAT]```
**常用选项**
- s:从指定的字符串中读取并设置当前系统的时间

1. 使用"date"命令查看当前系统时间：
```# date ```
2. 格式化输出时间
```# date +"%F %T"```
##### 3.4.2 查看日历命令cal
**命令格式**
```cal [option] [[month] year]```
**常用选项**
向其指定一个年月，以显示当月的日历

1. 直接使用
    ```# cal```
2. 指定要查看的年月
    ```# cal 2 2019```


##### 3.4.3 修改日期时间命令date和clock
由于设备的误差，有时需要手动修改系统日期和时间，也可以使用网络同步的方式修改。


#### 3.5 联线用户命令

##### 3.5.1 查看联线用户命令who、finger和w

1. 使用who命令查看当前系统中的用户：
    ```# who```
2. 使用finger命令查看登录到系统的用户及相关信息：
    ```# finger```
3. 使用w命令查看正在使用系统的用户
    ```# w```

    
##### 3.5.2 与联线用户通信的命令wall、write和mesg
##### 3.5.3 断开联线用户命令fuser

#### 3.6 切换用户命令
##### 3.6.1 临时切换用户命令su
##### 3.6.2 以root用户身份运行命令sudo



#### 3.7 定位和查找
##### 3.7.1 搜索命令which
##### 3.7.2 文件搜索命令locate
##### 3.7.3 特殊文件搜索命令whereis
##### 3.7.4 关键字搜索命令apropos




#### 3.8 输入/输出相关命令

##### 3.8.1 回显命令echo
**命令格式**
```echo [option] string```
**常用选项**
- E:禁用转义字符(默认选项)
- e:启用转义字符
- n:输出结束后不换行

1. 输出字符串
```# echo 'The first line.\nThe second line.\n 屏蔽转义字符'```
2. 使用信息e启用转义字符
    ```# echo -e "The firsr line.\n..."```
3. 有时需要获得用户的输入，获得用户输入的提示信息
    ```# echo -n "Please enter your name:"```
4. 在输出字符串中添加变量、命令输出等内容
    ```# echo "Host $HOST_DOWN_NAME non-response,time is:`date +'%Y-%m-%d%T'`"```
5. 与重定向配合输出错误信息
    ```# echo "Input error!"1>&2```

##### 3.8.2 接受用户输入命令read


**命令格式**
```read [[option] parameter] name```
**常用选项**
- a:
- d:
- e:
- n:
- p:
- r:
- s:
- t:
- u:




##### 3.8.3 显示并保存文本命令tee
tee是一个比较常用的命令，它的作用是将获取到的数据(tee命令获取到的数据通常来自管道)分为两个拷贝，一个拷贝输出到标准输出，另一个拷贝写入到指定的文件中。
**命令格式**
```......| tee [options] filename```
**常用选项**
- a:以追加的形式将数据写入到文件的结尾。
- i:写入数据时，不写入标准错误

1. 将指定的网络接口卡信息输出到屏幕的同时也写入文件中：
    ```# ifconfig eth2 | tee eth2_info 使用tee命令将来自管道的文本输出到标准输出，并写入文件eth2_info中```
2. 有时不希望tee命令使用覆盖的方式将数据写入到文件，这时可以使用选项a，将数据以追加的形式写入文本结尾。
    ```# date +'%Y%m%d %T' | tee -a date_log```
3. tee命令还提供了简单的筛选功能，有时得到的数据中不仅含义标准输出，还含有标准错误，此时可以使用选项i忽略标准错误。
    ```# ls -l ab | tee -ia a.txt```



##### 3.8.4 邮件命令mail
mail是Linux系统中自带的电子邮件命令，通常可以用这个命令发送、阅读电子邮件。在使用脚本自动管理系统的过程中，管理员经常使用mail命令将脚本执行的结果或脚本日志发送到指定邮箱，以便于了解脚本的执行情况。

1. 发送电子邮件

**命令格式**
```# mail [option] [-s subject] [-c c_address] [-b b_adress] user [-a file]....```
**常用选项**
- n:不读入设置文件/etc/mail.rc
- s:设置邮件的主题信息
- c:使用一个密件抄送列表
- b:使用一个抄送列表

**用法示例**
  （1）发送邮件时，
     ```# mail -s "net info" root,user1 <net_info  使用mail命令向用户root和user1发送主题为net info的邮件，使用重定向的方法指定邮件的内容为文件net_info的内容```
  在上面这个示例中，由于收件人的地址为系统中的用户，因此邮件将直接发送到用户的系统邮箱中。
  （2）还可以使用外部邮箱作为地址(前提条件是网络处于可用状态)
    ```# mail -s "net info" root,user1,ne****@163.com <net_info```
这样ne****@163.com就可以收到一个来自user@localhost.localdomain的邮件(由于user@localhost.localdomain并不是一个返回的邮箱地址，因此某些邮箱可能会拒收此类邮件)。

1. 查看邮件

  （1）可以使用命令mail查看邮件列表
      ```# mail```
  （2）在邮件命令提示符中常用的命令如下。
    - h:查看邮件的标题
    - d:加序号可以删除指定的邮件
    - f:查看当前光标指向的邮件
    - n:跳转到指定序号的邮件
    - q:退出并将已经阅读的已经存入文件~/mbox中
    - x:退出
    - !:允许使用Shell命令
  (3) 退出邮件建议使用命令q，以便于将经阅读的已经存入文件~/mbox中。如果要重新阅读mbox中的邮件，可以使用选项f。
  ```# mail-f 使用f选项查看文件~/mbox中的已读邮件```
 （4）管理员使用选项f查看其它用户的邮件：
    ```# mail -f /var/spool/mail/user1 使用选项f查看用户user1的未读邮件```
##### 3.8.5 启动新Shell命令exec




### 4 Linux命令中的特殊字符和正则表达式
许多时候需要筛选有用信息，这些信息可能包含在文件名称、命令输出、文本文件中。Linux系统引入一些特殊字符和正则表达式，来解决只记得筛选内容中的一部分或不连续的几部分。


#### 4.1 命令中的特殊字符
##### 4.1.1 字符串引用符双引号和单引号

##### 4.1.2 命令引用符反引号
##### 4.1.3 变量引用和命令转换符美元符号
##### 4.1.4 反斜线屏蔽符

#### 4.2 文件名通配符
在使用Linux系统的过程中，许多时候都需要查找一个文件。如果只能记住文件名的一部分，查找时就显得非常困难。这时可以考虑使用文件名通配符。
##### 4.2.1 单字符匹配元字符"?"
元字符"?"表示匹配文件名任意一个字符，连续使用多个元字符"?"可以表示多个任意字符。

1. 例如要在当前目录下查找两个字符且第1个字母是a的文件：
   ```# ls -l a? 使用a?表示以a开头且有两个字符的文件名```
##### 4.2.2 多字符匹配元字符"*"
元字符"*"表示匹配文件名中的任意字符串/匹配的字符串长度可以是零到一个字符，也可以是长度很长的多个字符组成的字符串。

1. 例如要查看当前目录下以字母c结尾的所有文件：
   ```# ls -l *c```
2. 例如要查看当前目录下所有以字母ee开头并以字母c结尾的文件：
   ```# ls -l ee*c```

##### 4.2.3 字符范围匹配符"[]"

1. 如果范围匹配符中出现的是几个字符的组合，表示匹配其中的任意一个字符。
```# ls -l [klsyz]* 查看当前目录中以klsyz中任意字母开头的所有文件```

2. 使用多个通配符可以进行更加复杂的匹配查找。
    ```# ls -l a*[cde]?  查看以字母a开头且倒数第2个字符为cde中任意一个字母的所有文件```

3. 使用符号"-"可以匹配一个字母或数字范围。
   ```# ls -l *[0-9]* 查看当前目录中文件名中包含数字的所有文件```
4. 要查看当前目录下文件名由两个字符组成且第2个字符是字母的所有文件：
   ```# ls -l ?[a-Z]  [a-Z]表示所有小写字母、大写字母```
##### 4.2.4 排除范围匹配符"[!]"

1. 例如要查看当前目录下文件名只有两个字符并以数字开头且第2个字符不是数字所有文件：
    ```# ls -l [0-9][!0-9]```

2. 要查看当前目录下文件名只有两个字符且两个字符都不是字母的所有文件：
   ```# ls -l [!a-Z][!a-Z] ```
   


#### 4.3 多条命令中的逻辑运算符和括号
使用多条命令执行任务时，两条相邻的命令之间可能会存在某种依赖关系，例如后一条命令是否需要执行，依赖于前一条命令是否能够成功执行。
类似于C语言的if语句，不同的是if语句使用的是条件判断，而此处为前一个命令的执行情况。

Linux系统提供了两个逻辑运算符：逻辑或"||"和逻辑与"&&"，还提供了两个括号：小括号和大括号。


##### 4.3.1 逻辑或"||"
**运算符格式**
``` command1 || command2```
执行命令时，先执行命令command1，如果command1执行成功，则跳过命令command2执行后面的内容，执行失败就会执行命令command2。

1. 读取邮件的例子：
```# mail -f /root/mbox || echo "Permission denied" 如果执行mail命令失败，则使用echo命令输出错误信息```
 

2. 逻辑或在管理和维护系统的过程中有时很有用。例如测试两个主机间的连通性，如果失败则返回提示：
   ```# ping 125.1**.***.* -c3 &>/dev/null || echo "Host Web1 network connection is lost."```
   
##### 4.3.2 逻辑与"&&"
**运算符格式**
``` command1 && command2```
系统运行上面的命令时，会先执行命令command1，如果执行成功，则会进行执行命令command2；如果执行失败，就会通过command2。

1. 例如为移动文件添加提示信息：
   ```# mv ~/rm.txt ~/test/ && echo "Successfully moving files." 使用mv命令移动文件，如果成功，则输出提示信息```
2. 在管理和维护系统时，逻辑与可以用于当测试正常时向用户输出提示信息。例如检查主机Web1服务器是否能正常提供服务并输出提示信息：
```# wget http://125.1**.***.* &>/dev/null && echo "`date + '%Y%m%d %T%t'` Host Web1 service running."```
##### 4.3.3 括号
Linux系统提供了两个括号：圆括号"()"和花括号"{}"。


**括号的基本格式**
```(command1;command2;command3...)```
```{command1;command2;command3...}```
Linux系统遇到括号时，会按顺序先执行括号内的命令，直到括号内的所有命令执行结束，然后再返回执行其他命令。

```# ping 125.1**.***.* -c3 &>/dev/null || ( 有点复杂)```



#### 4.4 命令中的正则表达式
使用文件名通配符模糊查找文件非常高效，而如果要在命令输出或文本中筛选内容时使用模糊查找，就需要使用正则表达式。正则表达式是一套由多个元字符组成的模糊查找模式，使用正则表达式可以快速查找和定位文本中指定的内容。



##### 4.4.1 单字符匹配符"."
单字符匹配符"."可以匹配任意单个字符，这个字符的功能与文件名匹配符中的"?"功能相同。
要使用正则表达式查找文本，首先需要使用元字符组成一个查找模式。

1. 使用查找模式时，通常将其放入两个斜杠"//"中，然后再放入命令中。例如要在一个文本中查找匹配模式"/.i....../"，可能出现的匹配选项有：
```# 匹配模式可以匹配任意位置的文本```
```Jiangsu...```
```Sichuan...```
2. 例如对一个格式化字符串学号使用单字符匹配符"/27210103../"
    ```2721010301...```
    ```2721010305...```
    ```2721010307...```

##### 4.4.2 单字符或字符串重复匹配符"*"
单字符或字符串重复匹配符"*"用来匹配单个字符或一个字符串序列的一次或多次重复出现。

例如使用"/bo*/"
    ```boooooo...```
    ```bookokok...```
    ```bokkkkkkk...```

##### 4.4.3 行首匹配符"^"

1. 例如对命令ls -l 使用行首匹配"/^l/"，可以匹配的结果有：
    ```lrwxr ...```
    ```lrwxrwx--x ...```
    ```lrwx--x--x ...```

**提示**：由于正则表达式不具备匹配文件名的功能，因此不能对ls -l命令直接使用以上匹配模式。可以使用ls -l | grep /^l/

2. 例如对一个学生表使用行首匹配符"/^2721010325/":
```2721010325...```

##### 4.4.4 行尾匹配符"$"

1. 例如在文本中匹配所有行尾是love的行：
   ```/love$/```
2. 匹配所有只有5个字符的行：
   ```/^.....$/```
3. 要匹配所有以over结尾的行：
   ```/over$/```
##### 4.4.5 反斜杠屏蔽符"\"
反斜杠"\"用来屏蔽一些特殊字符的特殊含义。
**特殊符号**：
- 注释、分割符号：#、；等。
- 引用符号：$、``、""等。
- 元字符：.、*、$、?、[]、\等。
- 逻辑运算符和操作符：||、&&等。

1. 例如要使用符号"*"做乘法运算，就必须使用反斜杠将其特殊含义屏蔽后再使用：
    ```# expr 256\* 256```
2. 例如要使用注释符号"#"和反斜杠"\:"
    ```# echo \#notes\\```
    ```#notes\```
3. 要在正则表达式表示文件名为："^^.txt":
    ```/\^\^\.txt/```
##### 4.4.6 范围匹配符"[]"和排除范围匹配符"[^]"

1. 例如要匹配单词love和Love；
    ```/[Ll]ove/```
2. 要匹配所有的数字：
    ```[0123456789]```
3. 也可以使用符号"-"表示这个集合：
    ```[0-9]```
4. 而要匹配所有的字母可以使用以下两种方式：
    ```[a-Z] [a-z A-Z]```
5. 不匹配所有的字母：
    ```[^a-Z]```

##### 4.4.7 词首、词尾匹配符"\<"和"\>"
词首匹配符"\<"和词尾匹配符"\>"用于在单词开头和单词结尾匹配特定的字符和模式。
1. 例如要匹配所有以disc为词首的文本，可以使用：
    ```/\<disc//```
2. 要匹配所有以ment为词尾的文本，可以使用：
    ```/ment\>/```
3. 要匹配完整的单词the，可以使用：
    ```/\<the\>/```

##### 4.4.8 重复次数匹配符"x\{\}"
重复次数匹配符"x\{\}"可以匹配字符或字符串连续出现的次数或次数范围。

1. 要匹配字母m出现次数为5次的文本，可以使用
    ```/m\{5\}/```
2. 要匹配字母mc出现次数至少5次的文本，可以使用:
    ```/m\{5,\}/```
3. 匹配字母m出现次数5至10次的文本，可以使用:
    ```/m\{5,10\}/```



##### 4.4.9 组合并使用正则表达式

1. 在查找和筛选信息时，有时需要去除文本中的空行，由于空行没有任何字符，可以使用行首、行尾匹配符匹配空行。
    ```/^$/```
2. 有时一些文本为了看上去更加美观，会使用一种字符填充整行，可以使用以下模式匹配这些行：
    ```/^.*$/```
3. 匹配以the或The开头的所有行：
    ```/^[tT]he/```
4. 排除以the或The开头的所有行：
    ```/^[^Tt]he/```
5. 匹配一个IP地址：
    ```/[0-9]\{1,3\} \. [0-9]\{1,3\}\.[0-9]\{1,3\}\.[0-9]\{1,3\}/```
6. 匹配一个6个字符组成的字符串，前两个字符是字母，中间两个字符是22且最后两个字符是小写字母：
    ```/[a-Z]\{2\}/22[a-z]\{2\}```
7. 要精确匹配单词love:
    ```/\<love\>/```




### 5 查找和筛选工具
Linux管理员经常需要从众多的命令输出及文本文件中查找和筛选一些信息(例如日志)，以便于从中了解服务器的运行状况、系统当前状态等信息。
#### 5.1 查找文件工具find
有时可能需要找出一个不知道保存在上面什么位置的文件，也可能在维护系统的过程中要找出具有某一特征的文件(例如修改时间、文件长度等)。这时可以利用find搜索整个文件系统，甚至是网络文件系统上的文件和目录。

##### 5.1.1 find的基本格式
**命令格式**
```find [path] [expression]```
**常用选项**
- path:find查找路径。如果未指定，则默认为当前工作目录。
- expression:用于定义find查找的表达式，表达式通常由选项、测试和动作3类参数组成。



未完待续

##### 5.1.2 按文件名称查找
很多时候管理员会忘记某一个文件存放在什么位置。可以使用name参数进行查找，也可以使用文件名称通配符配合查找。

1. 想要在/etc目录下查找Samba服务的配置文件smb.conf：
    ```# find /etc -name "smb.conf" -print```
2. 想要查找/etc目录下所有的配置文件：
    ```# find /etc -name "*.conf" -print```
3. 在当前目录中查找名为message的文件：
    ```find -name "messages" -print 如果未指定查找的目录，find将在当前目录中查找```
4. 如果想要在/etc查找两个小写字母加一个数字，最后面是.d的文件，可以使用下面这条命令：
    ```# find /etc -name "[a-z][a-z][0-9].d" -printf```
5. 在一个很大的文件系统上进行查找时，可能会花费很长时间，通常建议使用操作符&将find命令放到后台执行：
    ```# find / -name "*.conf" -print &```

##### 5.1.3 按文件权限查找
使用perm参数可以按照文件的权限进行查找，使用此参数时，需要使用八进制表示权限。按权限查找文件通常用在多用户系统中，以便于发现可能导致泄密、不安全的内容等。

**绝对模式**：指使用八进制表示权限的方法。绝对模式使用数字4表示读权限，2表示写权限，1表示执行权限，使用多权限时只需将数值相加即可。使用使用3位数字表示多用户权限，从坐起分别表示文件属主、属组和其他用户权限。

1. 在整个文件系统上查找属主可以读、写，属组可以读、写，其他用户可以读的文件。
    ```# find / -perm 664 -print  在整个文件系统上查找权限664的文件```
2. 在当前目录的file子目录下查找其他用户可以读、写、执行的文件(这种情况应当引起重视)，此时应该在权限数值前加一个横杠-（表示使用包含模式）。
    ```# find ./file -perm -007 -print 在当前目录的file子目录中查找权限中包含其他用户可读、写、执行的文件```


##### 5.1.4 按文件类型查找
用type参数可以按类型查找文件。常见的文件类型有目录、字符设备和普通文件等。按文件类型进行查找适合于一些比较特殊的情况，例如要查找某个设而而不知道其具体的名称等。

1. 查找/dev下有哪些字符设备：
    ```find /dev -type c -print 查找/dev目录中的字符设备。其中c表示字符设备```

2. 查找目录/dev中的块设备文件：
    ```# find /dev -type b -print 查找目录/dev的块设备文件，其中b表示块设备文件```

3.  查找目录/etc/rc3.d中除了链接文件以外的文件(通常情况下这个目录下只会存放链接文件)：
    ```# find /etc/rc3.d ! -type l -print l表示链接文件，感叹号表示否定```


##### 5.1.5 按文件的时间戳记和大小查找
在管理和维护Linux系统的过程中，经常需要清理一些过期的日志和文件，清理这些文件的标准通常是文件的修改时间、访问时间、文件的大小等。而另一种情况是我们需要知道一定时间内被修改过的文件，以便对这些文件进行备份等。
这时可以使用find命令的mtime、atime和size参数按文件的时间戳记和文件的长度查找。


1. 按时间戳查找文件

- 希望在整个文件系统上查找修改时间在一周内的文件：
  ```find / -mtime -7 -print 使用-7指定修改时间在7天以内的文件```
- 查找用户根目录下修改时间在1天以前的文件：
  ```# find ~ -mtime +! -print 使用+！指定修改时间在1天以前的文件```
- 查找目录/data中访问时间在10天以内的文件：
  ```# find /data -atime -10 -print 使用atime -10 指定访问时间在10天以内的文件```

2. 按长度查找文件
使用size按文件大小查找时，可以像按时间戳记那样使用+n表示文件长度大于n的文件，-n表示文件长度小于n的文件。默认情况下文件长度的单位是块(一块等于512字节)，如果要以字节来计算文件长度，应该在数字后加上小写字母c。
- 在当前目录下查找文件长度大于10MB的文件
```# find . -size +10000000c -print 使用+10000000c表示文件长度大于10MB的文件```
- 要在当前目录下查找文件长度小于30块的文件：
    ```# find . -size -30 -print 使用-30表示文件长度小于30块(512*30=15KB)的文件```
 在按文件大小查找文件时，也可以使用KB 、MB、 GB等较大的单位标记文件的大小。

##### 5.1.6 按文件属主或属组查找
当管理员将一个用户或用户组从系统中删除时，可能需要将该用户或用户组的文件收集起来保存一段时间。这时可以使用find命令的user、nouser、group和nogroup这几个参数，查找指定用户、用户组的文件。

1. 要查找目录/home中属主为lilei的文件
    ```# find /home -user lilei -print 使用user参数查找属主为lilei的文件```
2. 在整个文件系统上查找没有有效属主(即用户名在系统用户名/etc/passwd中不存在)的文件：
    ```# find / -nouser -print 使用nouser参数查找没有有效属主的文件```
3. 查找目录/file中属组为admin的文件：
    ```# find /file -group admin -print 使用group参数查找属组为admin的文件```
4. 在整个文件系统中查找没有有效属组(即用户组名称在系统用户组文件/etc/group中不存在)的文件：
    ```# find / -nogroup -print 使用nogroup参数查找没有有效属组的文件```


##### 5.1.7 find工具的其他参数





##### 5.1.8 使用exec和ok处理查找到的文件
##### 5.1.9 使用xargs命令处理查找到的文件

##### 5.1.10 find工具应用实例
1. 使用find查找需要备份的文件


#### 5.2 查找文本工具grep
许多时候需要从一大堆的命令输出或文本文件内容中找出一两行关键的内容，例如从系统用户文件中查找某个用户。可以使用grep工具对内容进行筛选。
**grep**是global regular expression print(全局正则表达式打印)的缩写。

##### 5.2.1 grep的基本格式
**命令格式**
```grep [option] pattern [file]```

**常用选项**
- i
- n
- l
- h
- c
- v


##### 5.2.2 使用grep查找文本
引入一个示例文本文件students。
1. 查找关键字
使用grep命令查找时，需要提供一个关键字。最好是独一无二的。
    ```# grep "92" students 在students中查找包含92的行```
2. 显示行号
有时可能需要确定查找到的结果处于文本的什么位置，这时可以配合选项n在查找时输出行号。
    ``` # grep -n "92" students ```
3. 统计结果
统计文件中一共有多少名来自西藏的学生：
    ```# grep -c "Xizang" students 使用c选项统计查找到的总行数```
4. 大小写敏感
grep命令继承了Linux系统对大小写字母敏感的特性，因此如果要使grep在查询过程中不区分大小写，应该配合使用i选项。

5. 反转查找
有时需要进行反转查找，即显示那些不匹配字符串的行，此时可配合选项v。
    ``` # grep -vi "tangwei" students | grep -vi "lixia" 使用选项v反转查找不含有tangwei和lixia的行，为了满足两个条件，使用两次查找```
6. 多文件查找
有时需要从多个文件中查询一些相关联的内容，这时就要用到多文件查询。
例如管理员要从目录/etc的文件中查找有关root用户的内容：
    ```# grep -l "root" "/etc/*"```

7. 在命令输出和变量中查找
grep不仅可以从文件中查询字符串，还可以从字符串和字符串变量中查询：
```# echo "Welcome to Beijin" | grep "to Beijin" 使用grep在命令输出中查找```

##### 5.2.3 行首、行尾匹配查找
1. 行首匹配
   ```# grep '^28' students 使用行首匹配符显示所有行首字符串为28的内容```
2. 行尾匹配
    ```# grep -v '[0-7][0-9]$' students | grep -v '8[0-4]$ '```

##### 5.2.4 配合常用的正则表达式查找
1. 使用范围模式匹配

2. 次数匹配模式
   有时需要知道一个匹配模式出现的次数。
   \
   ```# grep 'c\{3,\}' file.txt 使用次数匹配模式查找字母c至少出现2次的行```
3. 处理特殊字符
在使用grep查找的过程中，可能会遇到一些特殊字符，可以使用反斜线"\"屏蔽掉这些特殊字符的含义。
\
例如要查看当前目录下所有以.txt结尾的文件：
    ```# ls -l | grep '\.txt$' 使用反斜线屏蔽掉点号的特殊含义``` 

##### 5.2.5 使用或、与多匹配模式查找
1. 或匹配模式
   使用参数E让grep命令将要匹配的字符串延伸为一个普通的表达式，此时可以使用竖线|表示或匹配模式，即只需要匹配两个字符串的任意一个即可。
   \
   例如查询来自河南和云南学生的详细情况：
    ```# grep -E "Henam|Yunnan" students```
2. 与匹配模式
   然而参数E并不支持匹配模式查询，此时可以使用多条件管道实现。例如要查询Lixia的学生有哪些来自Sichuan:
   ```# grep -i "Lixia" students | grep "Sichuan"```


##### 5.2.6 grep工具应用实例
1. 精简配置文件
2. 从系统管理命令输出中查找
例如从服务列表中筛选出蓝牙服务，以便于查看这个服务在不同运行级别中的启动状态：
    ```# chkconfig --list | grep bluetooth```


#### 5.3 流编辑器sed
#### 5.4 格式化文本数据抽取工具awk
#### 5.5 转换和删除重复命令tr
#### 5.6 合并和分割工具



### 6 用户和文件权限管理
Linux作为一个多用户、多任务系统，可能同一时间有许多用户登录并使用系统。作为管理员，首先需要考虑如何有效地管理系统中的用户，其次要考虑如何运用文件权限让系统中的多个用户同时使用系统，但互不影响，

#### 6.1 用户管理

##### 6.1.1 系统用户文件概述
在Linux系统中一切都是文件，包括硬盘、键盘等许多设备都是一个文件。系统中的用户也是保存在文件中的。与系统用户一起保存在文件中的还要用户设置，例如用户的家目录、使用的Shell、用户的密码等。

1. 系统用户文件
用于保存系统用户及用户设置的文件是/etc/password。查看系统用户文件的内容：

    ```# cat /etc/password```
2. 用户密码文件
    ```# cat /etc/shadow```

##### 6.1.2 添加用户命令useradd
```# ls -l /usr/sbin/adduser```

1. 例如要创建一个名为ljx的用户
    ```# useradd ljx  使用useradd命令添加新用户lkx```
    ```# cat /etc/passwd | grep ljx  查看系统用户和影子文件验证用户是否添加成功```
    ```# cat /etc/shadow | grep ljx```  
在系统中添加用户需要注意以下几点：
- 不要使用中文用户名
- 不建议使用公共账号
- 不建议使用大写字母
- 不建议在用户名中使用除小写字母以外的特殊字符
2. 使用选项s为其指定特殊的Shell。
    ```# useradd -s /bin/ksh wlh  使用选项s指定新建用户的默认Shell```
    ```# cat /etc/passwd | grep wlh 通过查看系统用户文件的方法验证设置```

3. 添加新用户时，系统会自动分配新用户的家目录。默认情况下，家目录位于/home目录中，并以用户名作为家目录的名称，查看用户的家目录：
    ```# ls -l /home/ 使用ls命令查看/home目录中的用户家目录```

4. 分配新用户的家目录后，系统还会添加新用户的初始化文件(初始化文件通常用于初始化用户的系统、软件环境)。通常用户的初始化文件被放在家目录中，并以隐藏文件的形式存在。
    ```# ls -al /home/ljx/ 使用ls命令查看家目录的用户初始化文件```

5. 根据安装的软件包不同，家目录中可能还会存在一些别的初始化文件，例如编辑器Vim的初始化文件.viminfo等。这些初始化文件的模板被放置在目录.etc.skel中。

    ```# ls -al /etc/skel 查看系统用户初始化模板文件```

6. 编译安装软件时，有些软件会要求建立软件专业用户。
7. 有时可能需要在建立用户时指定用户的用户组，此时可以使用选项g。例如：
    ```# useradd -g user1  user2 使用选项g指定添加的新用户user2的用户组为user1```


##### 6.1.3 设置用户密码目录passwd


#### 6.2 用户组管理
#### 6.3 基本权限及管理命令
#### 6.4 POSIX ACL权限系统及其管理命令



### 7 磁盘和文件系统管理
#### 7.1 磁盘及分区管理
#### 7.2 文件系统管理
#### 7.3 RAID设备
#### 7.4 LVM逻辑卷管理
#### 7.5 磁盘配额管理
#### 7.6 文件系统维护基础





### 8 Linux系统管理


#### 8.1 系统服务管理
**服务**：是指操作系统中提供指定功能的程序或进程。服务也是一类应用程序，不同的是服务一般只在后台运行，且服务的对象一般是本地系统或网络中的主机和用户。
在Linux系统中有许多系统服务，这些系统服务涉及Linux运行的各个方面。例如提供打印的服务cups，为系统提供网络支持的服务network，系统网络防火墙服务iptables等。

##### 8.1.1 查看系统服务
Linux系统中存在许多服务，按服务对象不同，通常可以分为本地系统服务和网络服务这两类。本地系统服务主要用于支撑本地系统运行，例如打印、网络支持、防火墙服务、蓝牙支持服务等。网络服务通常用于对网络中的用户或主机提供服务，例如Web服务、代理服务、FTP、数据库服务等。



查看Linux系统中的服务列表，可以使用命令chkconfig。该命令可用于查看服务的自启动状态，也可以设置服务的启动状态。

1. 查询系统防火墙服务iptables的自启动状态：
    ```# chkconfig --list iptables  使用选项list加服务名称，查看指定服务的自启动状态```

2. 如果不使用服务名称参数，命令将会列出系统中的所有服务：
    ```# chkconfig --list```

3. 有时可能会忘记服务的具体名称，也可能只记得服务名称中的一部分，这时可以将chkconfig命令与grep命令一起配合使用。
\
例如要查询服务名称中含有nfs的服务列表：
    ```# chkcofig --list | grep nfs 先使用chkconfig命令列出所有服务，然后使用grep命令筛选含有nfs的行```

##### 8.1.2 设置服务自启动状态
许多时候管理员都需要设置服务的自启动状态，关闭一些不需要的服务，或将需要的服务设置为在相应的运行级别启动等。

一个比较典型的例子：当系统供个人用户使用时，需要禁用网络服务，并且按个人需求禁用不必要的服务，以节省资源(例如没有打印机时，禁用打印服务)。

1. 设置独立服务系统防火墙的自启动状态为关闭：
    ```# chkconfig iptables off 使用chkconfig命令设置防火墙服务的自启动状态为关闭```
    ```# chkonfig --list iptables 使用选项list查看并验证结果```

这时系统防火墙在所有运行级别下都为关闭状态。

2. 如果要设置开启防火墙，可以用如下命令：
    ```# chkconfig iptables on 使用chkconfig命令设置防火墙的自启动状态为开启，并验证设置```
    ```# chkonfig --list iptables 使用选项list查看并验证结果```
这时防火墙会在运行级别为2，3，4，5时自动启动。

3. 从上面几个示例命令的结果中可以看出，设置服务为开启状态时，命令默认将其设置为运行级别2，3，4，5为开启。设置服务关闭时，默认设置为所有运行级别关闭。显然这个默认设置并不适用于所有用户和服务，这时可以使用选项level指定运行级别列表。
\
    例如设置系统防火墙在运行级别3，5自动启动：
    ```# chkconfig --level 35 iptables on  使用选型level设置自启动运行级别列表并验证```
    ```# chkonfig --list iptables 使用选项list查看并验证结果```

4. 对于非独立服务而言，由于没有运行级别这个概念，因此不能使用level选项指定运行级别列表，可以直接设置这些服务的状态。
\
例如要将简单文件传输协议(TFTP)服务设置为开机自启动：
    ```# chkconfig tftp on 使用chkconfig命令设置非独立服务的启动状态并验证```
    ```# chkonfig --list tftp 使用选项list查看并验证结果```

##### 8.1.3 添加删除系统服务
chkconfig命令不仅可以查看、设置服务的自启动状态，还可以添加系统服务(前提条件是有可供使用的运行级别脚本)。

**命令格式**
    ```chkconfig -add <name>```
    ```chkconfig -del <name>```
   

##### 8.1.4 启动和关闭服务命令service
许多时候需要在系统处于运行状态时启动和关闭某个服务。最常见的例子是管理员在配置一个服务时，需要反复关闭、启动服务(启动时服务将重新读取配置文件)，已验证配置文件是否能够达到预期的目的。

**命令格式**
    ```service name [start|stop|restart]```
1. 例如要关闭系统防火墙iptables:
    ```# service iptables stop 使用service命令关闭系统防火墙```
2. 有时修改了服务的配置文件，希望以新的配置文件运行服务，这时可以使用restart参数让服务重启动，已重新读取配置文件。
例如管理员通过修改配置文件的方法重新配置了网络接口卡的IP地址等信息，并希望系统网络重新启动：
    ```# service network restart 使用service重新启动网络支持服务network```
执行以上命令后，系统会先关闭网络支持服务network，然后再读取配置文件，并使用新的配置文件并启动网络接口。
3. 然而有些发行版不支持service命令，由于服务的启动脚本都放在目录/etc/init.d中，因此可以使用手动运行的方式执行启动脚本。
4. 许多服务处理启动、停止和重启之外，还要一些其他动作，如保存、重新载入配置文件等(并非所有服务都支持这些动作)。
\
例如要保存系统防火墙规则：
    ```# service iptables save 使用save动作保存防火墙规则```


#### 8.2 进程管理命令
许多Linux系统运行于多用户环境下，管理员有必要

##### 8.2.1 查看进程命令ps
要查看系统中运行的进程，可以使用ps命令，这是查看系统进程最常用的一个命令。ps命令会输出系统中的进程详细信息，管理员可以利用这些信息杀死进程，也可以管理系统中的进程。

**命令格式**
```ps [option]```
常用选项
- a:显示所有终端进程
- u:显示所有用户的进程
- x:显示所有进程，包括没有明确终端的进程
- e:显示所有的进程，但使用的格式为BSD系统格式
- f:显示UID，PPID(父进程ID)

1. 如果不加任何参数，ps命令将会输出当前用户的进程：
```# ps 以普通用户身份运行ps命令```


##### 8.2.2 进程树
在Linux系统中，父进程、子进程之间的关系非常复杂。

例如，查看当前系统中的进程树：
    ```# pstree  使用pstree命令查看当前系统中的进程树 ```

##### 8.2.3 实时显示进程命令top

1. 使用top命令时，无须使用任何参数和选项：
    ```top ```
2. 
##### 8.2.4 将任务放在后台执行
执行一个花费时间很长的命令时，命令会长时间占用终端前台，这对于用户而言可能会非常不方便。


使用sleep命令作为示例，该命令产生的进程会在指定时间内一直处于睡眠状态，直到时间结束，才退出并释放占用系统资源。如果在前台执行，此命令将会锁住终端直到时间结束。
**在执行命令时，可以在命令最后加入符号&，此时系统会将命令或程序放入后台执行。**

1. 例如要创建一个sleep进程，持续时间为300秒，并将其切换至后台运行：
    ```# sleep 300 & 使用&将命令放在后台执行```
    ```# ps 使用ps命令查看后台进程```

上面这个示例中，命令sleep开始执行即会立即切换至后台，使用ps命令即可发现sleep进程正在后台执行。

2. 使用&将命令放在后台执行时，处于后台的命令会直接将输出和错误信息输出到控制台。这样非常不方便查看，此时建议使用重定向将命令输出、错误信息输出到文件，以便于时候查看。
   \
    例如使用mv命令移动数据时，将错误重定向：
    ```# mv /mnt/sdd5/test /root/ &>message &```

##### 8.2.5 查看后台任务命令jobs
有时要将放在后台执行的命令重新放到前台，将命令放到前台之前，需要知道命令的作业号，要查看后台任务的作业号，可以使用命令jobs。
要查看处于后台任务的作业号：
    ```# jobs 使用jobs命令查看后台执行的命令```

使用jobs命令时需要注意，该命令显示的后台任务是用户手动执行的，需要占用前台的命令，不包含系统运行的后台进程。

##### 8.2.6 后台任务调至前台命令fg
许多时候需要将原本处于后台执行的任务重新放到前台，可能的情况是用户已经完成其他任务，也可能是用户想要查看任务的进度等。这时可以使用fg命令将后台任务重新调至前台执行。

使用fg命令调取任务时，需要使用任务的作业号作为参数。例如将指定的作业重新放到前台执行；
    ```# sleep 60 & 使用&符号将任务放至后台执行```
    ```# jobs 使用jobs命令查看后台任务的作业号```
    ```# fg 1 使用fg命令将作业号为1的任务放到前台执行```

##### 8.2.7 终止进程命令kill
许多时候需要强行终止一个进程，可能的情况是不再需要继续运行这个进程，也可能是这个进程没有响应需要终止等。

**命令格式**
    ```kill -signal PID```

1. 大多数时候，并不需要发送特别的信号，而是以正常方式杀死进程。以正常方式杀死进程时，kill命令将使用信号15，即DIGTERM(使用软件终止的方式)。
这种方式会存在一些问题：进程的子进程可能会无法终止，并继续占用系统资源。
   
    此处以命令sleep作为示例：
    ```# ps 使用ps命令查看终止命令的PID号```
    ```# kill 16888 使用kill命令终止PID为16888的进程```


2. 如果管理员发现某个进程无法终止，可能的原因是进程已经无法响应。这时可以使用信号9，强制终止无法终止的进程：


未完待续

##### 8.2.8 查看进程优先级
##### 8.2.9 指定进程运行优先级命令nice

##### 8.2.10 改变进程优先级命令renice



#### 8.3 计划任务命令crontab、at


#### 8.4 日志管理

### 9 数据备份和应用程序管理
#### 9.1 数据备份基础
#### 9.2 tar备份工具
#### 9.3 cpio备份命令
#### 9.4 压缩工具和整盘备份工具dd
#### 9.5 RPM包管理命令rpm
#### 9.6 编译安装相关命令和工具
#### 9.7 利用yum工具安装应用程序




### 10 网络管理
#### 10.1 网络接口配置命令
#### 10.2 路由命令route
#### 10.3 主机名称命令hostname
#### 10.4 设置网络冗余
#### 10.5 网络工具

## 第2篇 文本编辑器



## 第3篇 Shell编程

### 15 Shell脚本编程基础、变量
**Shell脚本编程**：为实现某个任务，将许多命令组合后，写入一个可执行的文本文件的方法。
#### 15.1 Bash脚本编程基础

##### 15.1.1 Shell脚本概述
Linux系统中的Shell脚本通常具备以下特点：
- 



##### 15.1.2 Shell脚本的基本内容
1. 调用Shell
2. 脚本注释
3. 脚本内容
##### 15.1.3 脚本的运行方式
脚本的运行方式有3种：使用bash命令、使用点好和设置脚本的执行权限。
1. 使用bash命令执行脚本
    ```#bash Hello.sh```
2. 使用点号.执行脚本
    ```# . Hello.sh```
3. 设置脚本为可执行
这种方式需要先为脚本文件添加可执行权限，然后就可以像应用程序那样执行脚本文件。
    ```# chmod u+x Hello.sh```
    ```# ls -l Hello.sh```
    ```# ./Hello.sh```

##### 15.1.4 接受用户输入
获取用户输入的示例脚本文件：
```shell```

##### 15.1.5 向脚本传递参数
