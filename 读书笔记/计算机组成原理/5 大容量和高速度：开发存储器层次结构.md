# 5 大容量和高速度：开发存储器层次结构

## 5.3 cache的基本原理

**直接映射：**
- 直接映射：一种cache结构，其中每个存储器地址仅仅对应到cache中的一个位置。
- 映射方法：(块地址) mod (cache中的块数)
- 标记：表中的一个字段，包含了地址信息，这些地址信息可以用来判断cache中的字是否就是所请求的字。
- 有效位：表中的一个字段，用来标识一个块是否含有一个数据。

### 5.3.1 cache访问

![alt 文本](./../../图片/计组5.1.png)

**cache的总位数：**
![alt 文本](./../../图片/计组5.2.png)

**例题：将一个地址映射到多字大小的cache块中**
![alt 文本](./../../图片/计组5.3.png)

**块大小与缺失率的关系**
![alt 文本](./../../图片/计组5.4.png)
![alt 文本](./../../图片/计组5.5.png)

![alt 文本](./../../图片/计组5.21.png)
![alt 文本](./../../图片/计组5.22.png)
![alt 文本](./../../图片/计组5.23.png)
![alt 文本](./../../图片/计组5.24.png)
![alt 文本](./../../图片/计组5.25.png)
## 5.4 cache性能的评估和改进
![alt 文本](./../../图片/计组5.26.png)
![alt 文本](./../../图片/计组5.27.png)
### 5.4.1 通过更灵活地放置块减少cache缺失
![alt 文本](./../../图片/计组5.8.png)

提高相联度的好处在于它通常能降低缺失率，主要缺点是增加了命中时间。

#### cache的缺失与相联度
- 相联度能使缺失率下降多少呢？图5-16显示了一个容量为64KiB，块大小为16字的数据cache，当相联度从直接映射到八路组相联变化时性能的改进情况。从一路组相联到两联组相联，缺失率下降了大约15%，但是更高的相联度对缺失率的改善就很少了。

### 5.4.2 在cache中查找一个块
![alt 文本](./../../图片/计组5.6.png)
![alt 文本](./../../图片/计组5.7.png)


### 5.4.3 替换块的选择
当直接映射的cache发生缺失时，被请求的块只能放置于cache中唯一位置，而原先占据
![alt 文本](./../../图片/计组5.10.png)
### 5.4.4 使用多级cache结构减少缺失代价
。。。
### 5.4.5 通过分块进行软件优化
。。。
### 5.4.6 小结
![alt 文本](./../../图片/计组5.11.png)
## 5.7 虚拟存储器
![alt 文本](./../../图片/计组5.12.png)
![alt 文本](./../../图片/计组5.30.png)
![alt 文本](./../../图片/计组5.29.png)
![alt 文本](./../../图片/计组5.13.png)
![alt 文本](./../../图片/计组5.14.png)
### 5.7.2 缺页故障
![alt 文本](./../../图片/计组5.15.png)
![alt 文本](./../../图片/计组5.16.png)
![alt 文本](./../../图片/计组5.17.png)
![alt 文本](./../../图片/计组5.18.png)
![alt 文本](./../../图片/计组5.19.png)
![alt 文本](./../../图片/计组5.20.png)